{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport './list.css';\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\nimport { isNumber } from '../../../common/types.js';\nimport { range, binarySearch } from '../../../common/arrays.js';\nimport { memoize } from '../../../common/decorators.js';\nimport * as platform from '../../../common/platform.js';\nimport { Gesture } from '../../touch.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Event, Emitter, EventBufferer } from '../../../common/event.js';\nimport { domEvent } from '../../event.js';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\nimport { Color } from '../../../common/color.js';\nimport { mixin } from '../../../common/objects.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { matchesPrefix } from '../../../common/filters.js';\nimport { alert } from '../aria/aria.js';\nimport { createStyleSheet } from '../../dom.js';\nclass TraitRenderer {\n  constructor(trait) {\n    this.trait = trait;\n    this.renderedElements = [];\n  }\n  get templateId() {\n    return \"template:\".concat(this.trait.trait);\n  }\n  renderTemplate(container) {\n    return container;\n  }\n  renderElement(element, index, templateData) {\n    const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n    if (renderedElementIndex >= 0) {\n      const rendered = this.renderedElements[renderedElementIndex];\n      this.trait.unrender(templateData);\n      rendered.index = index;\n    } else {\n      const rendered = {\n        index,\n        templateData\n      };\n      this.renderedElements.push(rendered);\n    }\n    this.trait.renderIndex(index, templateData);\n  }\n  splice(start, deleteCount, insertCount) {\n    const rendered = [];\n    for (const renderedElement of this.renderedElements) {\n      if (renderedElement.index < start) {\n        rendered.push(renderedElement);\n      } else if (renderedElement.index >= start + deleteCount) {\n        rendered.push({\n          index: renderedElement.index + insertCount - deleteCount,\n          templateData: renderedElement.templateData\n        });\n      }\n    }\n    this.renderedElements = rendered;\n  }\n  renderIndexes(indexes) {\n    for (const {\n      index,\n      templateData\n    } of this.renderedElements) {\n      if (indexes.indexOf(index) > -1) {\n        this.trait.renderIndex(index, templateData);\n      }\n    }\n  }\n  disposeTemplate(templateData) {\n    const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n    if (index < 0) {\n      return;\n    }\n    this.renderedElements.splice(index, 1);\n  }\n}\nclass Trait {\n  constructor(_trait) {\n    this._trait = _trait;\n    this.indexes = [];\n    this.sortedIndexes = [];\n    this._onChange = new Emitter();\n    this.onChange = this._onChange.event;\n  }\n  get trait() {\n    return this._trait;\n  }\n  get renderer() {\n    return new TraitRenderer(this);\n  }\n  splice(start, deleteCount, elements) {\n    const diff = elements.length - deleteCount;\n    const end = start + deleteCount;\n    const indexes = [...this.sortedIndexes.filter(i => i < start), ...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1), ...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)];\n    this.renderer.splice(start, deleteCount, elements.length);\n    this._set(indexes, indexes);\n  }\n  renderIndex(index, container) {\n    container.classList.toggle(this._trait, this.contains(index));\n  }\n  unrender(container) {\n    container.classList.remove(this._trait);\n  }\n  /**\r\n   * Sets the indexes which should have this trait.\r\n   *\r\n   * @param indexes Indexes which should have this trait.\r\n   * @return The old indexes which had this trait.\r\n   */\n  set(indexes, browserEvent) {\n    return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n  }\n  _set(indexes, sortedIndexes, browserEvent) {\n    const result = this.indexes;\n    const sortedResult = this.sortedIndexes;\n    this.indexes = indexes;\n    this.sortedIndexes = sortedIndexes;\n    const toRender = disjunction(sortedResult, indexes);\n    this.renderer.renderIndexes(toRender);\n    this._onChange.fire({\n      indexes,\n      browserEvent\n    });\n    return result;\n  }\n  get() {\n    return this.indexes;\n  }\n  contains(index) {\n    return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n  }\n  dispose() {\n    dispose(this._onChange);\n  }\n}\n__decorate([memoize], Trait.prototype, \"renderer\", null);\nclass SelectionTrait extends Trait {\n  constructor(setAriaSelected) {\n    super('selected');\n    this.setAriaSelected = setAriaSelected;\n  }\n  renderIndex(index, container) {\n    super.renderIndex(index, container);\n    if (this.setAriaSelected) {\n      if (this.contains(index)) {\n        container.setAttribute('aria-selected', 'true');\n      } else {\n        container.setAttribute('aria-selected', 'false');\n      }\n    }\n  }\n}\n/**\r\n * The TraitSpliceable is used as a util class to be able\r\n * to preserve traits across splice calls, given an identity\r\n * provider.\r\n */\nclass TraitSpliceable {\n  constructor(trait, view, identityProvider) {\n    this.trait = trait;\n    this.view = view;\n    this.identityProvider = identityProvider;\n  }\n  splice(start, deleteCount, elements) {\n    if (!this.identityProvider) {\n      return this.trait.splice(start, deleteCount, elements.map(() => false));\n    }\n    const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n    const elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString()) > -1);\n    this.trait.splice(start, deleteCount, elementsWithTrait);\n  }\n}\nexport function isInputElement(e) {\n  return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nexport function isMonacoEditor(e) {\n  if (e.classList.contains('monaco-editor')) {\n    return true;\n  }\n  if (e.classList.contains('monaco-list')) {\n    return false;\n  }\n  if (!e.parentElement) {\n    return false;\n  }\n  return isMonacoEditor(e.parentElement);\n}\nclass KeyboardController {\n  constructor(list, view, options) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    const multipleSelectionSupport = options.multipleSelectionSupport !== false;\n    const onKeyDown = Event.chain(domEvent(view.domNode, 'keydown')).filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e));\n    onKeyDown.filter(e => e.keyCode === 3 /* Enter */).on(this.onEnter, this, this.disposables);\n    onKeyDown.filter(e => e.keyCode === 16 /* UpArrow */).on(this.onUpArrow, this, this.disposables);\n    onKeyDown.filter(e => e.keyCode === 18 /* DownArrow */).on(this.onDownArrow, this, this.disposables);\n    onKeyDown.filter(e => e.keyCode === 11 /* PageUp */).on(this.onPageUpArrow, this, this.disposables);\n    onKeyDown.filter(e => e.keyCode === 12 /* PageDown */).on(this.onPageDownArrow, this, this.disposables);\n    onKeyDown.filter(e => e.keyCode === 9 /* Escape */).on(this.onEscape, this, this.disposables);\n    if (multipleSelectionSupport) {\n      onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KEY_A */).on(this.onCtrlA, this, this.disposables);\n    }\n  }\n  onEnter(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(this.list.getFocus(), e.browserEvent);\n  }\n  onUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPrevious(1, false, e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  }\n  onDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNext(1, false, e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  }\n  onPageUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPreviousPage(e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  }\n  onPageDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNextPage(e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  }\n  onCtrlA(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(range(this.list.length), e.browserEvent);\n    this.view.domNode.focus();\n  }\n  onEscape(e) {\n    if (this.list.getSelection().length) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.list.setSelection([], e.browserEvent);\n      this.view.domNode.focus();\n    }\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nvar TypeLabelControllerState;\n(function (TypeLabelControllerState) {\n  TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\n  TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\nexport const DefaultKeyboardNavigationDelegate = new class {\n  mightProducePrintableCharacter(event) {\n    if (event.ctrlKey || event.metaKey || event.altKey) {\n      return false;\n    }\n    return event.keyCode >= 31 /* KEY_A */ && event.keyCode <= 56 /* KEY_Z */ || event.keyCode >= 21 /* KEY_0 */ && event.keyCode <= 30 /* KEY_9 */ || event.keyCode >= 93 /* NUMPAD_0 */ && event.keyCode <= 102 /* NUMPAD_9 */ || event.keyCode >= 80 /* US_SEMICOLON */ && event.keyCode <= 90 /* US_QUOTE */;\n  }\n}();\n\nclass TypeLabelController {\n  constructor(list, view, keyboardNavigationLabelProvider, delegate) {\n    this.list = list;\n    this.view = view;\n    this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n    this.delegate = delegate;\n    this.enabled = false;\n    this.state = TypeLabelControllerState.Idle;\n    this.automaticKeyboardNavigation = true;\n    this.triggered = false;\n    this.previouslyFocused = -1;\n    this.enabledDisposables = new DisposableStore();\n    this.disposables = new DisposableStore();\n    this.updateOptions(list.options);\n  }\n  updateOptions(options) {\n    const enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n    if (enableKeyboardNavigation) {\n      this.enable();\n    } else {\n      this.disable();\n    }\n    if (typeof options.automaticKeyboardNavigation !== 'undefined') {\n      this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n    }\n  }\n  enable() {\n    if (this.enabled) {\n      return;\n    }\n    const onChar = Event.chain(domEvent(this.view.domNode, 'keydown')).filter(e => !isInputElement(e.target)).filter(() => this.automaticKeyboardNavigation || this.triggered).map(event => new StandardKeyboardEvent(event)).filter(e => this.delegate.mightProducePrintableCharacter(e)).forEach(e => {\n      e.stopPropagation();\n      e.preventDefault();\n    }).map(event => event.browserEvent.key).event;\n    const onClear = Event.debounce(onChar, () => null, 800);\n    const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : (r || '') + i);\n    onInput(this.onInput, this, this.enabledDisposables);\n    onClear(this.onClear, this, this.enabledDisposables);\n    this.enabled = true;\n    this.triggered = false;\n  }\n  disable() {\n    if (!this.enabled) {\n      return;\n    }\n    this.enabledDisposables.clear();\n    this.enabled = false;\n    this.triggered = false;\n  }\n  onClear() {\n    var _a;\n    const focus = this.list.getFocus();\n    if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n      // List: re-anounce element on typing end since typed keys will interupt aria label of focused element\n      // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n      const ariaLabel = (_a = this.list.options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getAriaLabel(this.list.element(focus[0]));\n      if (ariaLabel) {\n        alert(ariaLabel);\n      }\n    }\n    this.previouslyFocused = -1;\n  }\n  onInput(word) {\n    if (!word) {\n      this.state = TypeLabelControllerState.Idle;\n      this.triggered = false;\n      return;\n    }\n    const focus = this.list.getFocus();\n    const start = focus.length > 0 ? focus[0] : 0;\n    const delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n    this.state = TypeLabelControllerState.Typing;\n    for (let i = 0; i < this.list.length; i++) {\n      const index = (start + i + delta) % this.list.length;\n      const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n      const labelStr = label && label.toString();\n      if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n        this.previouslyFocused = start;\n        this.list.setFocus([index]);\n        this.list.reveal(index);\n        return;\n      }\n    }\n  }\n  dispose() {\n    this.disable();\n    this.enabledDisposables.dispose();\n    this.disposables.dispose();\n  }\n}\nclass DOMFocusController {\n  constructor(list, view) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    const onKeyDown = Event.chain(domEvent(view.domNode, 'keydown')).filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e));\n    onKeyDown.filter(e => e.keyCode === 2 /* Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey).on(this.onTab, this, this.disposables);\n  }\n  onTab(e) {\n    if (e.target !== this.view.domNode) {\n      return;\n    }\n    const focus = this.list.getFocus();\n    if (focus.length === 0) {\n      return;\n    }\n    const focusedDomElement = this.view.domElement(focus[0]);\n    if (!focusedDomElement) {\n      return;\n    }\n    const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n    if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n      return;\n    }\n    const style = window.getComputedStyle(tabIndexElement);\n    if (style.visibility === 'hidden' || style.display === 'none') {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    tabIndexElement.focus();\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nexport function isSelectionSingleChangeEvent(event) {\n  return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n  return event.browserEvent.shiftKey;\n}\nfunction isMouseRightClick(event) {\n  return event instanceof MouseEvent && event.button === 2;\n}\nconst DefaultMultipleSelectionController = {\n  isSelectionSingleChangeEvent,\n  isSelectionRangeChangeEvent\n};\nexport class MouseController {\n  constructor(list) {\n    this.list = list;\n    this.disposables = new DisposableStore();\n    this._onPointer = new Emitter();\n    this.onPointer = this._onPointer.event;\n    this.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\n    if (this.multipleSelectionSupport) {\n      this.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionController;\n    }\n    this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n    if (this.mouseSupport) {\n      list.onMouseDown(this.onMouseDown, this, this.disposables);\n      list.onContextMenu(this.onContextMenu, this, this.disposables);\n      list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n      list.onTouchStart(this.onMouseDown, this, this.disposables);\n      this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n    }\n    Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n  }\n  isSelectionSingleChangeEvent(event) {\n    if (this.multipleSelectionController) {\n      return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n    }\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n  }\n  isSelectionRangeChangeEvent(event) {\n    if (this.multipleSelectionController) {\n      return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n    }\n    return event.browserEvent.shiftKey;\n  }\n  isSelectionChangeEvent(event) {\n    return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n  }\n  onMouseDown(e) {\n    if (isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    if (document.activeElement !== e.browserEvent.target) {\n      this.list.domFocus();\n    }\n  }\n  onContextMenu(e) {\n    if (isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    const focus = typeof e.index === 'undefined' ? [] : [e.index];\n    this.list.setFocus(focus, e.browserEvent);\n  }\n  onViewPointer(e) {\n    if (!this.mouseSupport) {\n      return;\n    }\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    let reference = this.list.getFocus()[0];\n    const selection = this.list.getSelection();\n    reference = reference === undefined ? selection[0] : reference;\n    const focus = e.index;\n    if (typeof focus === 'undefined') {\n      this.list.setFocus([], e.browserEvent);\n      this.list.setSelection([], e.browserEvent);\n      return;\n    }\n    if (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\n      return this.changeSelection(e, reference);\n    }\n    if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n      return this.changeSelection(e, reference);\n    }\n    this.list.setFocus([focus], e.browserEvent);\n    if (!isMouseRightClick(e.browserEvent)) {\n      this.list.setSelection([focus], e.browserEvent);\n    }\n    this._onPointer.fire(e);\n  }\n  onDoubleClick(e) {\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n      return;\n    }\n    const focus = this.list.getFocus();\n    this.list.setSelection(focus, e.browserEvent);\n  }\n  changeSelection(e, reference) {\n    const focus = e.index;\n    if (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\n      const min = Math.min(reference, focus);\n      const max = Math.max(reference, focus);\n      const rangeSelection = range(min, max + 1);\n      const selection = this.list.getSelection();\n      const contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\n      if (contiguousRange.length === 0) {\n        return;\n      }\n      const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n      this.list.setSelection(newSelection, e.browserEvent);\n    } else if (this.isSelectionSingleChangeEvent(e)) {\n      const selection = this.list.getSelection();\n      const newSelection = selection.filter(i => i !== focus);\n      this.list.setFocus([focus]);\n      if (selection.length === newSelection.length) {\n        this.list.setSelection([...newSelection, focus], e.browserEvent);\n      } else {\n        this.list.setSelection(newSelection, e.browserEvent);\n      }\n    }\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nexport class DefaultStyleController {\n  constructor(styleElement, selectorSuffix) {\n    this.styleElement = styleElement;\n    this.selectorSuffix = selectorSuffix;\n  }\n  style(styles) {\n    const suffix = this.selectorSuffix && \".\".concat(this.selectorSuffix);\n    const content = [];\n    if (styles.listBackground) {\n      if (styles.listBackground.isOpaque()) {\n        content.push(\".monaco-list\".concat(suffix, \" .monaco-list-rows { background: \").concat(styles.listBackground, \"; }\"));\n      } else if (!platform.isMacintosh) {\n        // subpixel AA doesn't exist in macOS\n        console.warn(\"List with id '\".concat(this.selectorSuffix, \"' was styled with a non-opaque background color. This will break sub-pixel antialiasing.\"));\n      }\n    }\n    if (styles.listFocusBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { background-color: \").concat(styles.listFocusBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused:hover { background-color: \").concat(styles.listFocusBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n\n    if (styles.listFocusForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { color: \").concat(styles.listFocusForeground, \"; }\"));\n    }\n    if (styles.listActiveSelectionBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected { background-color: \").concat(styles.listActiveSelectionBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected:hover { background-color: \").concat(styles.listActiveSelectionBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n\n    if (styles.listActiveSelectionForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected { color: \").concat(styles.listActiveSelectionForeground, \"; }\"));\n    }\n    if (styles.listFocusAndSelectionBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.selected.focused { background-color: \").concat(styles.listFocusAndSelectionBackground, \"; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listFocusAndSelectionForeground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.selected.focused { color: \").concat(styles.listFocusAndSelectionForeground, \"; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listInactiveFocusBackground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused { background-color:  \").concat(styles.listInactiveFocusBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused:hover { background-color:  \").concat(styles.listInactiveFocusBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionBackground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { background-color:  \").concat(styles.listInactiveSelectionBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected:hover { background-color:  \").concat(styles.listInactiveSelectionBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionForeground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { color: \").concat(styles.listInactiveSelectionForeground, \"; }\"));\n    }\n    if (styles.listHoverBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  \").concat(styles.listHoverBackground, \"; }\"));\n    }\n    if (styles.listHoverForeground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row:hover:not(.selected):not(.focused) { color:  \").concat(styles.listHoverForeground, \"; }\"));\n    }\n    if (styles.listSelectionOutline) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { outline: 1px dotted \").concat(styles.listSelectionOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listFocusOutline) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { outline: 1px solid \").concat(styles.listFocusOutline, \"; outline-offset: -1px; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listInactiveFocusOutline) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused { outline: 1px dotted \").concat(styles.listInactiveFocusOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listHoverOutline) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row:hover { outline: 1px dashed \").concat(styles.listHoverOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listDropBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \".drop-target,\\n\\t\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-rows.drop-target,\\n\\t\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-row.drop-target { background-color: \").concat(styles.listDropBackground, \" !important; color: inherit !important; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listFilterWidgetBackground) {\n      content.push(\".monaco-list-type-filter { background-color: \".concat(styles.listFilterWidgetBackground, \" }\"));\n    }\n    if (styles.listFilterWidgetOutline) {\n      content.push(\".monaco-list-type-filter { border: 1px solid \".concat(styles.listFilterWidgetOutline, \"; }\"));\n    }\n    if (styles.listFilterWidgetNoMatchesOutline) {\n      content.push(\".monaco-list-type-filter.no-matches { border: 1px solid \".concat(styles.listFilterWidgetNoMatchesOutline, \"; }\"));\n    }\n    if (styles.listMatchesShadow) {\n      content.push(\".monaco-list-type-filter { box-shadow: 1px 1px 1px \".concat(styles.listMatchesShadow, \"; }\"));\n    }\n    this.styleElement.textContent = content.join('\\n');\n  }\n}\nconst defaultStyles = {\n  listFocusBackground: Color.fromHex('#7FB0D0'),\n  listActiveSelectionBackground: Color.fromHex('#0E639C'),\n  listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n  listFocusAndSelectionBackground: Color.fromHex('#094771'),\n  listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n  listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n  listHoverBackground: Color.fromHex('#2A2D2E'),\n  listDropBackground: Color.fromHex('#383B3D'),\n  treeIndentGuidesStroke: Color.fromHex('#a9a9a9')\n};\nconst DefaultOptions = {\n  keyboardSupport: true,\n  mouseSupport: true,\n  multipleSelectionSupport: true,\n  dnd: {\n    getDragURI() {\n      return null;\n    },\n    onDragStart() {},\n    onDragOver() {\n      return false;\n    },\n    drop() {}\n  }\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n  const index = range.indexOf(value);\n  if (index === -1) {\n    return [];\n  }\n  const result = [];\n  let i = index - 1;\n  while (i >= 0 && range[i] === value - (index - i)) {\n    result.push(range[i--]);\n  }\n  result.reverse();\n  i = index;\n  while (i < range.length && range[i] === value + (i - index)) {\n    result.push(range[i++]);\n  }\n  return result;\n}\n/**\r\n * Given two sorted collections of numbers, returns the intersection\r\n * between them (OR).\r\n */\nfunction disjunction(one, other) {\n  const result = [];\n  let i = 0,\n    j = 0;\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      result.push(one[i]);\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      result.push(other[j++]);\n    }\n  }\n  return result;\n}\n/**\r\n * Given two sorted collections of numbers, returns the relative\r\n * complement between them (XOR).\r\n */\nfunction relativeComplement(one, other) {\n  const result = [];\n  let i = 0,\n    j = 0;\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      j++;\n    }\n  }\n  return result;\n}\nconst numericSort = (a, b) => a - b;\nclass PipelineRenderer {\n  constructor(_templateId, renderers) {\n    this._templateId = _templateId;\n    this.renderers = renderers;\n  }\n  get templateId() {\n    return this._templateId;\n  }\n  renderTemplate(container) {\n    return this.renderers.map(r => r.renderTemplate(container));\n  }\n  renderElement(element, index, templateData, height) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      renderer.renderElement(element, index, templateData[i++], height);\n    }\n  }\n  disposeElement(element, index, templateData, height) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      if (renderer.disposeElement) {\n        renderer.disposeElement(element, index, templateData[i], height);\n      }\n      i += 1;\n    }\n  }\n  disposeTemplate(templateData) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      renderer.disposeTemplate(templateData[i++]);\n    }\n  }\n}\nclass AccessibiltyRenderer {\n  constructor(accessibilityProvider) {\n    this.accessibilityProvider = accessibilityProvider;\n    this.templateId = 'a18n';\n  }\n  renderTemplate(container) {\n    return container;\n  }\n  renderElement(element, index, container) {\n    const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n    if (ariaLabel) {\n      container.setAttribute('aria-label', ariaLabel);\n    } else {\n      container.removeAttribute('aria-label');\n    }\n    const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n    if (typeof ariaLevel === 'number') {\n      container.setAttribute('aria-level', \"\".concat(ariaLevel));\n    } else {\n      container.removeAttribute('aria-level');\n    }\n  }\n  disposeTemplate(templateData) {\n    // noop\n  }\n}\nclass ListViewDragAndDrop {\n  constructor(list, dnd) {\n    this.list = list;\n    this.dnd = dnd;\n  }\n  getDragElements(element) {\n    const selection = this.list.getSelectedElements();\n    const elements = selection.indexOf(element) > -1 ? selection : [element];\n    return elements;\n  }\n  getDragURI(element) {\n    return this.dnd.getDragURI(element);\n  }\n  getDragLabel(elements, originalEvent) {\n    if (this.dnd.getDragLabel) {\n      return this.dnd.getDragLabel(elements, originalEvent);\n    }\n    return undefined;\n  }\n  onDragStart(data, originalEvent) {\n    if (this.dnd.onDragStart) {\n      this.dnd.onDragStart(data, originalEvent);\n    }\n  }\n  onDragOver(data, targetElement, targetIndex, originalEvent) {\n    return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n  }\n  onDragEnd(originalEvent) {\n    if (this.dnd.onDragEnd) {\n      this.dnd.onDragEnd(originalEvent);\n    }\n  }\n  drop(data, targetElement, targetIndex, originalEvent) {\n    this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n  }\n}\nexport class List {\n  constructor(user, container, virtualDelegate, renderers) {\n    let _options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : DefaultOptions;\n    var _a;\n    this.user = user;\n    this._options = _options;\n    this.eventBufferer = new EventBufferer();\n    this._ariaLabel = '';\n    this.disposables = new DisposableStore();\n    this.didJustPressContextMenuKey = false;\n    this._onDidDispose = new Emitter();\n    this.onDidDispose = this._onDidDispose.event;\n    const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_a = this._options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getWidgetRole() : 'list';\n    this.selection = new SelectionTrait(role !== 'listbox');\n    this.focus = new Trait('focused');\n    mixin(_options, defaultStyles, false);\n    const baseRenderers = [this.focus.renderer, this.selection.renderer];\n    this.accessibilityProvider = _options.accessibilityProvider;\n    if (this.accessibilityProvider) {\n      baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n      if (this.accessibilityProvider.onDidChangeActiveDescendant) {\n        this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\n      }\n    }\n    renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n    const viewOptions = Object.assign(Object.assign({}, _options), {\n      dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n    });\n    this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n    this.view.domNode.setAttribute('role', role);\n    if (_options.styleController) {\n      this.styleController = _options.styleController(this.view.domId);\n    } else {\n      const styleElement = createStyleSheet(this.view.domNode);\n      this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n    }\n    this.spliceable = new CombinedSpliceable([new TraitSpliceable(this.focus, this.view, _options.identityProvider), new TraitSpliceable(this.selection, this.view, _options.identityProvider), this.view]);\n    this.disposables.add(this.focus);\n    this.disposables.add(this.selection);\n    this.disposables.add(this.view);\n    this.disposables.add(this._onDidDispose);\n    this.onDidFocus = Event.map(domEvent(this.view.domNode, 'focus', true), () => null);\n    this.onDidBlur = Event.map(domEvent(this.view.domNode, 'blur', true), () => null);\n    this.disposables.add(new DOMFocusController(this, this.view));\n    if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n      const controller = new KeyboardController(this, this.view, _options);\n      this.disposables.add(controller);\n    }\n    if (_options.keyboardNavigationLabelProvider) {\n      const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n      this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\n      this.disposables.add(this.typeLabelController);\n    }\n    this.mouseController = this.createMouseController(_options);\n    this.disposables.add(this.mouseController);\n    this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n    this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n    if (this.accessibilityProvider) {\n      this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n    }\n    if (_options.multipleSelectionSupport) {\n      this.view.domNode.setAttribute('aria-multiselectable', 'true');\n    }\n  }\n  get onDidChangeFocus() {\n    return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e));\n  }\n  get onDidChangeSelection() {\n    return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e));\n  }\n  get domId() {\n    return this.view.domId;\n  }\n  get onMouseClick() {\n    return this.view.onMouseClick;\n  }\n  get onMouseDblClick() {\n    return this.view.onMouseDblClick;\n  }\n  get onMouseMiddleClick() {\n    return this.view.onMouseMiddleClick;\n  }\n  get onPointer() {\n    return this.mouseController.onPointer;\n  }\n  get onMouseDown() {\n    return this.view.onMouseDown;\n  }\n  get onTouchStart() {\n    return this.view.onTouchStart;\n  }\n  get onTap() {\n    return this.view.onTap;\n  }\n  get onContextMenu() {\n    const fromKeydown = Event.chain(domEvent(this.view.domNode, 'keydown')).map(e => new StandardKeyboardEvent(e)).filter(e => this.didJustPressContextMenuKey = e.keyCode === 58 /* ContextMenu */ || e.shiftKey && e.keyCode === 68 /* F10 */).filter(e => {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }).event;\n    const fromKeyup = Event.chain(domEvent(this.view.domNode, 'keyup')).filter(() => {\n      const didJustPressContextMenuKey = this.didJustPressContextMenuKey;\n      this.didJustPressContextMenuKey = false;\n      return didJustPressContextMenuKey;\n    }).filter(() => this.getFocus().length > 0 && !!this.view.domElement(this.getFocus()[0])).map(browserEvent => {\n      const index = this.getFocus()[0];\n      const element = this.view.element(index);\n      const anchor = this.view.domElement(index);\n      return {\n        index,\n        element,\n        anchor,\n        browserEvent\n      };\n    }).event;\n    const fromMouse = Event.chain(this.view.onContextMenu).filter(() => !this.didJustPressContextMenuKey).map(_ref => {\n      let {\n        element,\n        index,\n        browserEvent\n      } = _ref;\n      return {\n        element,\n        index,\n        anchor: {\n          x: browserEvent.clientX + 1,\n          y: browserEvent.clientY\n        },\n        browserEvent\n      };\n    }).event;\n    return Event.any(fromKeydown, fromKeyup, fromMouse);\n  }\n  get onKeyDown() {\n    return domEvent(this.view.domNode, 'keydown');\n  }\n  createMouseController(options) {\n    return new MouseController(this);\n  }\n  updateOptions() {\n    let optionsUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this._options = Object.assign(Object.assign({}, this._options), optionsUpdate);\n    if (this.typeLabelController) {\n      this.typeLabelController.updateOptions(this._options);\n    }\n    this.view.updateOptions(optionsUpdate);\n  }\n  get options() {\n    return this._options;\n  }\n  splice(start, deleteCount) {\n    let elements = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    if (start < 0 || start > this.view.length) {\n      throw new ListError(this.user, \"Invalid start index: \".concat(start));\n    }\n    if (deleteCount < 0) {\n      throw new ListError(this.user, \"Invalid delete count: \".concat(deleteCount));\n    }\n    if (deleteCount === 0 && elements.length === 0) {\n      return;\n    }\n    this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n  }\n  rerender() {\n    this.view.rerender();\n  }\n  element(index) {\n    return this.view.element(index);\n  }\n  get length() {\n    return this.view.length;\n  }\n  get contentHeight() {\n    return this.view.contentHeight;\n  }\n  get scrollTop() {\n    return this.view.getScrollTop();\n  }\n  set scrollTop(scrollTop) {\n    this.view.setScrollTop(scrollTop);\n  }\n  get ariaLabel() {\n    return this._ariaLabel;\n  }\n  set ariaLabel(value) {\n    this._ariaLabel = value;\n    this.view.domNode.setAttribute('aria-label', value);\n  }\n  domFocus() {\n    this.view.domNode.focus();\n  }\n  layout(height, width) {\n    this.view.layout(height, width);\n  }\n  setSelection(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \".concat(index));\n      }\n    }\n    this.selection.set(indexes, browserEvent);\n  }\n  getSelection() {\n    return this.selection.get();\n  }\n  getSelectedElements() {\n    return this.getSelection().map(i => this.view.element(i));\n  }\n  setFocus(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \".concat(index));\n      }\n    }\n    this.focus.set(indexes, browserEvent);\n  }\n  focusNext() {\n    let n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let browserEvent = arguments.length > 2 ? arguments[2] : undefined;\n    let filter = arguments.length > 3 ? arguments[3] : undefined;\n    if (this.length === 0) {\n      return;\n    }\n    const focus = this.focus.get();\n    const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  focusPrevious() {\n    let n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let browserEvent = arguments.length > 2 ? arguments[2] : undefined;\n    let filter = arguments.length > 3 ? arguments[3] : undefined;\n    if (this.length === 0) {\n      return;\n    }\n    const focus = this.focus.get();\n    const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  focusNextPage(browserEvent, filter) {\n    let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n    lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n    const lastPageElement = this.view.element(lastPageIndex);\n    const currentlyFocusedElement = this.getFocusedElements()[0];\n    if (currentlyFocusedElement !== lastPageElement) {\n      const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n      if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n        this.setFocus([lastGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([lastPageIndex], browserEvent);\n      }\n    } else {\n      const previousScrollTop = this.view.getScrollTop();\n      this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n      if (this.view.getScrollTop() !== previousScrollTop) {\n        this.setFocus([]);\n        // Let the scroll event listener run\n        setTimeout(() => this.focusNextPage(browserEvent, filter), 0);\n      }\n    }\n  }\n  focusPreviousPage(browserEvent, filter) {\n    let firstPageIndex;\n    const scrollTop = this.view.getScrollTop();\n    if (scrollTop === 0) {\n      firstPageIndex = this.view.indexAt(scrollTop);\n    } else {\n      firstPageIndex = this.view.indexAfter(scrollTop - 1);\n    }\n    const firstPageElement = this.view.element(firstPageIndex);\n    const currentlyFocusedElement = this.getFocusedElements()[0];\n    if (currentlyFocusedElement !== firstPageElement) {\n      const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n      if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n        this.setFocus([firstGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([firstPageIndex], browserEvent);\n      }\n    } else {\n      const previousScrollTop = scrollTop;\n      this.view.setScrollTop(scrollTop - this.view.renderHeight);\n      if (this.view.getScrollTop() !== previousScrollTop) {\n        this.setFocus([]);\n        // Let the scroll event listener run\n        setTimeout(() => this.focusPreviousPage(browserEvent, filter), 0);\n      }\n    }\n  }\n  focusLast(browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n    const index = this.findPreviousIndex(this.length - 1, false, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  focusFirst(browserEvent, filter) {\n    this.focusNth(0, browserEvent, filter);\n  }\n  focusNth(n, browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n    const index = this.findNextIndex(n, false, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  findNextIndex(index) {\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let filter = arguments.length > 2 ? arguments[2] : undefined;\n    for (let i = 0; i < this.length; i++) {\n      if (index >= this.length && !loop) {\n        return -1;\n      }\n      index = index % this.length;\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n      index++;\n    }\n    return -1;\n  }\n  findPreviousIndex(index) {\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let filter = arguments.length > 2 ? arguments[2] : undefined;\n    for (let i = 0; i < this.length; i++) {\n      if (index < 0 && !loop) {\n        return -1;\n      }\n      index = (this.length + index % this.length) % this.length;\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n      index--;\n    }\n    return -1;\n  }\n  getFocus() {\n    return this.focus.get();\n  }\n  getFocusedElements() {\n    return this.getFocus().map(i => this.view.element(i));\n  }\n  reveal(index, relativeTop) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \".concat(index));\n    }\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n    if (isNumber(relativeTop)) {\n      // y = mx + b\n      const m = elementHeight - this.view.renderHeight;\n      this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n    } else {\n      const viewItemBottom = elementTop + elementHeight;\n      const wrapperBottom = scrollTop + this.view.renderHeight;\n      if (elementTop < scrollTop && viewItemBottom >= wrapperBottom) {\n        // The element is already overflowing the viewport, no-op\n      } else if (elementTop < scrollTop) {\n        this.view.setScrollTop(elementTop);\n      } else if (viewItemBottom >= wrapperBottom) {\n        this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n      }\n    }\n  }\n  /**\r\n   * Returns the relative position of an element rendered in the list.\r\n   * Returns `null` if the element isn't *entirely* in the visible viewport.\r\n   */\n  getRelativeTop(index) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \".concat(index));\n    }\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n    if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n      return null;\n    }\n    // y = mx + b\n    const m = elementHeight - this.view.renderHeight;\n    return Math.abs((scrollTop - elementTop) / m);\n  }\n  getHTMLElement() {\n    return this.view.domNode;\n  }\n  style(styles) {\n    this.styleController.style(styles);\n  }\n  toListEvent(_ref2) {\n    let {\n      indexes,\n      browserEvent\n    } = _ref2;\n    return {\n      indexes,\n      elements: indexes.map(i => this.view.element(i)),\n      browserEvent\n    };\n  }\n  _onFocusChange() {\n    const focus = this.focus.get();\n    this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n    this.onDidChangeActiveDescendant();\n  }\n  onDidChangeActiveDescendant() {\n    var _a;\n    const focus = this.focus.get();\n    if (focus.length > 0) {\n      let id;\n      if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\n        id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n      }\n      this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n    } else {\n      this.view.domNode.removeAttribute('aria-activedescendant');\n    }\n  }\n  _onSelectionChange() {\n    const selection = this.selection.get();\n    this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n    this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n    this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n  }\n  dispose() {\n    this._onDidDispose.fire();\n    this.disposables.dispose();\n    this._onDidDispose.dispose();\n  }\n}\n__decorate([memoize], List.prototype, \"onDidChangeFocus\", null);\n__decorate([memoize], List.prototype, \"onDidChangeSelection\", null);\n__decorate([memoize], List.prototype, \"onContextMenu\", null);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","dispose","DisposableStore","isNumber","range","binarySearch","memoize","platform","Gesture","StandardKeyboardEvent","Event","Emitter","EventBufferer","domEvent","ListError","ListView","Color","mixin","CombinedSpliceable","clamp","matchesPrefix","alert","createStyleSheet","TraitRenderer","constructor","trait","renderedElements","templateId","concat","renderTemplate","container","renderElement","element","index","templateData","renderedElementIndex","findIndex","el","rendered","unrender","push","renderIndex","splice","start","deleteCount","insertCount","renderedElement","renderIndexes","indexes","indexOf","disposeTemplate","Trait","_trait","sortedIndexes","_onChange","onChange","event","renderer","elements","diff","end","filter","map","hasTrait","_set","classList","toggle","contains","remove","set","browserEvent","sort","numericSort","result","sortedResult","toRender","disjunction","fire","get","prototype","SelectionTrait","setAriaSelected","setAttribute","TraitSpliceable","view","identityProvider","pastElementsWithTrait","getId","toString","elementsWithTrait","e","isInputElement","tagName","isMonacoEditor","parentElement","KeyboardController","list","options","disposables","multipleSelectionSupport","onKeyDown","chain","domNode","keyCode","on","onEnter","onUpArrow","onDownArrow","onPageUpArrow","onPageDownArrow","onEscape","isMacintosh","metaKey","ctrlKey","onCtrlA","preventDefault","stopPropagation","setSelection","getFocus","focusPrevious","reveal","focus","focusNext","focusPreviousPage","focusNextPage","getSelection","TypeLabelControllerState","DefaultKeyboardNavigationDelegate","mightProducePrintableCharacter","altKey","TypeLabelController","keyboardNavigationLabelProvider","delegate","enabled","state","Idle","automaticKeyboardNavigation","triggered","previouslyFocused","enabledDisposables","updateOptions","enableKeyboardNavigation","enable","disable","onChar","forEach","onClear","debounce","onInput","reduce","any","clear","_a","ariaLabel","accessibilityProvider","getAriaLabel","word","delta","Typing","label","getKeyboardNavigationLabel","labelStr","setFocus","DOMFocusController","shiftKey","onTab","focusedDomElement","domElement","tabIndexElement","querySelector","HTMLElement","tabIndex","style","window","getComputedStyle","visibility","display","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","isMouseRightClick","MouseEvent","button","DefaultMultipleSelectionController","MouseController","_onPointer","onPointer","multipleSelectionController","mouseSupport","onMouseDown","onContextMenu","onMouseDblClick","onDoubleClick","onTouchStart","add","addTarget","getHTMLElement","onMouseClick","onMouseMiddleClick","onTap","onViewPointer","isSelectionChangeEvent","document","activeElement","domFocus","reference","selection","undefined","changeSelection","min","Math","max","rangeSelection","contiguousRange","getContiguousRangeContaining","newSelection","relativeComplement","DefaultStyleController","styleElement","selectorSuffix","styles","suffix","content","listBackground","isOpaque","console","warn","listFocusBackground","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveFocusBackground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listSelectionOutline","listFocusOutline","listInactiveFocusOutline","listHoverOutline","listDropBackground","listFilterWidgetBackground","listFilterWidgetOutline","listFilterWidgetNoMatchesOutline","listMatchesShadow","textContent","join","defaultStyles","fromHex","treeIndentGuidesStroke","DefaultOptions","keyboardSupport","dnd","getDragURI","onDragStart","onDragOver","drop","value","reverse","one","other","j","a","b","PipelineRenderer","_templateId","renderers","height","disposeElement","AccessibiltyRenderer","removeAttribute","ariaLevel","getAriaLevel","ListViewDragAndDrop","getDragElements","getSelectedElements","getDragLabel","originalEvent","data","targetElement","targetIndex","onDragEnd","List","user","virtualDelegate","_options","eventBufferer","_ariaLabel","didJustPressContextMenuKey","_onDidDispose","onDidDispose","role","getWidgetRole","baseRenderers","onDidChangeActiveDescendant","viewOptions","assign","styleController","domId","spliceable","onDidFocus","onDidBlur","controller","keyboardNavigationDelegate","typeLabelController","mouseController","createMouseController","onDidChangeFocus","_onFocusChange","onDidChangeSelection","_onSelectionChange","getWidgetAriaLabel","wrapEvent","toListEvent","fromKeydown","fromKeyup","anchor","fromMouse","_ref","x","clientX","y","clientY","optionsUpdate","bufferEvents","rerender","contentHeight","scrollTop","getScrollTop","setScrollTop","layout","width","n","loop","findNextIndex","findPreviousIndex","lastPageIndex","indexAt","renderHeight","lastPageElement","currentlyFocusedElement","getFocusedElements","lastGoodPageIndex","previousScrollTop","elementHeight","setTimeout","firstPageIndex","indexAfter","firstPageElement","firstGoodPageIndex","focusLast","focusFirst","focusNth","relativeTop","elementTop","m","viewItemBottom","wrapperBottom","getRelativeTop","abs","_ref2","id","getActiveDescendantId","getElementDomId"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport './list.css';\r\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\r\nimport { isNumber } from '../../../common/types.js';\r\nimport { range, binarySearch } from '../../../common/arrays.js';\r\nimport { memoize } from '../../../common/decorators.js';\r\nimport * as platform from '../../../common/platform.js';\r\nimport { Gesture } from '../../touch.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { Event, Emitter, EventBufferer } from '../../../common/event.js';\r\nimport { domEvent } from '../../event.js';\r\nimport { ListError } from './list.js';\r\nimport { ListView } from './listView.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { CombinedSpliceable } from './splice.js';\r\nimport { clamp } from '../../../common/numbers.js';\r\nimport { matchesPrefix } from '../../../common/filters.js';\r\nimport { alert } from '../aria/aria.js';\r\nimport { createStyleSheet } from '../../dom.js';\r\nclass TraitRenderer {\r\n    constructor(trait) {\r\n        this.trait = trait;\r\n        this.renderedElements = [];\r\n    }\r\n    get templateId() {\r\n        return `template:${this.trait.trait}`;\r\n    }\r\n    renderTemplate(container) {\r\n        return container;\r\n    }\r\n    renderElement(element, index, templateData) {\r\n        const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\r\n        if (renderedElementIndex >= 0) {\r\n            const rendered = this.renderedElements[renderedElementIndex];\r\n            this.trait.unrender(templateData);\r\n            rendered.index = index;\r\n        }\r\n        else {\r\n            const rendered = { index, templateData };\r\n            this.renderedElements.push(rendered);\r\n        }\r\n        this.trait.renderIndex(index, templateData);\r\n    }\r\n    splice(start, deleteCount, insertCount) {\r\n        const rendered = [];\r\n        for (const renderedElement of this.renderedElements) {\r\n            if (renderedElement.index < start) {\r\n                rendered.push(renderedElement);\r\n            }\r\n            else if (renderedElement.index >= start + deleteCount) {\r\n                rendered.push({\r\n                    index: renderedElement.index + insertCount - deleteCount,\r\n                    templateData: renderedElement.templateData\r\n                });\r\n            }\r\n        }\r\n        this.renderedElements = rendered;\r\n    }\r\n    renderIndexes(indexes) {\r\n        for (const { index, templateData } of this.renderedElements) {\r\n            if (indexes.indexOf(index) > -1) {\r\n                this.trait.renderIndex(index, templateData);\r\n            }\r\n        }\r\n    }\r\n    disposeTemplate(templateData) {\r\n        const index = this.renderedElements.findIndex(el => el.templateData === templateData);\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        this.renderedElements.splice(index, 1);\r\n    }\r\n}\r\nclass Trait {\r\n    constructor(_trait) {\r\n        this._trait = _trait;\r\n        this.indexes = [];\r\n        this.sortedIndexes = [];\r\n        this._onChange = new Emitter();\r\n        this.onChange = this._onChange.event;\r\n    }\r\n    get trait() { return this._trait; }\r\n    get renderer() {\r\n        return new TraitRenderer(this);\r\n    }\r\n    splice(start, deleteCount, elements) {\r\n        const diff = elements.length - deleteCount;\r\n        const end = start + deleteCount;\r\n        const indexes = [\r\n            ...this.sortedIndexes.filter(i => i < start),\r\n            ...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1),\r\n            ...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)\r\n        ];\r\n        this.renderer.splice(start, deleteCount, elements.length);\r\n        this._set(indexes, indexes);\r\n    }\r\n    renderIndex(index, container) {\r\n        container.classList.toggle(this._trait, this.contains(index));\r\n    }\r\n    unrender(container) {\r\n        container.classList.remove(this._trait);\r\n    }\r\n    /**\r\n     * Sets the indexes which should have this trait.\r\n     *\r\n     * @param indexes Indexes which should have this trait.\r\n     * @return The old indexes which had this trait.\r\n     */\r\n    set(indexes, browserEvent) {\r\n        return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\r\n    }\r\n    _set(indexes, sortedIndexes, browserEvent) {\r\n        const result = this.indexes;\r\n        const sortedResult = this.sortedIndexes;\r\n        this.indexes = indexes;\r\n        this.sortedIndexes = sortedIndexes;\r\n        const toRender = disjunction(sortedResult, indexes);\r\n        this.renderer.renderIndexes(toRender);\r\n        this._onChange.fire({ indexes, browserEvent });\r\n        return result;\r\n    }\r\n    get() {\r\n        return this.indexes;\r\n    }\r\n    contains(index) {\r\n        return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\r\n    }\r\n    dispose() {\r\n        dispose(this._onChange);\r\n    }\r\n}\r\n__decorate([\r\n    memoize\r\n], Trait.prototype, \"renderer\", null);\r\nclass SelectionTrait extends Trait {\r\n    constructor(setAriaSelected) {\r\n        super('selected');\r\n        this.setAriaSelected = setAriaSelected;\r\n    }\r\n    renderIndex(index, container) {\r\n        super.renderIndex(index, container);\r\n        if (this.setAriaSelected) {\r\n            if (this.contains(index)) {\r\n                container.setAttribute('aria-selected', 'true');\r\n            }\r\n            else {\r\n                container.setAttribute('aria-selected', 'false');\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * The TraitSpliceable is used as a util class to be able\r\n * to preserve traits across splice calls, given an identity\r\n * provider.\r\n */\r\nclass TraitSpliceable {\r\n    constructor(trait, view, identityProvider) {\r\n        this.trait = trait;\r\n        this.view = view;\r\n        this.identityProvider = identityProvider;\r\n    }\r\n    splice(start, deleteCount, elements) {\r\n        if (!this.identityProvider) {\r\n            return this.trait.splice(start, deleteCount, elements.map(() => false));\r\n        }\r\n        const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\r\n        const elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString()) > -1);\r\n        this.trait.splice(start, deleteCount, elementsWithTrait);\r\n    }\r\n}\r\nexport function isInputElement(e) {\r\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\r\n}\r\nexport function isMonacoEditor(e) {\r\n    if (e.classList.contains('monaco-editor')) {\r\n        return true;\r\n    }\r\n    if (e.classList.contains('monaco-list')) {\r\n        return false;\r\n    }\r\n    if (!e.parentElement) {\r\n        return false;\r\n    }\r\n    return isMonacoEditor(e.parentElement);\r\n}\r\nclass KeyboardController {\r\n    constructor(list, view, options) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.disposables = new DisposableStore();\r\n        const multipleSelectionSupport = options.multipleSelectionSupport !== false;\r\n        const onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\r\n            .filter(e => !isInputElement(e.target))\r\n            .map(e => new StandardKeyboardEvent(e));\r\n        onKeyDown.filter(e => e.keyCode === 3 /* Enter */).on(this.onEnter, this, this.disposables);\r\n        onKeyDown.filter(e => e.keyCode === 16 /* UpArrow */).on(this.onUpArrow, this, this.disposables);\r\n        onKeyDown.filter(e => e.keyCode === 18 /* DownArrow */).on(this.onDownArrow, this, this.disposables);\r\n        onKeyDown.filter(e => e.keyCode === 11 /* PageUp */).on(this.onPageUpArrow, this, this.disposables);\r\n        onKeyDown.filter(e => e.keyCode === 12 /* PageDown */).on(this.onPageDownArrow, this, this.disposables);\r\n        onKeyDown.filter(e => e.keyCode === 9 /* Escape */).on(this.onEscape, this, this.disposables);\r\n        if (multipleSelectionSupport) {\r\n            onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KEY_A */).on(this.onCtrlA, this, this.disposables);\r\n        }\r\n    }\r\n    onEnter(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\r\n    }\r\n    onUpArrow(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusPrevious(1, false, e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    }\r\n    onDownArrow(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusNext(1, false, e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    }\r\n    onPageUpArrow(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusPreviousPage(e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    }\r\n    onPageDownArrow(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusNextPage(e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    }\r\n    onCtrlA(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.setSelection(range(this.list.length), e.browserEvent);\r\n        this.view.domNode.focus();\r\n    }\r\n    onEscape(e) {\r\n        if (this.list.getSelection().length) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.list.setSelection([], e.browserEvent);\r\n            this.view.domNode.focus();\r\n        }\r\n    }\r\n    dispose() {\r\n        this.disposables.dispose();\r\n    }\r\n}\r\nvar TypeLabelControllerState;\r\n(function (TypeLabelControllerState) {\r\n    TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\r\n    TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\r\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\r\nexport const DefaultKeyboardNavigationDelegate = new class {\r\n    mightProducePrintableCharacter(event) {\r\n        if (event.ctrlKey || event.metaKey || event.altKey) {\r\n            return false;\r\n        }\r\n        return (event.keyCode >= 31 /* KEY_A */ && event.keyCode <= 56 /* KEY_Z */)\r\n            || (event.keyCode >= 21 /* KEY_0 */ && event.keyCode <= 30 /* KEY_9 */)\r\n            || (event.keyCode >= 93 /* NUMPAD_0 */ && event.keyCode <= 102 /* NUMPAD_9 */)\r\n            || (event.keyCode >= 80 /* US_SEMICOLON */ && event.keyCode <= 90 /* US_QUOTE */);\r\n    }\r\n};\r\nclass TypeLabelController {\r\n    constructor(list, view, keyboardNavigationLabelProvider, delegate) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\r\n        this.delegate = delegate;\r\n        this.enabled = false;\r\n        this.state = TypeLabelControllerState.Idle;\r\n        this.automaticKeyboardNavigation = true;\r\n        this.triggered = false;\r\n        this.previouslyFocused = -1;\r\n        this.enabledDisposables = new DisposableStore();\r\n        this.disposables = new DisposableStore();\r\n        this.updateOptions(list.options);\r\n    }\r\n    updateOptions(options) {\r\n        const enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\r\n        if (enableKeyboardNavigation) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n        if (typeof options.automaticKeyboardNavigation !== 'undefined') {\r\n            this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\r\n        }\r\n    }\r\n    enable() {\r\n        if (this.enabled) {\r\n            return;\r\n        }\r\n        const onChar = Event.chain(domEvent(this.view.domNode, 'keydown'))\r\n            .filter(e => !isInputElement(e.target))\r\n            .filter(() => this.automaticKeyboardNavigation || this.triggered)\r\n            .map(event => new StandardKeyboardEvent(event))\r\n            .filter(e => this.delegate.mightProducePrintableCharacter(e))\r\n            .forEach(e => { e.stopPropagation(); e.preventDefault(); })\r\n            .map(event => event.browserEvent.key)\r\n            .event;\r\n        const onClear = Event.debounce(onChar, () => null, 800);\r\n        const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : ((r || '') + i));\r\n        onInput(this.onInput, this, this.enabledDisposables);\r\n        onClear(this.onClear, this, this.enabledDisposables);\r\n        this.enabled = true;\r\n        this.triggered = false;\r\n    }\r\n    disable() {\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n        this.enabledDisposables.clear();\r\n        this.enabled = false;\r\n        this.triggered = false;\r\n    }\r\n    onClear() {\r\n        var _a;\r\n        const focus = this.list.getFocus();\r\n        if (focus.length > 0 && focus[0] === this.previouslyFocused) {\r\n            // List: re-anounce element on typing end since typed keys will interupt aria label of focused element\r\n            // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\r\n            const ariaLabel = (_a = this.list.options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getAriaLabel(this.list.element(focus[0]));\r\n            if (ariaLabel) {\r\n                alert(ariaLabel);\r\n            }\r\n        }\r\n        this.previouslyFocused = -1;\r\n    }\r\n    onInput(word) {\r\n        if (!word) {\r\n            this.state = TypeLabelControllerState.Idle;\r\n            this.triggered = false;\r\n            return;\r\n        }\r\n        const focus = this.list.getFocus();\r\n        const start = focus.length > 0 ? focus[0] : 0;\r\n        const delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\r\n        this.state = TypeLabelControllerState.Typing;\r\n        for (let i = 0; i < this.list.length; i++) {\r\n            const index = (start + i + delta) % this.list.length;\r\n            const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\r\n            const labelStr = label && label.toString();\r\n            if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\r\n                this.previouslyFocused = start;\r\n                this.list.setFocus([index]);\r\n                this.list.reveal(index);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    dispose() {\r\n        this.disable();\r\n        this.enabledDisposables.dispose();\r\n        this.disposables.dispose();\r\n    }\r\n}\r\nclass DOMFocusController {\r\n    constructor(list, view) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.disposables = new DisposableStore();\r\n        const onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\r\n            .filter(e => !isInputElement(e.target))\r\n            .map(e => new StandardKeyboardEvent(e));\r\n        onKeyDown.filter(e => e.keyCode === 2 /* Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey)\r\n            .on(this.onTab, this, this.disposables);\r\n    }\r\n    onTab(e) {\r\n        if (e.target !== this.view.domNode) {\r\n            return;\r\n        }\r\n        const focus = this.list.getFocus();\r\n        if (focus.length === 0) {\r\n            return;\r\n        }\r\n        const focusedDomElement = this.view.domElement(focus[0]);\r\n        if (!focusedDomElement) {\r\n            return;\r\n        }\r\n        const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\r\n        if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\r\n            return;\r\n        }\r\n        const style = window.getComputedStyle(tabIndexElement);\r\n        if (style.visibility === 'hidden' || style.display === 'none') {\r\n            return;\r\n        }\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        tabIndexElement.focus();\r\n    }\r\n    dispose() {\r\n        this.disposables.dispose();\r\n    }\r\n}\r\nexport function isSelectionSingleChangeEvent(event) {\r\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\r\n}\r\nexport function isSelectionRangeChangeEvent(event) {\r\n    return event.browserEvent.shiftKey;\r\n}\r\nfunction isMouseRightClick(event) {\r\n    return event instanceof MouseEvent && event.button === 2;\r\n}\r\nconst DefaultMultipleSelectionController = {\r\n    isSelectionSingleChangeEvent,\r\n    isSelectionRangeChangeEvent\r\n};\r\nexport class MouseController {\r\n    constructor(list) {\r\n        this.list = list;\r\n        this.disposables = new DisposableStore();\r\n        this._onPointer = new Emitter();\r\n        this.onPointer = this._onPointer.event;\r\n        this.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\r\n        if (this.multipleSelectionSupport) {\r\n            this.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionController;\r\n        }\r\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\r\n        if (this.mouseSupport) {\r\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\r\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\r\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\r\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\r\n            this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\r\n        }\r\n        Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\r\n    }\r\n    isSelectionSingleChangeEvent(event) {\r\n        if (this.multipleSelectionController) {\r\n            return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\r\n        }\r\n        return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\r\n    }\r\n    isSelectionRangeChangeEvent(event) {\r\n        if (this.multipleSelectionController) {\r\n            return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\r\n        }\r\n        return event.browserEvent.shiftKey;\r\n    }\r\n    isSelectionChangeEvent(event) {\r\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\r\n    }\r\n    onMouseDown(e) {\r\n        if (isMonacoEditor(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        if (document.activeElement !== e.browserEvent.target) {\r\n            this.list.domFocus();\r\n        }\r\n    }\r\n    onContextMenu(e) {\r\n        if (isMonacoEditor(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        const focus = typeof e.index === 'undefined' ? [] : [e.index];\r\n        this.list.setFocus(focus, e.browserEvent);\r\n    }\r\n    onViewPointer(e) {\r\n        if (!this.mouseSupport) {\r\n            return;\r\n        }\r\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        let reference = this.list.getFocus()[0];\r\n        const selection = this.list.getSelection();\r\n        reference = reference === undefined ? selection[0] : reference;\r\n        const focus = e.index;\r\n        if (typeof focus === 'undefined') {\r\n            this.list.setFocus([], e.browserEvent);\r\n            this.list.setSelection([], e.browserEvent);\r\n            return;\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\r\n            return this.changeSelection(e, reference);\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\r\n            return this.changeSelection(e, reference);\r\n        }\r\n        this.list.setFocus([focus], e.browserEvent);\r\n        if (!isMouseRightClick(e.browserEvent)) {\r\n            this.list.setSelection([focus], e.browserEvent);\r\n        }\r\n        this._onPointer.fire(e);\r\n    }\r\n    onDoubleClick(e) {\r\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\r\n            return;\r\n        }\r\n        const focus = this.list.getFocus();\r\n        this.list.setSelection(focus, e.browserEvent);\r\n    }\r\n    changeSelection(e, reference) {\r\n        const focus = e.index;\r\n        if (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\r\n            const min = Math.min(reference, focus);\r\n            const max = Math.max(reference, focus);\r\n            const rangeSelection = range(min, max + 1);\r\n            const selection = this.list.getSelection();\r\n            const contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\r\n            if (contiguousRange.length === 0) {\r\n                return;\r\n            }\r\n            const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\r\n            this.list.setSelection(newSelection, e.browserEvent);\r\n        }\r\n        else if (this.isSelectionSingleChangeEvent(e)) {\r\n            const selection = this.list.getSelection();\r\n            const newSelection = selection.filter(i => i !== focus);\r\n            this.list.setFocus([focus]);\r\n            if (selection.length === newSelection.length) {\r\n                this.list.setSelection([...newSelection, focus], e.browserEvent);\r\n            }\r\n            else {\r\n                this.list.setSelection(newSelection, e.browserEvent);\r\n            }\r\n        }\r\n    }\r\n    dispose() {\r\n        this.disposables.dispose();\r\n    }\r\n}\r\nexport class DefaultStyleController {\r\n    constructor(styleElement, selectorSuffix) {\r\n        this.styleElement = styleElement;\r\n        this.selectorSuffix = selectorSuffix;\r\n    }\r\n    style(styles) {\r\n        const suffix = this.selectorSuffix && `.${this.selectorSuffix}`;\r\n        const content = [];\r\n        if (styles.listBackground) {\r\n            if (styles.listBackground.isOpaque()) {\r\n                content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`);\r\n            }\r\n            else if (!platform.isMacintosh) { // subpixel AA doesn't exist in macOS\r\n                console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`);\r\n            }\r\n        }\r\n        if (styles.listFocusBackground) {\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listFocusForeground) {\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\r\n        }\r\n        if (styles.listActiveSelectionBackground) {\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listActiveSelectionForeground) {\r\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\r\n        }\r\n        if (styles.listFocusAndSelectionBackground) {\r\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\r\n        }\r\n        if (styles.listFocusAndSelectionForeground) {\r\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\r\n        }\r\n        if (styles.listInactiveFocusBackground) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listInactiveSelectionBackground) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listInactiveSelectionForeground) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\r\n        }\r\n        if (styles.listHoverBackground) {\r\n            content.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  ${styles.listHoverBackground}; }`);\r\n        }\r\n        if (styles.listHoverForeground) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\r\n        }\r\n        if (styles.listSelectionOutline) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\r\n        }\r\n        if (styles.listFocusOutline) {\r\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\r\n        }\r\n        if (styles.listInactiveFocusOutline) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\r\n        }\r\n        if (styles.listHoverOutline) {\r\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\r\n        }\r\n        if (styles.listDropBackground) {\r\n            content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\r\n        }\r\n        if (styles.listFilterWidgetBackground) {\r\n            content.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`);\r\n        }\r\n        if (styles.listFilterWidgetOutline) {\r\n            content.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`);\r\n        }\r\n        if (styles.listFilterWidgetNoMatchesOutline) {\r\n            content.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`);\r\n        }\r\n        if (styles.listMatchesShadow) {\r\n            content.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`);\r\n        }\r\n        this.styleElement.textContent = content.join('\\n');\r\n    }\r\n}\r\nconst defaultStyles = {\r\n    listFocusBackground: Color.fromHex('#7FB0D0'),\r\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\r\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\r\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\r\n    listHoverBackground: Color.fromHex('#2A2D2E'),\r\n    listDropBackground: Color.fromHex('#383B3D'),\r\n    treeIndentGuidesStroke: Color.fromHex('#a9a9a9')\r\n};\r\nconst DefaultOptions = {\r\n    keyboardSupport: true,\r\n    mouseSupport: true,\r\n    multipleSelectionSupport: true,\r\n    dnd: {\r\n        getDragURI() { return null; },\r\n        onDragStart() { },\r\n        onDragOver() { return false; },\r\n        drop() { }\r\n    }\r\n};\r\n// TODO@Joao: move these utils into a SortedArray class\r\nfunction getContiguousRangeContaining(range, value) {\r\n    const index = range.indexOf(value);\r\n    if (index === -1) {\r\n        return [];\r\n    }\r\n    const result = [];\r\n    let i = index - 1;\r\n    while (i >= 0 && range[i] === value - (index - i)) {\r\n        result.push(range[i--]);\r\n    }\r\n    result.reverse();\r\n    i = index;\r\n    while (i < range.length && range[i] === value + (i - index)) {\r\n        result.push(range[i++]);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Given two sorted collections of numbers, returns the intersection\r\n * between them (OR).\r\n */\r\nfunction disjunction(one, other) {\r\n    const result = [];\r\n    let i = 0, j = 0;\r\n    while (i < one.length || j < other.length) {\r\n        if (i >= one.length) {\r\n            result.push(other[j++]);\r\n        }\r\n        else if (j >= other.length) {\r\n            result.push(one[i++]);\r\n        }\r\n        else if (one[i] === other[j]) {\r\n            result.push(one[i]);\r\n            i++;\r\n            j++;\r\n            continue;\r\n        }\r\n        else if (one[i] < other[j]) {\r\n            result.push(one[i++]);\r\n        }\r\n        else {\r\n            result.push(other[j++]);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Given two sorted collections of numbers, returns the relative\r\n * complement between them (XOR).\r\n */\r\nfunction relativeComplement(one, other) {\r\n    const result = [];\r\n    let i = 0, j = 0;\r\n    while (i < one.length || j < other.length) {\r\n        if (i >= one.length) {\r\n            result.push(other[j++]);\r\n        }\r\n        else if (j >= other.length) {\r\n            result.push(one[i++]);\r\n        }\r\n        else if (one[i] === other[j]) {\r\n            i++;\r\n            j++;\r\n            continue;\r\n        }\r\n        else if (one[i] < other[j]) {\r\n            result.push(one[i++]);\r\n        }\r\n        else {\r\n            j++;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nconst numericSort = (a, b) => a - b;\r\nclass PipelineRenderer {\r\n    constructor(_templateId, renderers) {\r\n        this._templateId = _templateId;\r\n        this.renderers = renderers;\r\n    }\r\n    get templateId() {\r\n        return this._templateId;\r\n    }\r\n    renderTemplate(container) {\r\n        return this.renderers.map(r => r.renderTemplate(container));\r\n    }\r\n    renderElement(element, index, templateData, height) {\r\n        let i = 0;\r\n        for (const renderer of this.renderers) {\r\n            renderer.renderElement(element, index, templateData[i++], height);\r\n        }\r\n    }\r\n    disposeElement(element, index, templateData, height) {\r\n        let i = 0;\r\n        for (const renderer of this.renderers) {\r\n            if (renderer.disposeElement) {\r\n                renderer.disposeElement(element, index, templateData[i], height);\r\n            }\r\n            i += 1;\r\n        }\r\n    }\r\n    disposeTemplate(templateData) {\r\n        let i = 0;\r\n        for (const renderer of this.renderers) {\r\n            renderer.disposeTemplate(templateData[i++]);\r\n        }\r\n    }\r\n}\r\nclass AccessibiltyRenderer {\r\n    constructor(accessibilityProvider) {\r\n        this.accessibilityProvider = accessibilityProvider;\r\n        this.templateId = 'a18n';\r\n    }\r\n    renderTemplate(container) {\r\n        return container;\r\n    }\r\n    renderElement(element, index, container) {\r\n        const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\r\n        if (ariaLabel) {\r\n            container.setAttribute('aria-label', ariaLabel);\r\n        }\r\n        else {\r\n            container.removeAttribute('aria-label');\r\n        }\r\n        const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\r\n        if (typeof ariaLevel === 'number') {\r\n            container.setAttribute('aria-level', `${ariaLevel}`);\r\n        }\r\n        else {\r\n            container.removeAttribute('aria-level');\r\n        }\r\n    }\r\n    disposeTemplate(templateData) {\r\n        // noop\r\n    }\r\n}\r\nclass ListViewDragAndDrop {\r\n    constructor(list, dnd) {\r\n        this.list = list;\r\n        this.dnd = dnd;\r\n    }\r\n    getDragElements(element) {\r\n        const selection = this.list.getSelectedElements();\r\n        const elements = selection.indexOf(element) > -1 ? selection : [element];\r\n        return elements;\r\n    }\r\n    getDragURI(element) {\r\n        return this.dnd.getDragURI(element);\r\n    }\r\n    getDragLabel(elements, originalEvent) {\r\n        if (this.dnd.getDragLabel) {\r\n            return this.dnd.getDragLabel(elements, originalEvent);\r\n        }\r\n        return undefined;\r\n    }\r\n    onDragStart(data, originalEvent) {\r\n        if (this.dnd.onDragStart) {\r\n            this.dnd.onDragStart(data, originalEvent);\r\n        }\r\n    }\r\n    onDragOver(data, targetElement, targetIndex, originalEvent) {\r\n        return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\r\n    }\r\n    onDragEnd(originalEvent) {\r\n        if (this.dnd.onDragEnd) {\r\n            this.dnd.onDragEnd(originalEvent);\r\n        }\r\n    }\r\n    drop(data, targetElement, targetIndex, originalEvent) {\r\n        this.dnd.drop(data, targetElement, targetIndex, originalEvent);\r\n    }\r\n}\r\nexport class List {\r\n    constructor(user, container, virtualDelegate, renderers, _options = DefaultOptions) {\r\n        var _a;\r\n        this.user = user;\r\n        this._options = _options;\r\n        this.eventBufferer = new EventBufferer();\r\n        this._ariaLabel = '';\r\n        this.disposables = new DisposableStore();\r\n        this.didJustPressContextMenuKey = false;\r\n        this._onDidDispose = new Emitter();\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_a = this._options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getWidgetRole() : 'list';\r\n        this.selection = new SelectionTrait(role !== 'listbox');\r\n        this.focus = new Trait('focused');\r\n        mixin(_options, defaultStyles, false);\r\n        const baseRenderers = [this.focus.renderer, this.selection.renderer];\r\n        this.accessibilityProvider = _options.accessibilityProvider;\r\n        if (this.accessibilityProvider) {\r\n            baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\r\n            if (this.accessibilityProvider.onDidChangeActiveDescendant) {\r\n                this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\r\n            }\r\n        }\r\n        renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\r\n        const viewOptions = Object.assign(Object.assign({}, _options), { dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd) });\r\n        this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\r\n        this.view.domNode.setAttribute('role', role);\r\n        if (_options.styleController) {\r\n            this.styleController = _options.styleController(this.view.domId);\r\n        }\r\n        else {\r\n            const styleElement = createStyleSheet(this.view.domNode);\r\n            this.styleController = new DefaultStyleController(styleElement, this.view.domId);\r\n        }\r\n        this.spliceable = new CombinedSpliceable([\r\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\r\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\r\n            this.view\r\n        ]);\r\n        this.disposables.add(this.focus);\r\n        this.disposables.add(this.selection);\r\n        this.disposables.add(this.view);\r\n        this.disposables.add(this._onDidDispose);\r\n        this.onDidFocus = Event.map(domEvent(this.view.domNode, 'focus', true), () => null);\r\n        this.onDidBlur = Event.map(domEvent(this.view.domNode, 'blur', true), () => null);\r\n        this.disposables.add(new DOMFocusController(this, this.view));\r\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\r\n            const controller = new KeyboardController(this, this.view, _options);\r\n            this.disposables.add(controller);\r\n        }\r\n        if (_options.keyboardNavigationLabelProvider) {\r\n            const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\r\n            this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\r\n            this.disposables.add(this.typeLabelController);\r\n        }\r\n        this.mouseController = this.createMouseController(_options);\r\n        this.disposables.add(this.mouseController);\r\n        this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\r\n        this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\r\n        if (this.accessibilityProvider) {\r\n            this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\r\n        }\r\n        if (_options.multipleSelectionSupport) {\r\n            this.view.domNode.setAttribute('aria-multiselectable', 'true');\r\n        }\r\n    }\r\n    get onDidChangeFocus() {\r\n        return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e));\r\n    }\r\n    get onDidChangeSelection() {\r\n        return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e));\r\n    }\r\n    get domId() { return this.view.domId; }\r\n    get onMouseClick() { return this.view.onMouseClick; }\r\n    get onMouseDblClick() { return this.view.onMouseDblClick; }\r\n    get onMouseMiddleClick() { return this.view.onMouseMiddleClick; }\r\n    get onPointer() { return this.mouseController.onPointer; }\r\n    get onMouseDown() { return this.view.onMouseDown; }\r\n    get onTouchStart() { return this.view.onTouchStart; }\r\n    get onTap() { return this.view.onTap; }\r\n    get onContextMenu() {\r\n        const fromKeydown = Event.chain(domEvent(this.view.domNode, 'keydown'))\r\n            .map(e => new StandardKeyboardEvent(e))\r\n            .filter(e => this.didJustPressContextMenuKey = e.keyCode === 58 /* ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* F10 */))\r\n            .filter(e => { e.preventDefault(); e.stopPropagation(); return false; })\r\n            .event;\r\n        const fromKeyup = Event.chain(domEvent(this.view.domNode, 'keyup'))\r\n            .filter(() => {\r\n            const didJustPressContextMenuKey = this.didJustPressContextMenuKey;\r\n            this.didJustPressContextMenuKey = false;\r\n            return didJustPressContextMenuKey;\r\n        })\r\n            .filter(() => this.getFocus().length > 0 && !!this.view.domElement(this.getFocus()[0]))\r\n            .map(browserEvent => {\r\n            const index = this.getFocus()[0];\r\n            const element = this.view.element(index);\r\n            const anchor = this.view.domElement(index);\r\n            return { index, element, anchor, browserEvent };\r\n        })\r\n            .event;\r\n        const fromMouse = Event.chain(this.view.onContextMenu)\r\n            .filter(() => !this.didJustPressContextMenuKey)\r\n            .map(({ element, index, browserEvent }) => ({ element, index, anchor: { x: browserEvent.clientX + 1, y: browserEvent.clientY }, browserEvent }))\r\n            .event;\r\n        return Event.any(fromKeydown, fromKeyup, fromMouse);\r\n    }\r\n    get onKeyDown() { return domEvent(this.view.domNode, 'keydown'); }\r\n    createMouseController(options) {\r\n        return new MouseController(this);\r\n    }\r\n    updateOptions(optionsUpdate = {}) {\r\n        this._options = Object.assign(Object.assign({}, this._options), optionsUpdate);\r\n        if (this.typeLabelController) {\r\n            this.typeLabelController.updateOptions(this._options);\r\n        }\r\n        this.view.updateOptions(optionsUpdate);\r\n    }\r\n    get options() {\r\n        return this._options;\r\n    }\r\n    splice(start, deleteCount, elements = []) {\r\n        if (start < 0 || start > this.view.length) {\r\n            throw new ListError(this.user, `Invalid start index: ${start}`);\r\n        }\r\n        if (deleteCount < 0) {\r\n            throw new ListError(this.user, `Invalid delete count: ${deleteCount}`);\r\n        }\r\n        if (deleteCount === 0 && elements.length === 0) {\r\n            return;\r\n        }\r\n        this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\r\n    }\r\n    rerender() {\r\n        this.view.rerender();\r\n    }\r\n    element(index) {\r\n        return this.view.element(index);\r\n    }\r\n    get length() {\r\n        return this.view.length;\r\n    }\r\n    get contentHeight() {\r\n        return this.view.contentHeight;\r\n    }\r\n    get scrollTop() {\r\n        return this.view.getScrollTop();\r\n    }\r\n    set scrollTop(scrollTop) {\r\n        this.view.setScrollTop(scrollTop);\r\n    }\r\n    get ariaLabel() {\r\n        return this._ariaLabel;\r\n    }\r\n    set ariaLabel(value) {\r\n        this._ariaLabel = value;\r\n        this.view.domNode.setAttribute('aria-label', value);\r\n    }\r\n    domFocus() {\r\n        this.view.domNode.focus();\r\n    }\r\n    layout(height, width) {\r\n        this.view.layout(height, width);\r\n    }\r\n    setSelection(indexes, browserEvent) {\r\n        for (const index of indexes) {\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, `Invalid index ${index}`);\r\n            }\r\n        }\r\n        this.selection.set(indexes, browserEvent);\r\n    }\r\n    getSelection() {\r\n        return this.selection.get();\r\n    }\r\n    getSelectedElements() {\r\n        return this.getSelection().map(i => this.view.element(i));\r\n    }\r\n    setFocus(indexes, browserEvent) {\r\n        for (const index of indexes) {\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, `Invalid index ${index}`);\r\n            }\r\n        }\r\n        this.focus.set(indexes, browserEvent);\r\n    }\r\n    focusNext(n = 1, loop = false, browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        const focus = this.focus.get();\r\n        const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    }\r\n    focusPrevious(n = 1, loop = false, browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        const focus = this.focus.get();\r\n        const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    }\r\n    focusNextPage(browserEvent, filter) {\r\n        let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\r\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\r\n        const lastPageElement = this.view.element(lastPageIndex);\r\n        const currentlyFocusedElement = this.getFocusedElements()[0];\r\n        if (currentlyFocusedElement !== lastPageElement) {\r\n            const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\r\n            if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\r\n                this.setFocus([lastGoodPageIndex], browserEvent);\r\n            }\r\n            else {\r\n                this.setFocus([lastPageIndex], browserEvent);\r\n            }\r\n        }\r\n        else {\r\n            const previousScrollTop = this.view.getScrollTop();\r\n            this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\r\n            if (this.view.getScrollTop() !== previousScrollTop) {\r\n                this.setFocus([]);\r\n                // Let the scroll event listener run\r\n                setTimeout(() => this.focusNextPage(browserEvent, filter), 0);\r\n            }\r\n        }\r\n    }\r\n    focusPreviousPage(browserEvent, filter) {\r\n        let firstPageIndex;\r\n        const scrollTop = this.view.getScrollTop();\r\n        if (scrollTop === 0) {\r\n            firstPageIndex = this.view.indexAt(scrollTop);\r\n        }\r\n        else {\r\n            firstPageIndex = this.view.indexAfter(scrollTop - 1);\r\n        }\r\n        const firstPageElement = this.view.element(firstPageIndex);\r\n        const currentlyFocusedElement = this.getFocusedElements()[0];\r\n        if (currentlyFocusedElement !== firstPageElement) {\r\n            const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\r\n            if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\r\n                this.setFocus([firstGoodPageIndex], browserEvent);\r\n            }\r\n            else {\r\n                this.setFocus([firstPageIndex], browserEvent);\r\n            }\r\n        }\r\n        else {\r\n            const previousScrollTop = scrollTop;\r\n            this.view.setScrollTop(scrollTop - this.view.renderHeight);\r\n            if (this.view.getScrollTop() !== previousScrollTop) {\r\n                this.setFocus([]);\r\n                // Let the scroll event listener run\r\n                setTimeout(() => this.focusPreviousPage(browserEvent, filter), 0);\r\n            }\r\n        }\r\n    }\r\n    focusLast(browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        const index = this.findPreviousIndex(this.length - 1, false, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    }\r\n    focusFirst(browserEvent, filter) {\r\n        this.focusNth(0, browserEvent, filter);\r\n    }\r\n    focusNth(n, browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        const index = this.findNextIndex(n, false, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    }\r\n    findNextIndex(index, loop = false, filter) {\r\n        for (let i = 0; i < this.length; i++) {\r\n            if (index >= this.length && !loop) {\r\n                return -1;\r\n            }\r\n            index = index % this.length;\r\n            if (!filter || filter(this.element(index))) {\r\n                return index;\r\n            }\r\n            index++;\r\n        }\r\n        return -1;\r\n    }\r\n    findPreviousIndex(index, loop = false, filter) {\r\n        for (let i = 0; i < this.length; i++) {\r\n            if (index < 0 && !loop) {\r\n                return -1;\r\n            }\r\n            index = (this.length + (index % this.length)) % this.length;\r\n            if (!filter || filter(this.element(index))) {\r\n                return index;\r\n            }\r\n            index--;\r\n        }\r\n        return -1;\r\n    }\r\n    getFocus() {\r\n        return this.focus.get();\r\n    }\r\n    getFocusedElements() {\r\n        return this.getFocus().map(i => this.view.element(i));\r\n    }\r\n    reveal(index, relativeTop) {\r\n        if (index < 0 || index >= this.length) {\r\n            throw new ListError(this.user, `Invalid index ${index}`);\r\n        }\r\n        const scrollTop = this.view.getScrollTop();\r\n        const elementTop = this.view.elementTop(index);\r\n        const elementHeight = this.view.elementHeight(index);\r\n        if (isNumber(relativeTop)) {\r\n            // y = mx + b\r\n            const m = elementHeight - this.view.renderHeight;\r\n            this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\r\n        }\r\n        else {\r\n            const viewItemBottom = elementTop + elementHeight;\r\n            const wrapperBottom = scrollTop + this.view.renderHeight;\r\n            if (elementTop < scrollTop && viewItemBottom >= wrapperBottom) {\r\n                // The element is already overflowing the viewport, no-op\r\n            }\r\n            else if (elementTop < scrollTop) {\r\n                this.view.setScrollTop(elementTop);\r\n            }\r\n            else if (viewItemBottom >= wrapperBottom) {\r\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Returns the relative position of an element rendered in the list.\r\n     * Returns `null` if the element isn't *entirely* in the visible viewport.\r\n     */\r\n    getRelativeTop(index) {\r\n        if (index < 0 || index >= this.length) {\r\n            throw new ListError(this.user, `Invalid index ${index}`);\r\n        }\r\n        const scrollTop = this.view.getScrollTop();\r\n        const elementTop = this.view.elementTop(index);\r\n        const elementHeight = this.view.elementHeight(index);\r\n        if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\r\n            return null;\r\n        }\r\n        // y = mx + b\r\n        const m = elementHeight - this.view.renderHeight;\r\n        return Math.abs((scrollTop - elementTop) / m);\r\n    }\r\n    getHTMLElement() {\r\n        return this.view.domNode;\r\n    }\r\n    style(styles) {\r\n        this.styleController.style(styles);\r\n    }\r\n    toListEvent({ indexes, browserEvent }) {\r\n        return { indexes, elements: indexes.map(i => this.view.element(i)), browserEvent };\r\n    }\r\n    _onFocusChange() {\r\n        const focus = this.focus.get();\r\n        this.view.domNode.classList.toggle('element-focused', focus.length > 0);\r\n        this.onDidChangeActiveDescendant();\r\n    }\r\n    onDidChangeActiveDescendant() {\r\n        var _a;\r\n        const focus = this.focus.get();\r\n        if (focus.length > 0) {\r\n            let id;\r\n            if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\r\n                id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\r\n            }\r\n            this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\r\n        }\r\n        else {\r\n            this.view.domNode.removeAttribute('aria-activedescendant');\r\n        }\r\n    }\r\n    _onSelectionChange() {\r\n        const selection = this.selection.get();\r\n        this.view.domNode.classList.toggle('selection-none', selection.length === 0);\r\n        this.view.domNode.classList.toggle('selection-single', selection.length === 1);\r\n        this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\r\n    }\r\n    dispose() {\r\n        this._onDidDispose.fire();\r\n        this.disposables.dispose();\r\n        this._onDidDispose.dispose();\r\n    }\r\n}\r\n__decorate([\r\n    memoize\r\n], List.prototype, \"onDidChangeFocus\", null);\r\n__decorate([\r\n    memoize\r\n], List.prototype, \"onDidChangeSelection\", null);\r\n__decorate([\r\n    memoize\r\n], List.prototype, \"onContextMenu\", null);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}