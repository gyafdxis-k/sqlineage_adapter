{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nexport class HoverOperation {\n  constructor(computer, success, error, progress, hoverTime) {\n    this._computer = computer;\n    this._state = 0 /* IDLE */;\n    this._hoverTime = hoverTime;\n    this._firstWaitScheduler = new RunOnceScheduler(() => this._triggerAsyncComputation(), 0);\n    this._secondWaitScheduler = new RunOnceScheduler(() => this._triggerSyncComputation(), 0);\n    this._loadingMessageScheduler = new RunOnceScheduler(() => this._showLoadingMessage(), 0);\n    this._asyncComputationPromise = null;\n    this._asyncComputationPromiseDone = false;\n    this._completeCallback = success;\n    this._errorCallback = error;\n    this._progressCallback = progress;\n  }\n  setHoverTime(hoverTime) {\n    this._hoverTime = hoverTime;\n  }\n  _firstWaitTime() {\n    return this._hoverTime / 2;\n  }\n  _secondWaitTime() {\n    return this._hoverTime / 2;\n  }\n  _loadingMessageTime() {\n    return 3 * this._hoverTime;\n  }\n  _triggerAsyncComputation() {\n    this._state = 2 /* SECOND_WAIT */;\n    this._secondWaitScheduler.schedule(this._secondWaitTime());\n    if (this._computer.computeAsync) {\n      this._asyncComputationPromiseDone = false;\n      this._asyncComputationPromise = createCancelablePromise(token => this._computer.computeAsync(token));\n      this._asyncComputationPromise.then(asyncResult => {\n        this._asyncComputationPromiseDone = true;\n        this._withAsyncResult(asyncResult);\n      }, e => this._onError(e));\n    } else {\n      this._asyncComputationPromiseDone = true;\n    }\n  }\n  _triggerSyncComputation() {\n    if (this._computer.computeSync) {\n      this._computer.onResult(this._computer.computeSync(), true);\n    }\n    if (this._asyncComputationPromiseDone) {\n      this._state = 0 /* IDLE */;\n      this._onComplete(this._computer.getResult());\n    } else {\n      this._state = 3 /* WAITING_FOR_ASYNC_COMPUTATION */;\n      this._onProgress(this._computer.getResult());\n    }\n  }\n  _showLoadingMessage() {\n    if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\n      this._onProgress(this._computer.getResultWithLoadingMessage());\n    }\n  }\n  _withAsyncResult(asyncResult) {\n    if (asyncResult) {\n      this._computer.onResult(asyncResult, false);\n    }\n    if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\n      this._state = 0 /* IDLE */;\n      this._onComplete(this._computer.getResult());\n    }\n  }\n  _onComplete(value) {\n    this._completeCallback(value);\n  }\n  _onError(error) {\n    if (this._errorCallback) {\n      this._errorCallback(error);\n    } else {\n      onUnexpectedError(error);\n    }\n  }\n  _onProgress(value) {\n    this._progressCallback(value);\n  }\n  start(mode) {\n    if (mode === 0 /* Delayed */) {\n      if (this._state === 0 /* IDLE */) {\n        this._state = 1 /* FIRST_WAIT */;\n        this._firstWaitScheduler.schedule(this._firstWaitTime());\n        this._loadingMessageScheduler.schedule(this._loadingMessageTime());\n      }\n    } else {\n      switch (this._state) {\n        case 0 /* IDLE */:\n          this._triggerAsyncComputation();\n          this._secondWaitScheduler.cancel();\n          this._triggerSyncComputation();\n          break;\n        case 2 /* SECOND_WAIT */:\n          this._secondWaitScheduler.cancel();\n          this._triggerSyncComputation();\n          break;\n      }\n    }\n  }\n  cancel() {\n    this._loadingMessageScheduler.cancel();\n    if (this._state === 1 /* FIRST_WAIT */) {\n      this._firstWaitScheduler.cancel();\n    }\n    if (this._state === 2 /* SECOND_WAIT */) {\n      this._secondWaitScheduler.cancel();\n      if (this._asyncComputationPromise) {\n        this._asyncComputationPromise.cancel();\n        this._asyncComputationPromise = null;\n      }\n    }\n    if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\n      if (this._asyncComputationPromise) {\n        this._asyncComputationPromise.cancel();\n        this._asyncComputationPromise = null;\n      }\n    }\n    this._state = 0 /* IDLE */;\n  }\n}","map":{"version":3,"names":["RunOnceScheduler","createCancelablePromise","onUnexpectedError","HoverOperation","constructor","computer","success","error","progress","hoverTime","_computer","_state","_hoverTime","_firstWaitScheduler","_triggerAsyncComputation","_secondWaitScheduler","_triggerSyncComputation","_loadingMessageScheduler","_showLoadingMessage","_asyncComputationPromise","_asyncComputationPromiseDone","_completeCallback","_errorCallback","_progressCallback","setHoverTime","_firstWaitTime","_secondWaitTime","_loadingMessageTime","schedule","computeAsync","token","then","asyncResult","_withAsyncResult","e","_onError","computeSync","onResult","_onComplete","getResult","_onProgress","getResultWithLoadingMessage","value","start","mode","cancel"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverOperation.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nexport class HoverOperation {\r\n    constructor(computer, success, error, progress, hoverTime) {\r\n        this._computer = computer;\r\n        this._state = 0 /* IDLE */;\r\n        this._hoverTime = hoverTime;\r\n        this._firstWaitScheduler = new RunOnceScheduler(() => this._triggerAsyncComputation(), 0);\r\n        this._secondWaitScheduler = new RunOnceScheduler(() => this._triggerSyncComputation(), 0);\r\n        this._loadingMessageScheduler = new RunOnceScheduler(() => this._showLoadingMessage(), 0);\r\n        this._asyncComputationPromise = null;\r\n        this._asyncComputationPromiseDone = false;\r\n        this._completeCallback = success;\r\n        this._errorCallback = error;\r\n        this._progressCallback = progress;\r\n    }\r\n    setHoverTime(hoverTime) {\r\n        this._hoverTime = hoverTime;\r\n    }\r\n    _firstWaitTime() {\r\n        return this._hoverTime / 2;\r\n    }\r\n    _secondWaitTime() {\r\n        return this._hoverTime / 2;\r\n    }\r\n    _loadingMessageTime() {\r\n        return 3 * this._hoverTime;\r\n    }\r\n    _triggerAsyncComputation() {\r\n        this._state = 2 /* SECOND_WAIT */;\r\n        this._secondWaitScheduler.schedule(this._secondWaitTime());\r\n        if (this._computer.computeAsync) {\r\n            this._asyncComputationPromiseDone = false;\r\n            this._asyncComputationPromise = createCancelablePromise(token => this._computer.computeAsync(token));\r\n            this._asyncComputationPromise.then((asyncResult) => {\r\n                this._asyncComputationPromiseDone = true;\r\n                this._withAsyncResult(asyncResult);\r\n            }, (e) => this._onError(e));\r\n        }\r\n        else {\r\n            this._asyncComputationPromiseDone = true;\r\n        }\r\n    }\r\n    _triggerSyncComputation() {\r\n        if (this._computer.computeSync) {\r\n            this._computer.onResult(this._computer.computeSync(), true);\r\n        }\r\n        if (this._asyncComputationPromiseDone) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n        else {\r\n            this._state = 3 /* WAITING_FOR_ASYNC_COMPUTATION */;\r\n            this._onProgress(this._computer.getResult());\r\n        }\r\n    }\r\n    _showLoadingMessage() {\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._onProgress(this._computer.getResultWithLoadingMessage());\r\n        }\r\n    }\r\n    _withAsyncResult(asyncResult) {\r\n        if (asyncResult) {\r\n            this._computer.onResult(asyncResult, false);\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n    }\r\n    _onComplete(value) {\r\n        this._completeCallback(value);\r\n    }\r\n    _onError(error) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback(error);\r\n        }\r\n        else {\r\n            onUnexpectedError(error);\r\n        }\r\n    }\r\n    _onProgress(value) {\r\n        this._progressCallback(value);\r\n    }\r\n    start(mode) {\r\n        if (mode === 0 /* Delayed */) {\r\n            if (this._state === 0 /* IDLE */) {\r\n                this._state = 1 /* FIRST_WAIT */;\r\n                this._firstWaitScheduler.schedule(this._firstWaitTime());\r\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime());\r\n            }\r\n        }\r\n        else {\r\n            switch (this._state) {\r\n                case 0 /* IDLE */:\r\n                    this._triggerAsyncComputation();\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n                case 2 /* SECOND_WAIT */:\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    cancel() {\r\n        this._loadingMessageScheduler.cancel();\r\n        if (this._state === 1 /* FIRST_WAIT */) {\r\n            this._firstWaitScheduler.cancel();\r\n        }\r\n        if (this._state === 2 /* SECOND_WAIT */) {\r\n            this._secondWaitScheduler.cancel();\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        this._state = 0 /* IDLE */;\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}