{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport './media/suggest.css';\nimport '../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport '../symbolIcons/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../nls.js';\nimport * as strings from '../../../base/common/strings.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { Context as SuggestContext } from './suggest.js';\nimport { attachListStyler } from '../../../platform/theme/common/styler.js';\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { registerColor, editorWidgetBackground, listFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from '../../../platform/theme/common/colorRegistry.js';\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\nimport { TimeoutTimer, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { SuggestDetailsWidget, canExpandCompletionItem, SuggestDetailsOverlay } from './suggestWidgetDetails.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\nimport { ResizableHTMLElement } from './resizable.js';\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\nimport { clamp } from '../../../base/common/numbers.js';\n/**\r\n * Suggest widget colors\r\n */\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', {\n  dark: editorWidgetBackground,\n  light: editorWidgetBackground,\n  hc: editorWidgetBackground\n}, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', {\n  dark: editorWidgetBorder,\n  light: editorWidgetBorder,\n  hc: editorWidgetBorder\n}, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', {\n  dark: editorForeground,\n  light: editorForeground,\n  hc: editorForeground\n}, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', {\n  dark: listFocusBackground,\n  light: listFocusBackground,\n  hc: listFocusBackground\n}, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', {\n  dark: listHighlightForeground,\n  light: listHighlightForeground,\n  hc: listHighlightForeground\n}, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nclass PersistedWidgetSize {\n  constructor(_service, editor) {\n    this._service = _service;\n    this._key = \"suggestWidget.size/\".concat(editor.getEditorType(), \"/\").concat(editor instanceof EmbeddedCodeEditorWidget);\n  }\n  restore() {\n    var _a;\n    const raw = (_a = this._service.get(this._key, 0 /* GLOBAL */)) !== null && _a !== void 0 ? _a : '';\n    try {\n      const obj = JSON.parse(raw);\n      if (dom.Dimension.is(obj)) {\n        return dom.Dimension.lift(obj);\n      }\n    } catch (_b) {\n      // ignore\n    }\n    return undefined;\n  }\n  store(size) {\n    this._service.store(this._key, JSON.stringify(size), 0 /* GLOBAL */, 1 /* MACHINE */);\n  }\n\n  reset() {\n    this._service.remove(this._key, 0 /* GLOBAL */);\n  }\n}\n\nlet SuggestWidget = class SuggestWidget {\n  constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n    this.editor = editor;\n    this._storageService = _storageService;\n    this._state = 0 /* Hidden */;\n    this._isAuto = false;\n    this._ignoreFocusEvents = false;\n    this._explainMode = false;\n    this._showTimeout = new TimeoutTimer();\n    this._disposables = new DisposableStore();\n    this._onDidSelect = new Emitter();\n    this._onDidFocus = new Emitter();\n    this._onDidHide = new Emitter();\n    this._onDidShow = new Emitter();\n    this.onDidSelect = this._onDidSelect.event;\n    this.onDidFocus = this._onDidFocus.event;\n    this.onDidHide = this._onDidHide.event;\n    this.onDidShow = this._onDidShow.event;\n    this._onDetailsKeydown = new Emitter();\n    this.onDetailsKeyDown = this._onDetailsKeydown.event;\n    this.element = new ResizableHTMLElement();\n    this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n    this._contentWidget = new SuggestContentWidget(this, editor);\n    this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n    class ResizeState {\n      constructor(persistedSize, currentSize) {\n        let persistHeight = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        let persistWidth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n        this.persistedSize = persistedSize;\n        this.currentSize = currentSize;\n        this.persistHeight = persistHeight;\n        this.persistWidth = persistWidth;\n      }\n    }\n    let state;\n    this._disposables.add(this.element.onDidWillResize(() => {\n      this._contentWidget.lockPreference();\n      state = new ResizeState(this._persistedSize.restore(), this.element.size);\n    }));\n    this._disposables.add(this.element.onDidResize(e => {\n      var _a, _b, _c, _d;\n      this._resize(e.dimension.width, e.dimension.height);\n      if (state) {\n        state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n        state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n      }\n      if (!e.done) {\n        return;\n      }\n      if (state) {\n        // only store width or height value that have changed and also\n        // only store changes that are above a certain threshold\n        const {\n          itemHeight,\n          defaultSize\n        } = this.getLayoutInfo();\n        const threshold = Math.round(itemHeight / 2);\n        let {\n          width,\n          height\n        } = this.element.size;\n        if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n          height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n        }\n        if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n          width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n        }\n        this._persistedSize.store(new dom.Dimension(width, height));\n      }\n      // reset working state\n      this._contentWidget.unlockPreference();\n      state = undefined;\n    }));\n    this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n    this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n    const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n    details.onDidClose(this.toggleDetails, this, this._disposables);\n    this._details = new SuggestDetailsOverlay(details, this.editor);\n    const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(101 /* suggest */).showIcons);\n    applyIconStyle();\n    const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n    this._disposables.add(renderer);\n    this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n    this._list = new List('SuggestWidget', this._listElement, {\n      getHeight: _element => this.getLayoutInfo().itemHeight,\n      getTemplateId: _element => 'suggestion'\n    }, [renderer], {\n      useShadows: false,\n      mouseSupport: false,\n      accessibilityProvider: {\n        getRole: () => 'option',\n        getAriaLabel: item => {\n          const textLabel = typeof item.completion.label === 'string' ? item.completion.label : item.completion.label.name;\n          if (item.isResolved && this._isDetailsVisible()) {\n            const {\n              documentation,\n              detail\n            } = item.completion;\n            const docs = strings.format('{0}{1}', detail || '', documentation ? typeof documentation === 'string' ? documentation : documentation.value : '');\n            return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", textLabel, docs);\n          } else {\n            return textLabel;\n          }\n        },\n        getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n        getWidgetRole: () => 'listbox'\n      }\n    });\n    this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\n    const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(101 /* suggest */).showStatusBar);\n    applyStatusBarStyle();\n    this._disposables.add(attachListStyler(this._list, _themeService, {\n      listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n      listInactiveFocusOutline: activeContrastBorder\n    }));\n    this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n    this._onThemeChange(_themeService.getColorTheme());\n    this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n    this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n    this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n    this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n    this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n    this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(101 /* suggest */)) {\n        applyStatusBarStyle();\n        applyIconStyle();\n      }\n    }));\n    this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n    this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n    this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n    this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n      this._onDetailsKeydown.fire(e);\n    }));\n    this._disposables.add(this.editor.onMouseDown(e => this._onEditorMouseDown(e)));\n  }\n  dispose() {\n    var _a;\n    this._details.widget.dispose();\n    this._details.dispose();\n    this._list.dispose();\n    this._status.dispose();\n    this._disposables.dispose();\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n    this._showTimeout.dispose();\n    this._contentWidget.dispose();\n    this.element.dispose();\n  }\n  _onEditorMouseDown(mouseEvent) {\n    if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n      // Clicking inside details\n      this._details.widget.domNode.focus();\n    } else {\n      // Clicking outside details and inside suggest\n      if (this.element.domNode.contains(mouseEvent.target.element)) {\n        this.editor.focus();\n      }\n    }\n  }\n  _onCursorSelectionChanged() {\n    if (this._state !== 0 /* Hidden */) {\n      this._contentWidget.layout();\n    }\n  }\n  _onListMouseDownOrTap(e) {\n    if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n      return;\n    }\n    // prevent stealing browser focus from the editor\n    e.browserEvent.preventDefault();\n    e.browserEvent.stopPropagation();\n    this._select(e.element, e.index);\n  }\n  _onListSelection(e) {\n    if (e.elements.length) {\n      this._select(e.elements[0], e.indexes[0]);\n    }\n  }\n  _select(item, index) {\n    const completionModel = this._completionModel;\n    if (completionModel) {\n      this._onDidSelect.fire({\n        item,\n        index,\n        model: completionModel\n      });\n      this.editor.focus();\n    }\n  }\n  _onThemeChange(theme) {\n    const backgroundColor = theme.getColor(editorSuggestWidgetBackground);\n    if (backgroundColor) {\n      this.element.domNode.style.backgroundColor = backgroundColor.toString();\n      this._messageElement.style.backgroundColor = backgroundColor.toString();\n      this._details.widget.domNode.style.backgroundColor = backgroundColor.toString();\n    }\n    const borderColor = theme.getColor(editorSuggestWidgetBorder);\n    if (borderColor) {\n      this.element.domNode.style.borderColor = borderColor.toString();\n      this._messageElement.style.borderColor = borderColor.toString();\n      this._status.element.style.borderTopColor = borderColor.toString();\n      this._details.widget.domNode.style.borderColor = borderColor.toString();\n      this._detailsBorderColor = borderColor.toString();\n    }\n    const focusBorderColor = theme.getColor(focusBorder);\n    if (focusBorderColor) {\n      this._detailsFocusBorderColor = focusBorderColor.toString();\n    }\n    this._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\n  }\n  _onListFocus(e) {\n    var _a;\n    if (this._ignoreFocusEvents) {\n      return;\n    }\n    if (!e.elements.length) {\n      if (this._currentSuggestionDetails) {\n        this._currentSuggestionDetails.cancel();\n        this._currentSuggestionDetails = undefined;\n        this._focusedItem = undefined;\n      }\n      this.editor.setAriaOptions({\n        activeDescendant: undefined\n      });\n      return;\n    }\n    if (!this._completionModel) {\n      return;\n    }\n    const item = e.elements[0];\n    const index = e.indexes[0];\n    if (item !== this._focusedItem) {\n      (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n      this._currentSuggestionDetails = undefined;\n      this._focusedItem = item;\n      this._list.reveal(index);\n      this._currentSuggestionDetails = createCancelablePromise(token => __awaiter(this, void 0, void 0, function* () {\n        const loading = disposableTimeout(() => {\n          if (this._isDetailsVisible()) {\n            this.showDetails(true);\n          }\n        }, 250);\n        token.onCancellationRequested(() => loading.dispose());\n        const result = yield item.resolve(token);\n        loading.dispose();\n        return result;\n      }));\n      this._currentSuggestionDetails.then(() => {\n        if (index >= this._list.length || item !== this._list.element(index)) {\n          return;\n        }\n        // item can have extra information, so re-render\n        this._ignoreFocusEvents = true;\n        this._list.splice(index, 1, [item]);\n        this._list.setFocus([index]);\n        this._ignoreFocusEvents = false;\n        if (this._isDetailsVisible()) {\n          this.showDetails(false);\n        } else {\n          this.element.domNode.classList.remove('docs-side');\n        }\n        this.editor.setAriaOptions({\n          activeDescendant: getAriaId(index)\n        });\n      }).catch(onUnexpectedError);\n    }\n    // emit an event\n    this._onDidFocus.fire({\n      item,\n      index,\n      model: this._completionModel\n    });\n  }\n  _setState(state) {\n    if (this._state === state) {\n      return;\n    }\n    this._state = state;\n    this.element.domNode.classList.toggle('frozen', state === 4 /* Frozen */);\n    this.element.domNode.classList.remove('message');\n    switch (state) {\n      case 0 /* Hidden */:\n        dom.hide(this._messageElement, this._listElement, this._status.element);\n        this._details.hide(true);\n        this._status.hide();\n        this._contentWidget.hide();\n        this._ctxSuggestWidgetVisible.reset();\n        this._ctxSuggestWidgetMultipleSuggestions.reset();\n        this.element.domNode.classList.remove('visible');\n        this._list.splice(0, this._list.length);\n        this._focusedItem = undefined;\n        this._cappedHeight = undefined;\n        this._explainMode = false;\n        break;\n      case 1 /* Loading */:\n        this.element.domNode.classList.add('message');\n        this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n        dom.hide(this._listElement, this._status.element);\n        dom.show(this._messageElement);\n        this._details.hide();\n        this._show();\n        this._focusedItem = undefined;\n        break;\n      case 2 /* Empty */:\n        this.element.domNode.classList.add('message');\n        this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n        dom.hide(this._listElement, this._status.element);\n        dom.show(this._messageElement);\n        this._details.hide();\n        this._show();\n        this._focusedItem = undefined;\n        break;\n      case 3 /* Open */:\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n        this._show();\n        break;\n      case 4 /* Frozen */:\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n        this._show();\n        break;\n      case 5 /* Details */:\n        dom.hide(this._messageElement);\n        dom.show(this._listElement, this._status.element);\n        this._details.show();\n        this._show();\n        break;\n    }\n  }\n  _show() {\n    this._status.show();\n    this._contentWidget.show();\n    this._layout(this._persistedSize.restore());\n    this._ctxSuggestWidgetVisible.set(true);\n    this._showTimeout.cancelAndSet(() => {\n      this.element.domNode.classList.add('visible');\n      this._onDidShow.fire(this);\n    }, 100);\n  }\n  showTriggered(auto, delay) {\n    if (this._state !== 0 /* Hidden */) {\n      return;\n    }\n    this._contentWidget.setPosition(this.editor.getPosition());\n    this._isAuto = !!auto;\n    if (!this._isAuto) {\n      this._loadingTimeout = disposableTimeout(() => this._setState(1 /* Loading */), delay);\n    }\n  }\n  showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\n    var _a, _b;\n    this._contentWidget.setPosition(this.editor.getPosition());\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n    (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n    this._currentSuggestionDetails = undefined;\n    if (this._completionModel !== completionModel) {\n      this._completionModel = completionModel;\n    }\n    if (isFrozen && this._state !== 2 /* Empty */ && this._state !== 0 /* Hidden */) {\n      this._setState(4 /* Frozen */);\n      return;\n    }\n    const visibleCount = this._completionModel.items.length;\n    const isEmpty = visibleCount === 0;\n    this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n    if (isEmpty) {\n      this._setState(isAuto ? 0 /* Hidden */ : 2 /* Empty */);\n      this._completionModel = undefined;\n      return;\n    }\n    this._focusedItem = undefined;\n    this._list.splice(0, this._list.length, this._completionModel.items);\n    this._setState(isFrozen ? 4 /* Frozen */ : 3 /* Open */);\n    this._list.reveal(selectionIndex, 0);\n    this._list.setFocus([selectionIndex]);\n    this._layout(this.element.size);\n    // Reset focus border\n    if (this._detailsBorderColor) {\n      this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\n    }\n  }\n  selectNextPage() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 5 /* Details */:\n        this._details.widget.pageDown();\n        return true;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusNextPage();\n        return true;\n    }\n  }\n  selectNext() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusNext(1, true);\n        return true;\n    }\n  }\n  selectLast() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 5 /* Details */:\n        this._details.widget.scrollBottom();\n        return true;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusLast();\n        return true;\n    }\n  }\n  selectPreviousPage() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 5 /* Details */:\n        this._details.widget.pageUp();\n        return true;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusPreviousPage();\n        return true;\n    }\n  }\n  selectPrevious() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusPrevious(1, true);\n        return false;\n    }\n  }\n  selectFirst() {\n    switch (this._state) {\n      case 0 /* Hidden */:\n        return false;\n      case 5 /* Details */:\n        this._details.widget.scrollTop();\n        return true;\n      case 1 /* Loading */:\n        return !this._isAuto;\n      default:\n        this._list.focusFirst();\n        return true;\n    }\n  }\n  getFocusedItem() {\n    if (this._state !== 0 /* Hidden */ && this._state !== 2 /* Empty */ && this._state !== 1 /* Loading */ && this._completionModel) {\n      return {\n        item: this._list.getFocusedElements()[0],\n        index: this._list.getFocus()[0],\n        model: this._completionModel\n      };\n    }\n    return undefined;\n  }\n  toggleDetailsFocus() {\n    if (this._state === 5 /* Details */) {\n      this._setState(3 /* Open */);\n      if (this._detailsBorderColor) {\n        this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\n      }\n    } else if (this._state === 3 /* Open */ && this._isDetailsVisible()) {\n      this._setState(5 /* Details */);\n      if (this._detailsFocusBorderColor) {\n        this._details.widget.domNode.style.borderColor = this._detailsFocusBorderColor;\n      }\n    }\n  }\n  toggleDetails() {\n    if (this._isDetailsVisible()) {\n      // hide details widget\n      this._ctxSuggestWidgetDetailsVisible.set(false);\n      this._setDetailsVisible(false);\n      this._details.hide();\n      this.element.domNode.classList.remove('shows-details');\n    } else if (canExpandCompletionItem(this._list.getFocusedElements()[0]) && (this._state === 3 /* Open */ || this._state === 5 /* Details */ || this._state === 4 /* Frozen */)) {\n      // show details widget (iff possible)\n      this._ctxSuggestWidgetDetailsVisible.set(true);\n      this._setDetailsVisible(true);\n      this.showDetails(false);\n    }\n  }\n  showDetails(loading) {\n    this._details.show();\n    if (loading) {\n      this._details.widget.renderLoading();\n    } else {\n      this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n    }\n    this._positionDetails();\n    this.editor.focus();\n    this.element.domNode.classList.add('shows-details');\n  }\n  toggleExplainMode() {\n    if (this._list.getFocusedElements()[0] && this._isDetailsVisible()) {\n      this._explainMode = !this._explainMode;\n      this.showDetails(false);\n    }\n  }\n  resetPersistedSize() {\n    this._persistedSize.reset();\n  }\n  hideWidget() {\n    var _a;\n    (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n    this._setState(0 /* Hidden */);\n    this._onDidHide.fire(this);\n    // ensure that a reasonable widget height is persisted so that\n    // accidential \"resize-to-single-items\" cases aren't happening\n    const dim = this._persistedSize.restore();\n    const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n    if (dim && dim.height < minPersistedHeight) {\n      this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n    }\n  }\n  isFrozen() {\n    return this._state === 4 /* Frozen */;\n  }\n\n  _afterRender(position) {\n    if (position === null) {\n      if (this._isDetailsVisible()) {\n        this._details.hide(); //todo@jrieken soft-hide\n      }\n\n      return;\n    }\n    if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\n      // no special positioning when widget isn't showing list\n      return;\n    }\n    if (this._isDetailsVisible()) {\n      this._details.show();\n    }\n    this._positionDetails();\n  }\n  _layout(size) {\n    var _a, _b, _c;\n    if (!this.editor.hasModel()) {\n      return;\n    }\n    if (!this.editor.getDomNode()) {\n      // happens when running tests\n      return;\n    }\n    const bodyBox = dom.getClientArea(document.body);\n    const info = this.getLayoutInfo();\n    if (!size) {\n      size = info.defaultSize;\n    }\n    let height = size.height;\n    let width = size.width;\n    // status bar\n    this._status.element.style.lineHeight = \"\".concat(info.itemHeight, \"px\");\n    if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\n      // showing a message only\n      height = info.itemHeight + info.borderHeight;\n      width = info.defaultSize.width / 2;\n      this.element.enableSashes(false, false, false, false);\n      this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n      this._contentWidget.setPreference(2 /* BELOW */);\n    } else {\n      // showing items\n      // width math\n      const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n      if (width > maxWidth) {\n        width = maxWidth;\n      }\n      const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n      // height math\n      const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n      const minHeight = info.itemHeight + info.statusBarHeight;\n      const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n      const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n      const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n      const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n      const maxHeightAbove = Math.min(editorBox.top + cursorBox.top - info.verticalPadding, fullHeight);\n      let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n      if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n        // Restore the old (wanted) height when the current\n        // height is capped to fit\n        height = this._cappedHeight.wanted;\n      }\n      if (height < minHeight) {\n        height = minHeight;\n      }\n      if (height > maxHeight) {\n        height = maxHeight;\n      }\n      if (height > maxHeightBelow) {\n        this._contentWidget.setPreference(1 /* ABOVE */);\n        this.element.enableSashes(true, true, false, false);\n        maxHeight = maxHeightAbove;\n      } else {\n        this._contentWidget.setPreference(2 /* BELOW */);\n        this.element.enableSashes(false, true, true, false);\n        maxHeight = maxHeightBelow;\n      }\n      this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n      this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n      this.element.minSize = new dom.Dimension(220, minHeight);\n      // Know when the height was capped to fit and remember\n      // the wanted height for later. This is required when going\n      // left to widen suggestions.\n      this._cappedHeight = height === fullHeight ? {\n        wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height,\n        capped: height\n      } : undefined;\n    }\n    this._resize(width, height);\n  }\n  _resize(width, height) {\n    const {\n      width: maxWidth,\n      height: maxHeight\n    } = this.element.maxSize;\n    width = Math.min(maxWidth, width);\n    height = Math.min(maxHeight, height);\n    const {\n      statusBarHeight\n    } = this.getLayoutInfo();\n    this._list.layout(height - statusBarHeight, width);\n    this._listElement.style.height = \"\".concat(height - statusBarHeight, \"px\");\n    this.element.layout(height, width);\n    this._contentWidget.layout();\n    this._positionDetails();\n  }\n  _positionDetails() {\n    if (this._isDetailsVisible()) {\n      this._details.placeAtAnchor(this.element.domNode);\n    }\n  }\n  getLayoutInfo() {\n    const fontInfo = this.editor.getOption(38 /* fontInfo */);\n    const itemHeight = clamp(this.editor.getOption(103 /* suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n    const statusBarHeight = !this.editor.getOption(101 /* suggest */).showStatusBar || this._state === 2 /* Empty */ || this._state === 1 /* Loading */ ? 0 : itemHeight;\n    const borderWidth = this._details.widget.borderWidth;\n    const borderHeight = 2 * borderWidth;\n    return {\n      itemHeight,\n      statusBarHeight,\n      borderWidth,\n      borderHeight,\n      typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n      verticalPadding: 22,\n      horizontalPadding: 14,\n      defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n    };\n  }\n  _isDetailsVisible() {\n    return this._storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, false);\n  }\n  _setDetailsVisible(value) {\n    this._storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */, 0 /* USER */);\n  }\n};\n\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = __decorate([__param(1, IStorageService), __param(2, IContextKeyService), __param(3, IThemeService), __param(4, IInstantiationService)], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n  constructor(_widget, _editor) {\n    this._widget = _widget;\n    this._editor = _editor;\n    this.allowEditorOverflow = true;\n    this.suppressMouseDown = false;\n    this._preferenceLocked = false;\n    this._added = false;\n    this._hidden = false;\n  }\n  dispose() {\n    if (this._added) {\n      this._added = false;\n      this._editor.removeContentWidget(this);\n    }\n  }\n  getId() {\n    return 'editor.widget.suggestWidget';\n  }\n  getDomNode() {\n    return this._widget.element.domNode;\n  }\n  show() {\n    this._hidden = false;\n    if (!this._added) {\n      this._added = true;\n      this._editor.addContentWidget(this);\n    }\n  }\n  hide() {\n    if (!this._hidden) {\n      this._hidden = true;\n      this.layout();\n    }\n  }\n  layout() {\n    this._editor.layoutContentWidget(this);\n  }\n  getPosition() {\n    if (this._hidden || !this._position || !this._preference) {\n      return null;\n    }\n    return {\n      position: this._position,\n      preference: [this._preference]\n    };\n  }\n  beforeRender() {\n    const {\n      height,\n      width\n    } = this._widget.element.size;\n    const {\n      borderWidth,\n      horizontalPadding\n    } = this._widget.getLayoutInfo();\n    return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n  }\n  afterRender(position) {\n    this._widget._afterRender(position);\n  }\n  setPreference(preference) {\n    if (!this._preferenceLocked) {\n      this._preference = preference;\n    }\n  }\n  lockPreference() {\n    this._preferenceLocked = true;\n  }\n  unlockPreference() {\n    this._preferenceLocked = false;\n  }\n  setPosition(position) {\n    this._position = position;\n  }\n}\nregisterThemingParticipant((theme, collector) => {\n  const matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\n  if (matchHighlight) {\n    collector.addRule(\".monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: \".concat(matchHighlight, \"; }\"));\n  }\n  const foreground = theme.getColor(editorSuggestWidgetForeground);\n  if (foreground) {\n    collector.addRule(\".monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: \".concat(foreground, \"; }\"));\n  }\n  const link = theme.getColor(textLinkForeground);\n  if (link) {\n    collector.addRule(\".monaco-editor .suggest-details a { color: \".concat(link, \"; }\"));\n  }\n  const codeBackground = theme.getColor(textCodeBlockBackground);\n  if (codeBackground) {\n    collector.addRule(\".monaco-editor .suggest-details code { background-color: \".concat(codeBackground, \"; }\"));\n  }\n});","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","nls","strings","dom","Emitter","onUnexpectedError","DisposableStore","List","IContextKeyService","Context","SuggestContext","attachListStyler","IThemeService","registerThemingParticipant","registerColor","editorWidgetBackground","listFocusBackground","activeContrastBorder","listHighlightForeground","editorForeground","editorWidgetBorder","focusBorder","textLinkForeground","textCodeBlockBackground","IStorageService","TimeoutTimer","createCancelablePromise","disposableTimeout","IInstantiationService","SuggestDetailsWidget","canExpandCompletionItem","SuggestDetailsOverlay","SuggestWidgetStatus","getAriaId","ItemRenderer","ResizableHTMLElement","EmbeddedCodeEditorWidget","clamp","editorSuggestWidgetBackground","dark","light","hc","localize","editorSuggestWidgetBorder","editorSuggestWidgetForeground","editorSuggestWidgetSelectedBackground","editorSuggestWidgetHighlightForeground","PersistedWidgetSize","constructor","_service","editor","_key","concat","getEditorType","restore","_a","raw","get","obj","JSON","parse","Dimension","is","lift","_b","undefined","store","size","stringify","reset","remove","SuggestWidget","_storageService","_contextKeyService","_themeService","instantiationService","_state","_isAuto","_ignoreFocusEvents","_explainMode","_showTimeout","_disposables","_onDidSelect","_onDidFocus","_onDidHide","_onDidShow","onDidSelect","event","onDidFocus","onDidHide","onDidShow","_onDetailsKeydown","onDetailsKeyDown","element","domNode","classList","add","_contentWidget","SuggestContentWidget","_persistedSize","ResizeState","persistedSize","currentSize","persistHeight","persistWidth","state","onDidWillResize","lockPreference","onDidResize","_c","_d","_resize","dimension","width","height","north","south","east","west","itemHeight","defaultSize","getLayoutInfo","threshold","Math","round","abs","unlockPreference","_messageElement","append","$","_listElement","details","createInstance","onDidClose","toggleDetails","_details","applyIconStyle","toggle","getOption","showIcons","renderer","onDidToggleDetails","_list","getHeight","_element","getTemplateId","useShadows","mouseSupport","accessibilityProvider","getRole","getAriaLabel","item","textLabel","completion","label","name","isResolved","_isDetailsVisible","documentation","detail","docs","format","getWidgetAriaLabel","getWidgetRole","_status","applyStatusBarStyle","showStatusBar","listInactiveFocusBackground","listInactiveFocusOutline","onDidColorThemeChange","t","_onThemeChange","getColorTheme","onMouseDown","_onListMouseDownOrTap","onTap","onDidChangeSelection","_onListSelection","onDidChangeFocus","_onListFocus","onDidChangeCursorSelection","_onCursorSelectionChanged","onDidChangeConfiguration","hasChanged","_ctxSuggestWidgetVisible","Visible","bindTo","_ctxSuggestWidgetDetailsVisible","DetailsVisible","_ctxSuggestWidgetMultipleSuggestions","MultipleSuggestions","addStandardDisposableListener","widget","fire","_onEditorMouseDown","dispose","_loadingTimeout","mouseEvent","contains","focus","layout","index","browserEvent","preventDefault","stopPropagation","_select","elements","indexes","completionModel","_completionModel","model","theme","backgroundColor","getColor","style","toString","borderColor","borderTopColor","_detailsBorderColor","focusBorderColor","_detailsFocusBorderColor","borderWidth","type","_currentSuggestionDetails","cancel","_focusedItem","setAriaOptions","activeDescendant","reveal","token","loading","showDetails","onCancellationRequested","splice","setFocus","catch","_setState","hide","_cappedHeight","textContent","LOADING_MESSAGE","show","_show","NO_SUGGESTIONS_MESSAGE","_layout","set","cancelAndSet","showTriggered","auto","delay","setPosition","getPosition","showSuggestions","selectionIndex","isFrozen","isAuto","visibleCount","items","isEmpty","selectNextPage","pageDown","focusNextPage","selectNext","focusNext","selectLast","scrollBottom","focusLast","selectPreviousPage","pageUp","focusPreviousPage","selectPrevious","focusPrevious","selectFirst","scrollTop","focusFirst","getFocusedItem","getFocusedElements","getFocus","toggleDetailsFocus","_setDetailsVisible","renderLoading","renderItem","_positionDetails","toggleExplainMode","resetPersistedSize","hideWidget","dim","minPersistedHeight","ceil","with","_afterRender","position","hasModel","getDomNode","bodyBox","getClientArea","document","body","info","lineHeight","borderHeight","enableSashes","minSize","maxSize","setPreference","maxWidth","horizontalPadding","preferredWidth","stats","pLabelLen","typicalHalfwidthCharacterWidth","fullHeight","statusBarHeight","contentHeight","minHeight","editorBox","getDomNodePagePosition","cursorBox","getScrolledVisiblePosition","cursorBottom","top","maxHeightBelow","min","verticalPadding","maxHeightAbove","maxHeight","max","capped","wanted","preferredSize","placeAtAnchor","fontInfo","getBoolean","_widget","_editor","allowEditorOverflow","suppressMouseDown","_preferenceLocked","_added","_hidden","removeContentWidget","getId","addContentWidget","layoutContentWidget","_position","_preference","preference","beforeRender","afterRender","collector","matchHighlight","addRule","foreground","link","codeBackground"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './media/suggest.css';\r\nimport '../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../symbolIcons/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\r\nimport * as nls from '../../../nls.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { attachListStyler } from '../../../platform/theme/common/styler.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorWidgetBackground, listFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { TimeoutTimer, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { SuggestDetailsWidget, canExpandCompletionItem, SuggestDetailsOverlay } from './suggestWidgetDetails.js';\r\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\r\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\r\nimport { ResizableHTMLElement } from './resizable.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { clamp } from '../../../base/common/numbers.js';\r\n/**\r\n * Suggest widget colors\r\n */\r\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\r\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\r\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\r\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: listFocusBackground, light: listFocusBackground, hc: listFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\r\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\r\nclass PersistedWidgetSize {\r\n    constructor(_service, editor) {\r\n        this._service = _service;\r\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\r\n    }\r\n    restore() {\r\n        var _a;\r\n        const raw = (_a = this._service.get(this._key, 0 /* GLOBAL */)) !== null && _a !== void 0 ? _a : '';\r\n        try {\r\n            const obj = JSON.parse(raw);\r\n            if (dom.Dimension.is(obj)) {\r\n                return dom.Dimension.lift(obj);\r\n            }\r\n        }\r\n        catch (_b) {\r\n            // ignore\r\n        }\r\n        return undefined;\r\n    }\r\n    store(size) {\r\n        this._service.store(this._key, JSON.stringify(size), 0 /* GLOBAL */, 1 /* MACHINE */);\r\n    }\r\n    reset() {\r\n        this._service.remove(this._key, 0 /* GLOBAL */);\r\n    }\r\n}\r\nlet SuggestWidget = class SuggestWidget {\r\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\r\n        this.editor = editor;\r\n        this._storageService = _storageService;\r\n        this._state = 0 /* Hidden */;\r\n        this._isAuto = false;\r\n        this._ignoreFocusEvents = false;\r\n        this._explainMode = false;\r\n        this._showTimeout = new TimeoutTimer();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidSelect = new Emitter();\r\n        this._onDidFocus = new Emitter();\r\n        this._onDidHide = new Emitter();\r\n        this._onDidShow = new Emitter();\r\n        this.onDidSelect = this._onDidSelect.event;\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this.onDidHide = this._onDidHide.event;\r\n        this.onDidShow = this._onDidShow.event;\r\n        this._onDetailsKeydown = new Emitter();\r\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\r\n        this.element = new ResizableHTMLElement();\r\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\r\n        this._contentWidget = new SuggestContentWidget(this, editor);\r\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\r\n        class ResizeState {\r\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\r\n                this.persistedSize = persistedSize;\r\n                this.currentSize = currentSize;\r\n                this.persistHeight = persistHeight;\r\n                this.persistWidth = persistWidth;\r\n            }\r\n        }\r\n        let state;\r\n        this._disposables.add(this.element.onDidWillResize(() => {\r\n            this._contentWidget.lockPreference();\r\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\r\n        }));\r\n        this._disposables.add(this.element.onDidResize(e => {\r\n            var _a, _b, _c, _d;\r\n            this._resize(e.dimension.width, e.dimension.height);\r\n            if (state) {\r\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\r\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\r\n            }\r\n            if (!e.done) {\r\n                return;\r\n            }\r\n            if (state) {\r\n                // only store width or height value that have changed and also\r\n                // only store changes that are above a certain threshold\r\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\r\n                const threshold = Math.round(itemHeight / 2);\r\n                let { width, height } = this.element.size;\r\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\r\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\r\n                }\r\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\r\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\r\n                }\r\n                this._persistedSize.store(new dom.Dimension(width, height));\r\n            }\r\n            // reset working state\r\n            this._contentWidget.unlockPreference();\r\n            state = undefined;\r\n        }));\r\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\r\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\r\n        const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\r\n        details.onDidClose(this.toggleDetails, this, this._disposables);\r\n        this._details = new SuggestDetailsOverlay(details, this.editor);\r\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(101 /* suggest */).showIcons);\r\n        applyIconStyle();\r\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\r\n        this._disposables.add(renderer);\r\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\r\n        this._list = new List('SuggestWidget', this._listElement, {\r\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\r\n            getTemplateId: (_element) => 'suggestion'\r\n        }, [renderer], {\r\n            useShadows: false,\r\n            mouseSupport: false,\r\n            accessibilityProvider: {\r\n                getRole: () => 'option',\r\n                getAriaLabel: (item) => {\r\n                    const textLabel = typeof item.completion.label === 'string' ? item.completion.label : item.completion.label.name;\r\n                    if (item.isResolved && this._isDetailsVisible()) {\r\n                        const { documentation, detail } = item.completion;\r\n                        const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\r\n                        return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", textLabel, docs);\r\n                    }\r\n                    else {\r\n                        return textLabel;\r\n                    }\r\n                },\r\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\r\n                getWidgetRole: () => 'listbox'\r\n            }\r\n        });\r\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\r\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(101 /* suggest */).showStatusBar);\r\n        applyStatusBarStyle();\r\n        this._disposables.add(attachListStyler(this._list, _themeService, {\r\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\r\n            listInactiveFocusOutline: activeContrastBorder\r\n        }));\r\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\r\n        this._onThemeChange(_themeService.getColorTheme());\r\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\r\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\r\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\r\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\r\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\r\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(101 /* suggest */)) {\r\n                applyStatusBarStyle();\r\n                applyIconStyle();\r\n            }\r\n        }));\r\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\r\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\r\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\r\n            this._onDetailsKeydown.fire(e);\r\n        }));\r\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        this._details.widget.dispose();\r\n        this._details.dispose();\r\n        this._list.dispose();\r\n        this._status.dispose();\r\n        this._disposables.dispose();\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._showTimeout.dispose();\r\n        this._contentWidget.dispose();\r\n        this.element.dispose();\r\n    }\r\n    _onEditorMouseDown(mouseEvent) {\r\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\r\n            // Clicking inside details\r\n            this._details.widget.domNode.focus();\r\n        }\r\n        else {\r\n            // Clicking outside details and inside suggest\r\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\r\n                this.editor.focus();\r\n            }\r\n        }\r\n    }\r\n    _onCursorSelectionChanged() {\r\n        if (this._state !== 0 /* Hidden */) {\r\n            this._contentWidget.layout();\r\n        }\r\n    }\r\n    _onListMouseDownOrTap(e) {\r\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\r\n            return;\r\n        }\r\n        // prevent stealing browser focus from the editor\r\n        e.browserEvent.preventDefault();\r\n        e.browserEvent.stopPropagation();\r\n        this._select(e.element, e.index);\r\n    }\r\n    _onListSelection(e) {\r\n        if (e.elements.length) {\r\n            this._select(e.elements[0], e.indexes[0]);\r\n        }\r\n    }\r\n    _select(item, index) {\r\n        const completionModel = this._completionModel;\r\n        if (completionModel) {\r\n            this._onDidSelect.fire({ item, index, model: completionModel });\r\n            this.editor.focus();\r\n        }\r\n    }\r\n    _onThemeChange(theme) {\r\n        const backgroundColor = theme.getColor(editorSuggestWidgetBackground);\r\n        if (backgroundColor) {\r\n            this.element.domNode.style.backgroundColor = backgroundColor.toString();\r\n            this._messageElement.style.backgroundColor = backgroundColor.toString();\r\n            this._details.widget.domNode.style.backgroundColor = backgroundColor.toString();\r\n        }\r\n        const borderColor = theme.getColor(editorSuggestWidgetBorder);\r\n        if (borderColor) {\r\n            this.element.domNode.style.borderColor = borderColor.toString();\r\n            this._messageElement.style.borderColor = borderColor.toString();\r\n            this._status.element.style.borderTopColor = borderColor.toString();\r\n            this._details.widget.domNode.style.borderColor = borderColor.toString();\r\n            this._detailsBorderColor = borderColor.toString();\r\n        }\r\n        const focusBorderColor = theme.getColor(focusBorder);\r\n        if (focusBorderColor) {\r\n            this._detailsFocusBorderColor = focusBorderColor.toString();\r\n        }\r\n        this._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\r\n    }\r\n    _onListFocus(e) {\r\n        var _a;\r\n        if (this._ignoreFocusEvents) {\r\n            return;\r\n        }\r\n        if (!e.elements.length) {\r\n            if (this._currentSuggestionDetails) {\r\n                this._currentSuggestionDetails.cancel();\r\n                this._currentSuggestionDetails = undefined;\r\n                this._focusedItem = undefined;\r\n            }\r\n            this.editor.setAriaOptions({ activeDescendant: undefined });\r\n            return;\r\n        }\r\n        if (!this._completionModel) {\r\n            return;\r\n        }\r\n        const item = e.elements[0];\r\n        const index = e.indexes[0];\r\n        if (item !== this._focusedItem) {\r\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\r\n            this._currentSuggestionDetails = undefined;\r\n            this._focusedItem = item;\r\n            this._list.reveal(index);\r\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\r\n                const loading = disposableTimeout(() => {\r\n                    if (this._isDetailsVisible()) {\r\n                        this.showDetails(true);\r\n                    }\r\n                }, 250);\r\n                token.onCancellationRequested(() => loading.dispose());\r\n                const result = yield item.resolve(token);\r\n                loading.dispose();\r\n                return result;\r\n            }));\r\n            this._currentSuggestionDetails.then(() => {\r\n                if (index >= this._list.length || item !== this._list.element(index)) {\r\n                    return;\r\n                }\r\n                // item can have extra information, so re-render\r\n                this._ignoreFocusEvents = true;\r\n                this._list.splice(index, 1, [item]);\r\n                this._list.setFocus([index]);\r\n                this._ignoreFocusEvents = false;\r\n                if (this._isDetailsVisible()) {\r\n                    this.showDetails(false);\r\n                }\r\n                else {\r\n                    this.element.domNode.classList.remove('docs-side');\r\n                }\r\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\r\n            }).catch(onUnexpectedError);\r\n        }\r\n        // emit an event\r\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\r\n    }\r\n    _setState(state) {\r\n        if (this._state === state) {\r\n            return;\r\n        }\r\n        this._state = state;\r\n        this.element.domNode.classList.toggle('frozen', state === 4 /* Frozen */);\r\n        this.element.domNode.classList.remove('message');\r\n        switch (state) {\r\n            case 0 /* Hidden */:\r\n                dom.hide(this._messageElement, this._listElement, this._status.element);\r\n                this._details.hide(true);\r\n                this._status.hide();\r\n                this._contentWidget.hide();\r\n                this._ctxSuggestWidgetVisible.reset();\r\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\r\n                this.element.domNode.classList.remove('visible');\r\n                this._list.splice(0, this._list.length);\r\n                this._focusedItem = undefined;\r\n                this._cappedHeight = undefined;\r\n                this._explainMode = false;\r\n                break;\r\n            case 1 /* Loading */:\r\n                this.element.domNode.classList.add('message');\r\n                this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\r\n                dom.hide(this._listElement, this._status.element);\r\n                dom.show(this._messageElement);\r\n                this._details.hide();\r\n                this._show();\r\n                this._focusedItem = undefined;\r\n                break;\r\n            case 2 /* Empty */:\r\n                this.element.domNode.classList.add('message');\r\n                this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\r\n                dom.hide(this._listElement, this._status.element);\r\n                dom.show(this._messageElement);\r\n                this._details.hide();\r\n                this._show();\r\n                this._focusedItem = undefined;\r\n                break;\r\n            case 3 /* Open */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._show();\r\n                break;\r\n            case 4 /* Frozen */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._show();\r\n                break;\r\n            case 5 /* Details */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._details.show();\r\n                this._show();\r\n                break;\r\n        }\r\n    }\r\n    _show() {\r\n        this._status.show();\r\n        this._contentWidget.show();\r\n        this._layout(this._persistedSize.restore());\r\n        this._ctxSuggestWidgetVisible.set(true);\r\n        this._showTimeout.cancelAndSet(() => {\r\n            this.element.domNode.classList.add('visible');\r\n            this._onDidShow.fire(this);\r\n        }, 100);\r\n    }\r\n    showTriggered(auto, delay) {\r\n        if (this._state !== 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this._contentWidget.setPosition(this.editor.getPosition());\r\n        this._isAuto = !!auto;\r\n        if (!this._isAuto) {\r\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* Loading */), delay);\r\n        }\r\n    }\r\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\r\n        var _a, _b;\r\n        this._contentWidget.setPosition(this.editor.getPosition());\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\r\n        this._currentSuggestionDetails = undefined;\r\n        if (this._completionModel !== completionModel) {\r\n            this._completionModel = completionModel;\r\n        }\r\n        if (isFrozen && this._state !== 2 /* Empty */ && this._state !== 0 /* Hidden */) {\r\n            this._setState(4 /* Frozen */);\r\n            return;\r\n        }\r\n        const visibleCount = this._completionModel.items.length;\r\n        const isEmpty = visibleCount === 0;\r\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\r\n        if (isEmpty) {\r\n            this._setState(isAuto ? 0 /* Hidden */ : 2 /* Empty */);\r\n            this._completionModel = undefined;\r\n            return;\r\n        }\r\n        this._focusedItem = undefined;\r\n        this._list.splice(0, this._list.length, this._completionModel.items);\r\n        this._setState(isFrozen ? 4 /* Frozen */ : 3 /* Open */);\r\n        this._list.reveal(selectionIndex, 0);\r\n        this._list.setFocus([selectionIndex]);\r\n        this._layout(this.element.size);\r\n        // Reset focus border\r\n        if (this._detailsBorderColor) {\r\n            this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\r\n        }\r\n    }\r\n    selectNextPage() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.pageDown();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusNextPage();\r\n                return true;\r\n        }\r\n    }\r\n    selectNext() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusNext(1, true);\r\n                return true;\r\n        }\r\n    }\r\n    selectLast() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.scrollBottom();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusLast();\r\n                return true;\r\n        }\r\n    }\r\n    selectPreviousPage() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.pageUp();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusPreviousPage();\r\n                return true;\r\n        }\r\n    }\r\n    selectPrevious() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusPrevious(1, true);\r\n                return false;\r\n        }\r\n    }\r\n    selectFirst() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.scrollTop();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusFirst();\r\n                return true;\r\n        }\r\n    }\r\n    getFocusedItem() {\r\n        if (this._state !== 0 /* Hidden */\r\n            && this._state !== 2 /* Empty */\r\n            && this._state !== 1 /* Loading */\r\n            && this._completionModel) {\r\n            return {\r\n                item: this._list.getFocusedElements()[0],\r\n                index: this._list.getFocus()[0],\r\n                model: this._completionModel\r\n            };\r\n        }\r\n        return undefined;\r\n    }\r\n    toggleDetailsFocus() {\r\n        if (this._state === 5 /* Details */) {\r\n            this._setState(3 /* Open */);\r\n            if (this._detailsBorderColor) {\r\n                this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\r\n            }\r\n        }\r\n        else if (this._state === 3 /* Open */ && this._isDetailsVisible()) {\r\n            this._setState(5 /* Details */);\r\n            if (this._detailsFocusBorderColor) {\r\n                this._details.widget.domNode.style.borderColor = this._detailsFocusBorderColor;\r\n            }\r\n        }\r\n    }\r\n    toggleDetails() {\r\n        if (this._isDetailsVisible()) {\r\n            // hide details widget\r\n            this._ctxSuggestWidgetDetailsVisible.set(false);\r\n            this._setDetailsVisible(false);\r\n            this._details.hide();\r\n            this.element.domNode.classList.remove('shows-details');\r\n        }\r\n        else if (canExpandCompletionItem(this._list.getFocusedElements()[0]) && (this._state === 3 /* Open */ || this._state === 5 /* Details */ || this._state === 4 /* Frozen */)) {\r\n            // show details widget (iff possible)\r\n            this._ctxSuggestWidgetDetailsVisible.set(true);\r\n            this._setDetailsVisible(true);\r\n            this.showDetails(false);\r\n        }\r\n    }\r\n    showDetails(loading) {\r\n        this._details.show();\r\n        if (loading) {\r\n            this._details.widget.renderLoading();\r\n        }\r\n        else {\r\n            this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\r\n        }\r\n        this._positionDetails();\r\n        this.editor.focus();\r\n        this.element.domNode.classList.add('shows-details');\r\n    }\r\n    toggleExplainMode() {\r\n        if (this._list.getFocusedElements()[0] && this._isDetailsVisible()) {\r\n            this._explainMode = !this._explainMode;\r\n            this.showDetails(false);\r\n        }\r\n    }\r\n    resetPersistedSize() {\r\n        this._persistedSize.reset();\r\n    }\r\n    hideWidget() {\r\n        var _a;\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._setState(0 /* Hidden */);\r\n        this._onDidHide.fire(this);\r\n        // ensure that a reasonable widget height is persisted so that\r\n        // accidential \"resize-to-single-items\" cases aren't happening\r\n        const dim = this._persistedSize.restore();\r\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\r\n        if (dim && dim.height < minPersistedHeight) {\r\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\r\n        }\r\n    }\r\n    isFrozen() {\r\n        return this._state === 4 /* Frozen */;\r\n    }\r\n    _afterRender(position) {\r\n        if (position === null) {\r\n            if (this._isDetailsVisible()) {\r\n                this._details.hide(); //todo@jrieken soft-hide\r\n            }\r\n            return;\r\n        }\r\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\r\n            // no special positioning when widget isn't showing list\r\n            return;\r\n        }\r\n        if (this._isDetailsVisible()) {\r\n            this._details.show();\r\n        }\r\n        this._positionDetails();\r\n    }\r\n    _layout(size) {\r\n        var _a, _b, _c;\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this.editor.getDomNode()) {\r\n            // happens when running tests\r\n            return;\r\n        }\r\n        const bodyBox = dom.getClientArea(document.body);\r\n        const info = this.getLayoutInfo();\r\n        if (!size) {\r\n            size = info.defaultSize;\r\n        }\r\n        let height = size.height;\r\n        let width = size.width;\r\n        // status bar\r\n        this._status.element.style.lineHeight = `${info.itemHeight}px`;\r\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\r\n            // showing a message only\r\n            height = info.itemHeight + info.borderHeight;\r\n            width = info.defaultSize.width / 2;\r\n            this.element.enableSashes(false, false, false, false);\r\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\r\n            this._contentWidget.setPreference(2 /* BELOW */);\r\n        }\r\n        else {\r\n            // showing items\r\n            // width math\r\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\r\n            if (width > maxWidth) {\r\n                width = maxWidth;\r\n            }\r\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\r\n            // height math\r\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\r\n            const minHeight = info.itemHeight + info.statusBarHeight;\r\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\r\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\r\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\r\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\r\n            const maxHeightAbove = Math.min(editorBox.top + cursorBox.top - info.verticalPadding, fullHeight);\r\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\r\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\r\n                // Restore the old (wanted) height when the current\r\n                // height is capped to fit\r\n                height = this._cappedHeight.wanted;\r\n            }\r\n            if (height < minHeight) {\r\n                height = minHeight;\r\n            }\r\n            if (height > maxHeight) {\r\n                height = maxHeight;\r\n            }\r\n            if (height > maxHeightBelow) {\r\n                this._contentWidget.setPreference(1 /* ABOVE */);\r\n                this.element.enableSashes(true, true, false, false);\r\n                maxHeight = maxHeightAbove;\r\n            }\r\n            else {\r\n                this._contentWidget.setPreference(2 /* BELOW */);\r\n                this.element.enableSashes(false, true, true, false);\r\n                maxHeight = maxHeightBelow;\r\n            }\r\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\r\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\r\n            this.element.minSize = new dom.Dimension(220, minHeight);\r\n            // Know when the height was capped to fit and remember\r\n            // the wanted height for later. This is required when going\r\n            // left to widen suggestions.\r\n            this._cappedHeight = height === fullHeight\r\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\r\n                : undefined;\r\n        }\r\n        this._resize(width, height);\r\n    }\r\n    _resize(width, height) {\r\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\r\n        width = Math.min(maxWidth, width);\r\n        height = Math.min(maxHeight, height);\r\n        const { statusBarHeight } = this.getLayoutInfo();\r\n        this._list.layout(height - statusBarHeight, width);\r\n        this._listElement.style.height = `${height - statusBarHeight}px`;\r\n        this.element.layout(height, width);\r\n        this._contentWidget.layout();\r\n        this._positionDetails();\r\n    }\r\n    _positionDetails() {\r\n        if (this._isDetailsVisible()) {\r\n            this._details.placeAtAnchor(this.element.domNode);\r\n        }\r\n    }\r\n    getLayoutInfo() {\r\n        const fontInfo = this.editor.getOption(38 /* fontInfo */);\r\n        const itemHeight = clamp(this.editor.getOption(103 /* suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\r\n        const statusBarHeight = !this.editor.getOption(101 /* suggest */).showStatusBar || this._state === 2 /* Empty */ || this._state === 1 /* Loading */ ? 0 : itemHeight;\r\n        const borderWidth = this._details.widget.borderWidth;\r\n        const borderHeight = 2 * borderWidth;\r\n        return {\r\n            itemHeight,\r\n            statusBarHeight,\r\n            borderWidth,\r\n            borderHeight,\r\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\r\n            verticalPadding: 22,\r\n            horizontalPadding: 14,\r\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\r\n        };\r\n    }\r\n    _isDetailsVisible() {\r\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, false);\r\n    }\r\n    _setDetailsVisible(value) {\r\n        this._storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */, 0 /* USER */);\r\n    }\r\n};\r\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\r\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\r\nSuggestWidget = __decorate([\r\n    __param(1, IStorageService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, IThemeService),\r\n    __param(4, IInstantiationService)\r\n], SuggestWidget);\r\nexport { SuggestWidget };\r\nexport class SuggestContentWidget {\r\n    constructor(_widget, _editor) {\r\n        this._widget = _widget;\r\n        this._editor = _editor;\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._preferenceLocked = false;\r\n        this._added = false;\r\n        this._hidden = false;\r\n    }\r\n    dispose() {\r\n        if (this._added) {\r\n            this._added = false;\r\n            this._editor.removeContentWidget(this);\r\n        }\r\n    }\r\n    getId() {\r\n        return 'editor.widget.suggestWidget';\r\n    }\r\n    getDomNode() {\r\n        return this._widget.element.domNode;\r\n    }\r\n    show() {\r\n        this._hidden = false;\r\n        if (!this._added) {\r\n            this._added = true;\r\n            this._editor.addContentWidget(this);\r\n        }\r\n    }\r\n    hide() {\r\n        if (!this._hidden) {\r\n            this._hidden = true;\r\n            this.layout();\r\n        }\r\n    }\r\n    layout() {\r\n        this._editor.layoutContentWidget(this);\r\n    }\r\n    getPosition() {\r\n        if (this._hidden || !this._position || !this._preference) {\r\n            return null;\r\n        }\r\n        return {\r\n            position: this._position,\r\n            preference: [this._preference]\r\n        };\r\n    }\r\n    beforeRender() {\r\n        const { height, width } = this._widget.element.size;\r\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\r\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\r\n    }\r\n    afterRender(position) {\r\n        this._widget._afterRender(position);\r\n    }\r\n    setPreference(preference) {\r\n        if (!this._preferenceLocked) {\r\n            this._preference = preference;\r\n        }\r\n    }\r\n    lockPreference() {\r\n        this._preferenceLocked = true;\r\n    }\r\n    unlockPreference() {\r\n        this._preferenceLocked = false;\r\n    }\r\n    setPosition(position) {\r\n        this._position = position;\r\n    }\r\n}\r\nregisterThemingParticipant((theme, collector) => {\r\n    const matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\r\n    if (matchHighlight) {\r\n        collector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${matchHighlight}; }`);\r\n    }\r\n    const foreground = theme.getColor(editorSuggestWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${foreground}; }`);\r\n    }\r\n    const link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(`.monaco-editor .suggest-details a { color: ${link}; }`);\r\n    }\r\n    const codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(`.monaco-editor .suggest-details code { background-color: ${codeBackground}; }`);\r\n    }\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}