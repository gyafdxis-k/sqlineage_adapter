{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { getOrDefault } from '../../../common/objects.js';\nimport { dispose, Disposable, toDisposable, DisposableStore } from '../../../common/lifecycle.js';\nimport { Gesture, EventType as TouchEventType } from '../../touch.js';\nimport { Event, Emitter } from '../../../common/event.js';\nimport { domEvent } from '../../event.js';\nimport { SmoothScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { Scrollable } from '../../../common/scrollable.js';\nimport { RangeMap, shift } from './rangeMap.js';\nimport { RowCache } from './rowCache.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Range } from '../../../common/range.js';\nimport { equals, distinct } from '../../../common/arrays.js';\nimport { DataTransfers, StaticDND } from '../../dnd.js';\nimport { disposableTimeout, Delayer } from '../../../common/async.js';\nimport { isFirefox } from '../../browser.js';\nimport { $, animate, getContentHeight, getContentWidth, getTopLeftOffset, scheduleAtNextAnimationFrame } from '../../dom.js';\nconst DefaultOptions = {\n  useShadows: true,\n  verticalScrollMode: 1 /* Auto */,\n  setRowLineHeight: true,\n  setRowHeight: true,\n  supportDynamicHeights: false,\n  dnd: {\n    getDragElements(e) {\n      return [e];\n    },\n    getDragURI() {\n      return null;\n    },\n    onDragStart() {},\n    onDragOver() {\n      return false;\n    },\n    drop() {}\n  },\n  horizontalScrolling: false,\n  transformOptimization: true\n};\nexport class ElementsDragAndDropData {\n  constructor(elements) {\n    this.elements = elements;\n  }\n  update() {}\n  getData() {\n    return this.elements;\n  }\n}\nexport class ExternalElementsDragAndDropData {\n  constructor(elements) {\n    this.elements = elements;\n  }\n  update() {}\n  getData() {\n    return this.elements;\n  }\n}\nexport class NativeDragAndDropData {\n  constructor() {\n    this.types = [];\n    this.files = [];\n  }\n  update(dataTransfer) {\n    if (dataTransfer.types) {\n      this.types.splice(0, this.types.length, ...dataTransfer.types);\n    }\n    if (dataTransfer.files) {\n      this.files.splice(0, this.files.length);\n      for (let i = 0; i < dataTransfer.files.length; i++) {\n        const file = dataTransfer.files.item(i);\n        if (file && (file.size || file.type)) {\n          this.files.push(file);\n        }\n      }\n    }\n  }\n  getData() {\n    return {\n      types: this.types,\n      files: this.files\n    };\n  }\n}\nfunction equalsDragFeedback(f1, f2) {\n  if (Array.isArray(f1) && Array.isArray(f2)) {\n    return equals(f1, f2);\n  }\n  return f1 === f2;\n}\nclass ListViewAccessibilityProvider {\n  constructor(accessibilityProvider) {\n    if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getSetSize) {\n      this.getSetSize = accessibilityProvider.getSetSize.bind(accessibilityProvider);\n    } else {\n      this.getSetSize = (e, i, l) => l;\n    }\n    if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getPosInSet) {\n      this.getPosInSet = accessibilityProvider.getPosInSet.bind(accessibilityProvider);\n    } else {\n      this.getPosInSet = (e, i) => i + 1;\n    }\n    if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getRole) {\n      this.getRole = accessibilityProvider.getRole.bind(accessibilityProvider);\n    } else {\n      this.getRole = _ => 'listitem';\n    }\n    if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.isChecked) {\n      this.isChecked = accessibilityProvider.isChecked.bind(accessibilityProvider);\n    } else {\n      this.isChecked = _ => undefined;\n    }\n  }\n}\nexport class ListView {\n  constructor(container, virtualDelegate, renderers) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : DefaultOptions;\n    this.virtualDelegate = virtualDelegate;\n    this.domId = \"list_id_\".concat(++ListView.InstanceCount);\n    this.renderers = new Map();\n    this.renderWidth = 0;\n    this._scrollHeight = 0;\n    this.scrollableElementUpdateDisposable = null;\n    this.scrollableElementWidthDelayer = new Delayer(50);\n    this.splicing = false;\n    this.dragOverAnimationStopDisposable = Disposable.None;\n    this.dragOverMouseY = 0;\n    this.canDrop = false;\n    this.currentDragFeedbackDisposable = Disposable.None;\n    this.onDragLeaveTimeout = Disposable.None;\n    this.disposables = new DisposableStore();\n    this._onDidChangeContentHeight = new Emitter();\n    this._horizontalScrolling = false;\n    if (options.horizontalScrolling && options.supportDynamicHeights) {\n      throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\n    }\n    this.items = [];\n    this.itemId = 0;\n    this.rangeMap = new RangeMap();\n    for (const renderer of renderers) {\n      this.renderers.set(renderer.templateId, renderer);\n    }\n    this.cache = this.disposables.add(new RowCache(this.renderers));\n    this.lastRenderTop = 0;\n    this.lastRenderHeight = 0;\n    this.domNode = document.createElement('div');\n    this.domNode.className = 'monaco-list';\n    this.domNode.classList.add(this.domId);\n    this.domNode.tabIndex = 0;\n    this.domNode.classList.toggle('mouse-support', typeof options.mouseSupport === 'boolean' ? options.mouseSupport : true);\n    this._horizontalScrolling = getOrDefault(options, o => o.horizontalScrolling, DefaultOptions.horizontalScrolling);\n    this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\n    this.additionalScrollHeight = typeof options.additionalScrollHeight === 'undefined' ? 0 : options.additionalScrollHeight;\n    this.accessibilityProvider = new ListViewAccessibilityProvider(options.accessibilityProvider);\n    this.rowsContainer = document.createElement('div');\n    this.rowsContainer.className = 'monaco-list-rows';\n    const transformOptimization = getOrDefault(options, o => o.transformOptimization, DefaultOptions.transformOptimization);\n    if (transformOptimization) {\n      this.rowsContainer.style.transform = 'translate3d(0px, 0px, 0px)';\n    }\n    this.disposables.add(Gesture.addTarget(this.rowsContainer));\n    this.scrollable = new Scrollable(getOrDefault(options, o => o.smoothScrolling, false) ? 125 : 0, cb => scheduleAtNextAnimationFrame(cb));\n    this.scrollableElement = this.disposables.add(new SmoothScrollableElement(this.rowsContainer, {\n      horizontal: 1 /* Auto */,\n      vertical: getOrDefault(options, o => o.verticalScrollMode, DefaultOptions.verticalScrollMode),\n      useShadows: getOrDefault(options, o => o.useShadows, DefaultOptions.useShadows)\n    }, this.scrollable));\n    this.domNode.appendChild(this.scrollableElement.getDomNode());\n    container.appendChild(this.domNode);\n    this.scrollableElement.onScroll(this.onScroll, this, this.disposables);\n    domEvent(this.rowsContainer, TouchEventType.Change)(this.onTouchChange, this, this.disposables);\n    // Prevent the monaco-scrollable-element from scrolling\n    // https://github.com/microsoft/vscode/issues/44181\n    domEvent(this.scrollableElement.getDomNode(), 'scroll')(e => e.target.scrollTop = 0, null, this.disposables);\n    Event.map(domEvent(this.domNode, 'dragover'), e => this.toDragEvent(e))(this.onDragOver, this, this.disposables);\n    Event.map(domEvent(this.domNode, 'drop'), e => this.toDragEvent(e))(this.onDrop, this, this.disposables);\n    domEvent(this.domNode, 'dragleave')(this.onDragLeave, this, this.disposables);\n    domEvent(window, 'dragend')(this.onDragEnd, this, this.disposables);\n    this.setRowLineHeight = getOrDefault(options, o => o.setRowLineHeight, DefaultOptions.setRowLineHeight);\n    this.setRowHeight = getOrDefault(options, o => o.setRowHeight, DefaultOptions.setRowHeight);\n    this.supportDynamicHeights = getOrDefault(options, o => o.supportDynamicHeights, DefaultOptions.supportDynamicHeights);\n    this.dnd = getOrDefault(options, o => o.dnd, DefaultOptions.dnd);\n    this.layout();\n  }\n  get contentHeight() {\n    return this.rangeMap.size;\n  }\n  get horizontalScrolling() {\n    return this._horizontalScrolling;\n  }\n  set horizontalScrolling(value) {\n    if (value === this._horizontalScrolling) {\n      return;\n    }\n    if (value && this.supportDynamicHeights) {\n      throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\n    }\n    this._horizontalScrolling = value;\n    this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\n    if (this._horizontalScrolling) {\n      for (const item of this.items) {\n        this.measureItemWidth(item);\n      }\n      this.updateScrollWidth();\n      this.scrollableElement.setScrollDimensions({\n        width: getContentWidth(this.domNode)\n      });\n      this.rowsContainer.style.width = \"\".concat(Math.max(this.scrollWidth || 0, this.renderWidth), \"px\");\n    } else {\n      this.scrollableElementWidthDelayer.cancel();\n      this.scrollableElement.setScrollDimensions({\n        width: this.renderWidth,\n        scrollWidth: this.renderWidth\n      });\n      this.rowsContainer.style.width = '';\n    }\n  }\n  updateOptions(options) {\n    if (options.additionalScrollHeight !== undefined) {\n      this.additionalScrollHeight = options.additionalScrollHeight;\n    }\n    if (options.smoothScrolling !== undefined) {\n      this.scrollable.setSmoothScrollDuration(options.smoothScrolling ? 125 : 0);\n    }\n    if (options.horizontalScrolling !== undefined) {\n      this.horizontalScrolling = options.horizontalScrolling;\n    }\n  }\n  splice(start, deleteCount) {\n    let elements = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    if (this.splicing) {\n      throw new Error('Can\\'t run recursive splices.');\n    }\n    this.splicing = true;\n    try {\n      return this._splice(start, deleteCount, elements);\n    } finally {\n      this.splicing = false;\n      this._onDidChangeContentHeight.fire(this.contentHeight);\n    }\n  }\n  _splice(start, deleteCount) {\n    let elements = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n    const deleteRange = {\n      start,\n      end: start + deleteCount\n    };\n    const removeRange = Range.intersect(previousRenderRange, deleteRange);\n    // try to reuse rows, avoid removing them from DOM\n    const rowsToDispose = new Map();\n    for (let i = removeRange.start; i < removeRange.end; i++) {\n      const item = this.items[i];\n      item.dragStartDisposable.dispose();\n      if (item.row) {\n        let rows = rowsToDispose.get(item.templateId);\n        if (!rows) {\n          rows = [];\n          rowsToDispose.set(item.templateId, rows);\n        }\n        rows.push([item.row, item.element, i, item.size]);\n      }\n      item.row = null;\n    }\n    const previousRestRange = {\n      start: start + deleteCount,\n      end: this.items.length\n    };\n    const previousRenderedRestRange = Range.intersect(previousRestRange, previousRenderRange);\n    const previousUnrenderedRestRanges = Range.relativeComplement(previousRestRange, previousRenderRange);\n    const inserted = elements.map(element => ({\n      id: String(this.itemId++),\n      element,\n      templateId: this.virtualDelegate.getTemplateId(element),\n      size: this.virtualDelegate.getHeight(element),\n      width: undefined,\n      hasDynamicHeight: !!this.virtualDelegate.hasDynamicHeight && this.virtualDelegate.hasDynamicHeight(element),\n      lastDynamicHeightWidth: undefined,\n      row: null,\n      uri: undefined,\n      dropTarget: false,\n      dragStartDisposable: Disposable.None\n    }));\n    let deleted;\n    // TODO@joao: improve this optimization to catch even more cases\n    if (start === 0 && deleteCount >= this.items.length) {\n      this.rangeMap = new RangeMap();\n      this.rangeMap.splice(0, 0, inserted);\n      this.items = inserted;\n      deleted = [];\n    } else {\n      this.rangeMap.splice(start, deleteCount, inserted);\n      deleted = this.items.splice(start, deleteCount, ...inserted);\n    }\n    const delta = elements.length - deleteCount;\n    const renderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n    const renderedRestRange = shift(previousRenderedRestRange, delta);\n    const updateRange = Range.intersect(renderRange, renderedRestRange);\n    for (let i = updateRange.start; i < updateRange.end; i++) {\n      this.updateItemInDOM(this.items[i], i);\n    }\n    const removeRanges = Range.relativeComplement(renderedRestRange, renderRange);\n    for (const range of removeRanges) {\n      for (let i = range.start; i < range.end; i++) {\n        this.removeItemFromDOM(i);\n      }\n    }\n    const unrenderedRestRanges = previousUnrenderedRestRanges.map(r => shift(r, delta));\n    const elementsRange = {\n      start,\n      end: start + elements.length\n    };\n    const insertRanges = [elementsRange, ...unrenderedRestRanges].map(r => Range.intersect(renderRange, r));\n    const beforeElement = this.getNextToLastElement(insertRanges);\n    for (const range of insertRanges) {\n      for (let i = range.start; i < range.end; i++) {\n        const item = this.items[i];\n        const rows = rowsToDispose.get(item.templateId);\n        const rowData = rows === null || rows === void 0 ? void 0 : rows.pop();\n        if (!rowData) {\n          this.insertItemInDOM(i, beforeElement);\n        } else {\n          const [row, element, index, size] = rowData;\n          const renderer = this.renderers.get(item.templateId);\n          if (renderer && renderer.disposeElement) {\n            renderer.disposeElement(element, index, row.templateData, size);\n          }\n          this.insertItemInDOM(i, beforeElement, row);\n        }\n      }\n    }\n    for (const [templateId, rows] of rowsToDispose) {\n      for (const [row, element, index, size] of rows) {\n        const renderer = this.renderers.get(templateId);\n        if (renderer && renderer.disposeElement) {\n          renderer.disposeElement(element, index, row.templateData, size);\n        }\n        this.cache.release(row);\n      }\n    }\n    this.eventuallyUpdateScrollDimensions();\n    if (this.supportDynamicHeights) {\n      this._rerender(this.scrollTop, this.renderHeight);\n    }\n    return deleted.map(i => i.element);\n  }\n  eventuallyUpdateScrollDimensions() {\n    this._scrollHeight = this.contentHeight;\n    this.rowsContainer.style.height = \"\".concat(this._scrollHeight, \"px\");\n    if (!this.scrollableElementUpdateDisposable) {\n      this.scrollableElementUpdateDisposable = scheduleAtNextAnimationFrame(() => {\n        this.scrollableElement.setScrollDimensions({\n          scrollHeight: this.scrollHeight\n        });\n        this.updateScrollWidth();\n        this.scrollableElementUpdateDisposable = null;\n      });\n    }\n  }\n  eventuallyUpdateScrollWidth() {\n    if (!this.horizontalScrolling) {\n      this.scrollableElementWidthDelayer.cancel();\n      return;\n    }\n    this.scrollableElementWidthDelayer.trigger(() => this.updateScrollWidth());\n  }\n  updateScrollWidth() {\n    if (!this.horizontalScrolling) {\n      return;\n    }\n    let scrollWidth = 0;\n    for (const item of this.items) {\n      if (typeof item.width !== 'undefined') {\n        scrollWidth = Math.max(scrollWidth, item.width);\n      }\n    }\n    this.scrollWidth = scrollWidth;\n    this.scrollableElement.setScrollDimensions({\n      scrollWidth: scrollWidth === 0 ? 0 : scrollWidth + 10\n    });\n  }\n  rerender() {\n    if (!this.supportDynamicHeights) {\n      return;\n    }\n    for (const item of this.items) {\n      item.lastDynamicHeightWidth = undefined;\n    }\n    this._rerender(this.lastRenderTop, this.lastRenderHeight);\n  }\n  get length() {\n    return this.items.length;\n  }\n  get renderHeight() {\n    const scrollDimensions = this.scrollableElement.getScrollDimensions();\n    return scrollDimensions.height;\n  }\n  element(index) {\n    return this.items[index].element;\n  }\n  domElement(index) {\n    const row = this.items[index].row;\n    return row && row.domNode;\n  }\n  elementHeight(index) {\n    return this.items[index].size;\n  }\n  elementTop(index) {\n    return this.rangeMap.positionAt(index);\n  }\n  indexAt(position) {\n    return this.rangeMap.indexAt(position);\n  }\n  indexAfter(position) {\n    return this.rangeMap.indexAfter(position);\n  }\n  layout(height, width) {\n    let scrollDimensions = {\n      height: typeof height === 'number' ? height : getContentHeight(this.domNode)\n    };\n    if (this.scrollableElementUpdateDisposable) {\n      this.scrollableElementUpdateDisposable.dispose();\n      this.scrollableElementUpdateDisposable = null;\n      scrollDimensions.scrollHeight = this.scrollHeight;\n    }\n    this.scrollableElement.setScrollDimensions(scrollDimensions);\n    if (typeof width !== 'undefined') {\n      this.renderWidth = width;\n      if (this.supportDynamicHeights) {\n        this._rerender(this.scrollTop, this.renderHeight);\n      }\n      if (this.horizontalScrolling) {\n        this.scrollableElement.setScrollDimensions({\n          width: typeof width === 'number' ? width : getContentWidth(this.domNode)\n        });\n      }\n    }\n  }\n  // Render\n  render(previousRenderRange, renderTop, renderHeight, renderLeft, scrollWidth) {\n    let updateItemsInDOM = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n    const renderRange = this.getRenderRange(renderTop, renderHeight);\n    const rangesToInsert = Range.relativeComplement(renderRange, previousRenderRange);\n    const rangesToRemove = Range.relativeComplement(previousRenderRange, renderRange);\n    const beforeElement = this.getNextToLastElement(rangesToInsert);\n    if (updateItemsInDOM) {\n      const rangesToUpdate = Range.intersect(previousRenderRange, renderRange);\n      for (let i = rangesToUpdate.start; i < rangesToUpdate.end; i++) {\n        this.updateItemInDOM(this.items[i], i);\n      }\n    }\n    for (const range of rangesToInsert) {\n      for (let i = range.start; i < range.end; i++) {\n        this.insertItemInDOM(i, beforeElement);\n      }\n    }\n    for (const range of rangesToRemove) {\n      for (let i = range.start; i < range.end; i++) {\n        this.removeItemFromDOM(i);\n      }\n    }\n    if (renderLeft !== undefined) {\n      this.rowsContainer.style.left = \"-\".concat(renderLeft, \"px\");\n    }\n    this.rowsContainer.style.top = \"-\".concat(renderTop, \"px\");\n    if (this.horizontalScrolling && scrollWidth !== undefined) {\n      this.rowsContainer.style.width = \"\".concat(Math.max(scrollWidth, this.renderWidth), \"px\");\n    }\n    this.lastRenderTop = renderTop;\n    this.lastRenderHeight = renderHeight;\n  }\n  // DOM operations\n  insertItemInDOM(index, beforeElement, row) {\n    const item = this.items[index];\n    if (!item.row) {\n      item.row = row !== null && row !== void 0 ? row : this.cache.alloc(item.templateId);\n    }\n    const role = this.accessibilityProvider.getRole(item.element) || 'listitem';\n    item.row.domNode.setAttribute('role', role);\n    const checked = this.accessibilityProvider.isChecked(item.element);\n    if (typeof checked !== 'undefined') {\n      item.row.domNode.setAttribute('aria-checked', String(!!checked));\n    }\n    if (!item.row.domNode.parentElement) {\n      if (beforeElement) {\n        this.rowsContainer.insertBefore(item.row.domNode, beforeElement);\n      } else {\n        this.rowsContainer.appendChild(item.row.domNode);\n      }\n    }\n    this.updateItemInDOM(item, index);\n    const renderer = this.renderers.get(item.templateId);\n    if (!renderer) {\n      throw new Error(\"No renderer found for template id \".concat(item.templateId));\n    }\n    if (renderer) {\n      renderer.renderElement(item.element, index, item.row.templateData, item.size);\n    }\n    const uri = this.dnd.getDragURI(item.element);\n    item.dragStartDisposable.dispose();\n    item.row.domNode.draggable = !!uri;\n    if (uri) {\n      const onDragStart = domEvent(item.row.domNode, 'dragstart');\n      item.dragStartDisposable = onDragStart(event => this.onDragStart(item.element, uri, event));\n    }\n    if (this.horizontalScrolling) {\n      this.measureItemWidth(item);\n      this.eventuallyUpdateScrollWidth();\n    }\n  }\n  measureItemWidth(item) {\n    if (!item.row || !item.row.domNode) {\n      return;\n    }\n    item.row.domNode.style.width = isFirefox ? '-moz-fit-content' : 'fit-content';\n    item.width = getContentWidth(item.row.domNode);\n    const style = window.getComputedStyle(item.row.domNode);\n    if (style.paddingLeft) {\n      item.width += parseFloat(style.paddingLeft);\n    }\n    if (style.paddingRight) {\n      item.width += parseFloat(style.paddingRight);\n    }\n    item.row.domNode.style.width = '';\n  }\n  updateItemInDOM(item, index) {\n    item.row.domNode.style.top = \"\".concat(this.elementTop(index), \"px\");\n    if (this.setRowHeight) {\n      item.row.domNode.style.height = \"\".concat(item.size, \"px\");\n    }\n    if (this.setRowLineHeight) {\n      item.row.domNode.style.lineHeight = \"\".concat(item.size, \"px\");\n    }\n    item.row.domNode.setAttribute('data-index', \"\".concat(index));\n    item.row.domNode.setAttribute('data-last-element', index === this.length - 1 ? 'true' : 'false');\n    item.row.domNode.setAttribute('aria-setsize', String(this.accessibilityProvider.getSetSize(item.element, index, this.length)));\n    item.row.domNode.setAttribute('aria-posinset', String(this.accessibilityProvider.getPosInSet(item.element, index)));\n    item.row.domNode.setAttribute('id', this.getElementDomId(index));\n    item.row.domNode.classList.toggle('drop-target', item.dropTarget);\n  }\n  removeItemFromDOM(index) {\n    const item = this.items[index];\n    item.dragStartDisposable.dispose();\n    if (item.row) {\n      const renderer = this.renderers.get(item.templateId);\n      if (renderer && renderer.disposeElement) {\n        renderer.disposeElement(item.element, index, item.row.templateData, item.size);\n      }\n      this.cache.release(item.row);\n      item.row = null;\n    }\n    if (this.horizontalScrolling) {\n      this.eventuallyUpdateScrollWidth();\n    }\n  }\n  getScrollTop() {\n    const scrollPosition = this.scrollableElement.getScrollPosition();\n    return scrollPosition.scrollTop;\n  }\n  setScrollTop(scrollTop, reuseAnimation) {\n    if (this.scrollableElementUpdateDisposable) {\n      this.scrollableElementUpdateDisposable.dispose();\n      this.scrollableElementUpdateDisposable = null;\n      this.scrollableElement.setScrollDimensions({\n        scrollHeight: this.scrollHeight\n      });\n    }\n    this.scrollableElement.setScrollPosition({\n      scrollTop,\n      reuseAnimation\n    });\n  }\n  get scrollTop() {\n    return this.getScrollTop();\n  }\n  set scrollTop(scrollTop) {\n    this.setScrollTop(scrollTop);\n  }\n  get scrollHeight() {\n    return this._scrollHeight + (this.horizontalScrolling ? 10 : 0) + this.additionalScrollHeight;\n  }\n  // Events\n  get onMouseClick() {\n    return Event.map(domEvent(this.domNode, 'click'), e => this.toMouseEvent(e));\n  }\n  get onMouseDblClick() {\n    return Event.map(domEvent(this.domNode, 'dblclick'), e => this.toMouseEvent(e));\n  }\n  get onMouseMiddleClick() {\n    return Event.filter(Event.map(domEvent(this.domNode, 'auxclick'), e => this.toMouseEvent(e)), e => e.browserEvent.button === 1);\n  }\n  get onMouseDown() {\n    return Event.map(domEvent(this.domNode, 'mousedown'), e => this.toMouseEvent(e));\n  }\n  get onContextMenu() {\n    return Event.map(domEvent(this.domNode, 'contextmenu'), e => this.toMouseEvent(e));\n  }\n  get onTouchStart() {\n    return Event.map(domEvent(this.domNode, 'touchstart'), e => this.toTouchEvent(e));\n  }\n  get onTap() {\n    return Event.map(domEvent(this.rowsContainer, TouchEventType.Tap), e => this.toGestureEvent(e));\n  }\n  toMouseEvent(browserEvent) {\n    const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n    const item = typeof index === 'undefined' ? undefined : this.items[index];\n    const element = item && item.element;\n    return {\n      browserEvent,\n      index,\n      element\n    };\n  }\n  toTouchEvent(browserEvent) {\n    const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n    const item = typeof index === 'undefined' ? undefined : this.items[index];\n    const element = item && item.element;\n    return {\n      browserEvent,\n      index,\n      element\n    };\n  }\n  toGestureEvent(browserEvent) {\n    const index = this.getItemIndexFromEventTarget(browserEvent.initialTarget || null);\n    const item = typeof index === 'undefined' ? undefined : this.items[index];\n    const element = item && item.element;\n    return {\n      browserEvent,\n      index,\n      element\n    };\n  }\n  toDragEvent(browserEvent) {\n    const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n    const item = typeof index === 'undefined' ? undefined : this.items[index];\n    const element = item && item.element;\n    return {\n      browserEvent,\n      index,\n      element\n    };\n  }\n  onScroll(e) {\n    try {\n      const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n      this.render(previousRenderRange, e.scrollTop, e.height, e.scrollLeft, e.scrollWidth);\n      if (this.supportDynamicHeights) {\n        this._rerender(e.scrollTop, e.height, e.inSmoothScrolling);\n      }\n    } catch (err) {\n      console.error('Got bad scroll event:', e);\n      throw err;\n    }\n  }\n  onTouchChange(event) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.scrollTop -= event.translationY;\n  }\n  // DND\n  onDragStart(element, uri, event) {\n    if (!event.dataTransfer) {\n      return;\n    }\n    const elements = this.dnd.getDragElements(element);\n    event.dataTransfer.effectAllowed = 'copyMove';\n    event.dataTransfer.setData(DataTransfers.RESOURCES, JSON.stringify([uri]));\n    if (event.dataTransfer.setDragImage) {\n      let label;\n      if (this.dnd.getDragLabel) {\n        label = this.dnd.getDragLabel(elements, event);\n      }\n      if (typeof label === 'undefined') {\n        label = String(elements.length);\n      }\n      const dragImage = $('.monaco-drag-image');\n      dragImage.textContent = label;\n      document.body.appendChild(dragImage);\n      event.dataTransfer.setDragImage(dragImage, -10, -10);\n      setTimeout(() => document.body.removeChild(dragImage), 0);\n    }\n    this.currentDragData = new ElementsDragAndDropData(elements);\n    StaticDND.CurrentDragAndDropData = new ExternalElementsDragAndDropData(elements);\n    if (this.dnd.onDragStart) {\n      this.dnd.onDragStart(this.currentDragData, event);\n    }\n  }\n  onDragOver(event) {\n    event.browserEvent.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\n    this.onDragLeaveTimeout.dispose();\n    if (StaticDND.CurrentDragAndDropData && StaticDND.CurrentDragAndDropData.getData() === 'vscode-ui') {\n      return false;\n    }\n    this.setupDragAndDropScrollTopAnimation(event.browserEvent);\n    if (!event.browserEvent.dataTransfer) {\n      return false;\n    }\n    // Drag over from outside\n    if (!this.currentDragData) {\n      if (StaticDND.CurrentDragAndDropData) {\n        // Drag over from another list\n        this.currentDragData = StaticDND.CurrentDragAndDropData;\n      } else {\n        // Drag over from the desktop\n        if (!event.browserEvent.dataTransfer.types) {\n          return false;\n        }\n        this.currentDragData = new NativeDragAndDropData();\n      }\n    }\n    const result = this.dnd.onDragOver(this.currentDragData, event.element, event.index, event.browserEvent);\n    this.canDrop = typeof result === 'boolean' ? result : result.accept;\n    if (!this.canDrop) {\n      this.currentDragFeedback = undefined;\n      this.currentDragFeedbackDisposable.dispose();\n      return false;\n    }\n    event.browserEvent.dataTransfer.dropEffect = typeof result !== 'boolean' && result.effect === 0 /* Copy */ ? 'copy' : 'move';\n    let feedback;\n    if (typeof result !== 'boolean' && result.feedback) {\n      feedback = result.feedback;\n    } else {\n      if (typeof event.index === 'undefined') {\n        feedback = [-1];\n      } else {\n        feedback = [event.index];\n      }\n    }\n    // sanitize feedback list\n    feedback = distinct(feedback).filter(i => i >= -1 && i < this.length).sort((a, b) => a - b);\n    feedback = feedback[0] === -1 ? [-1] : feedback;\n    if (equalsDragFeedback(this.currentDragFeedback, feedback)) {\n      return true;\n    }\n    this.currentDragFeedback = feedback;\n    this.currentDragFeedbackDisposable.dispose();\n    if (feedback[0] === -1) {\n      // entire list feedback\n      this.domNode.classList.add('drop-target');\n      this.rowsContainer.classList.add('drop-target');\n      this.currentDragFeedbackDisposable = toDisposable(() => {\n        this.domNode.classList.remove('drop-target');\n        this.rowsContainer.classList.remove('drop-target');\n      });\n    } else {\n      for (const index of feedback) {\n        const item = this.items[index];\n        item.dropTarget = true;\n        if (item.row) {\n          item.row.domNode.classList.add('drop-target');\n        }\n      }\n      this.currentDragFeedbackDisposable = toDisposable(() => {\n        for (const index of feedback) {\n          const item = this.items[index];\n          item.dropTarget = false;\n          if (item.row) {\n            item.row.domNode.classList.remove('drop-target');\n          }\n        }\n      });\n    }\n    return true;\n  }\n  onDragLeave() {\n    this.onDragLeaveTimeout.dispose();\n    this.onDragLeaveTimeout = disposableTimeout(() => this.clearDragOverFeedback(), 100);\n  }\n  onDrop(event) {\n    if (!this.canDrop) {\n      return;\n    }\n    const dragData = this.currentDragData;\n    this.teardownDragAndDropScrollTopAnimation();\n    this.clearDragOverFeedback();\n    this.currentDragData = undefined;\n    StaticDND.CurrentDragAndDropData = undefined;\n    if (!dragData || !event.browserEvent.dataTransfer) {\n      return;\n    }\n    event.browserEvent.preventDefault();\n    dragData.update(event.browserEvent.dataTransfer);\n    this.dnd.drop(dragData, event.element, event.index, event.browserEvent);\n  }\n  onDragEnd(event) {\n    this.canDrop = false;\n    this.teardownDragAndDropScrollTopAnimation();\n    this.clearDragOverFeedback();\n    this.currentDragData = undefined;\n    StaticDND.CurrentDragAndDropData = undefined;\n    if (this.dnd.onDragEnd) {\n      this.dnd.onDragEnd(event);\n    }\n  }\n  clearDragOverFeedback() {\n    this.currentDragFeedback = undefined;\n    this.currentDragFeedbackDisposable.dispose();\n    this.currentDragFeedbackDisposable = Disposable.None;\n  }\n  // DND scroll top animation\n  setupDragAndDropScrollTopAnimation(event) {\n    if (!this.dragOverAnimationDisposable) {\n      const viewTop = getTopLeftOffset(this.domNode).top;\n      this.dragOverAnimationDisposable = animate(this.animateDragAndDropScrollTop.bind(this, viewTop));\n    }\n    this.dragOverAnimationStopDisposable.dispose();\n    this.dragOverAnimationStopDisposable = disposableTimeout(() => {\n      if (this.dragOverAnimationDisposable) {\n        this.dragOverAnimationDisposable.dispose();\n        this.dragOverAnimationDisposable = undefined;\n      }\n    }, 1000);\n    this.dragOverMouseY = event.pageY;\n  }\n  animateDragAndDropScrollTop(viewTop) {\n    if (this.dragOverMouseY === undefined) {\n      return;\n    }\n    const diff = this.dragOverMouseY - viewTop;\n    const upperLimit = this.renderHeight - 35;\n    if (diff < 35) {\n      this.scrollTop += Math.max(-14, Math.floor(0.3 * (diff - 35)));\n    } else if (diff > upperLimit) {\n      this.scrollTop += Math.min(14, Math.floor(0.3 * (diff - upperLimit)));\n    }\n  }\n  teardownDragAndDropScrollTopAnimation() {\n    this.dragOverAnimationStopDisposable.dispose();\n    if (this.dragOverAnimationDisposable) {\n      this.dragOverAnimationDisposable.dispose();\n      this.dragOverAnimationDisposable = undefined;\n    }\n  }\n  // Util\n  getItemIndexFromEventTarget(target) {\n    const scrollableElement = this.scrollableElement.getDomNode();\n    let element = target;\n    while (element instanceof HTMLElement && element !== this.rowsContainer && scrollableElement.contains(element)) {\n      const rawIndex = element.getAttribute('data-index');\n      if (rawIndex) {\n        const index = Number(rawIndex);\n        if (!isNaN(index)) {\n          return index;\n        }\n      }\n      element = element.parentElement;\n    }\n    return undefined;\n  }\n  getRenderRange(renderTop, renderHeight) {\n    return {\n      start: this.rangeMap.indexAt(renderTop),\n      end: this.rangeMap.indexAfter(renderTop + renderHeight - 1)\n    };\n  }\n  /**\r\n   * Given a stable rendered state, checks every rendered element whether it needs\r\n   * to be probed for dynamic height. Adjusts scroll height and top if necessary.\r\n   */\n  _rerender(renderTop, renderHeight, inSmoothScrolling) {\n    const previousRenderRange = this.getRenderRange(renderTop, renderHeight);\n    // Let's remember the second element's position, this helps in scrolling up\n    // and preserving a linear upwards scroll movement\n    let anchorElementIndex;\n    let anchorElementTopDelta;\n    if (renderTop === this.elementTop(previousRenderRange.start)) {\n      anchorElementIndex = previousRenderRange.start;\n      anchorElementTopDelta = 0;\n    } else if (previousRenderRange.end - previousRenderRange.start > 1) {\n      anchorElementIndex = previousRenderRange.start + 1;\n      anchorElementTopDelta = this.elementTop(anchorElementIndex) - renderTop;\n    }\n    let heightDiff = 0;\n    while (true) {\n      const renderRange = this.getRenderRange(renderTop, renderHeight);\n      let didChange = false;\n      for (let i = renderRange.start; i < renderRange.end; i++) {\n        const diff = this.probeDynamicHeight(i);\n        if (diff !== 0) {\n          this.rangeMap.splice(i, 1, [this.items[i]]);\n        }\n        heightDiff += diff;\n        didChange = didChange || diff !== 0;\n      }\n      if (!didChange) {\n        if (heightDiff !== 0) {\n          this.eventuallyUpdateScrollDimensions();\n        }\n        const unrenderRanges = Range.relativeComplement(previousRenderRange, renderRange);\n        for (const range of unrenderRanges) {\n          for (let i = range.start; i < range.end; i++) {\n            if (this.items[i].row) {\n              this.removeItemFromDOM(i);\n            }\n          }\n        }\n        const renderRanges = Range.relativeComplement(renderRange, previousRenderRange);\n        for (const range of renderRanges) {\n          for (let i = range.start; i < range.end; i++) {\n            const afterIndex = i + 1;\n            const beforeRow = afterIndex < this.items.length ? this.items[afterIndex].row : null;\n            const beforeElement = beforeRow ? beforeRow.domNode : null;\n            this.insertItemInDOM(i, beforeElement);\n          }\n        }\n        for (let i = renderRange.start; i < renderRange.end; i++) {\n          if (this.items[i].row) {\n            this.updateItemInDOM(this.items[i], i);\n          }\n        }\n        if (typeof anchorElementIndex === 'number') {\n          // To compute a destination scroll top, we need to take into account the current smooth scrolling\n          // animation, and then reuse it with a new target (to avoid prolonging the scroll)\n          // See https://github.com/microsoft/vscode/issues/104144\n          // See https://github.com/microsoft/vscode/pull/104284\n          // See https://github.com/microsoft/vscode/issues/107704\n          const deltaScrollTop = this.scrollable.getFutureScrollPosition().scrollTop - renderTop;\n          const newScrollTop = this.elementTop(anchorElementIndex) - anchorElementTopDelta + deltaScrollTop;\n          this.setScrollTop(newScrollTop, inSmoothScrolling);\n        }\n        this._onDidChangeContentHeight.fire(this.contentHeight);\n        return;\n      }\n    }\n  }\n  probeDynamicHeight(index) {\n    const item = this.items[index];\n    if (!item.hasDynamicHeight || item.lastDynamicHeightWidth === this.renderWidth) {\n      return 0;\n    }\n    if (!!this.virtualDelegate.hasDynamicHeight && !this.virtualDelegate.hasDynamicHeight(item.element)) {\n      return 0;\n    }\n    const size = item.size;\n    if (!this.setRowHeight && item.row) {\n      let newSize = item.row.domNode.offsetHeight;\n      item.size = newSize;\n      item.lastDynamicHeightWidth = this.renderWidth;\n      return newSize - size;\n    }\n    const row = this.cache.alloc(item.templateId);\n    row.domNode.style.height = '';\n    this.rowsContainer.appendChild(row.domNode);\n    const renderer = this.renderers.get(item.templateId);\n    if (renderer) {\n      renderer.renderElement(item.element, index, row.templateData, undefined);\n      if (renderer.disposeElement) {\n        renderer.disposeElement(item.element, index, row.templateData, undefined);\n      }\n    }\n    item.size = row.domNode.offsetHeight;\n    if (this.virtualDelegate.setDynamicHeight) {\n      this.virtualDelegate.setDynamicHeight(item.element, item.size);\n    }\n    item.lastDynamicHeightWidth = this.renderWidth;\n    this.rowsContainer.removeChild(row.domNode);\n    this.cache.release(row);\n    return item.size - size;\n  }\n  getNextToLastElement(ranges) {\n    const lastRange = ranges[ranges.length - 1];\n    if (!lastRange) {\n      return null;\n    }\n    const nextToLastItem = this.items[lastRange.end];\n    if (!nextToLastItem) {\n      return null;\n    }\n    if (!nextToLastItem.row) {\n      return null;\n    }\n    return nextToLastItem.row.domNode;\n  }\n  getElementDomId(index) {\n    return \"\".concat(this.domId, \"_\").concat(index);\n  }\n  // Dispose\n  dispose() {\n    if (this.items) {\n      for (const item of this.items) {\n        if (item.row) {\n          const renderer = this.renderers.get(item.row.templateId);\n          if (renderer) {\n            if (renderer.disposeElement) {\n              renderer.disposeElement(item.element, -1, item.row.templateData, undefined);\n            }\n            renderer.disposeTemplate(item.row.templateData);\n          }\n        }\n      }\n      this.items = [];\n    }\n    if (this.domNode && this.domNode.parentNode) {\n      this.domNode.parentNode.removeChild(this.domNode);\n    }\n    dispose(this.disposables);\n  }\n}\nListView.InstanceCount = 0;\n__decorate([memoize], ListView.prototype, \"onMouseClick\", null);\n__decorate([memoize], ListView.prototype, \"onMouseDblClick\", null);\n__decorate([memoize], ListView.prototype, \"onMouseMiddleClick\", null);\n__decorate([memoize], ListView.prototype, \"onMouseDown\", null);\n__decorate([memoize], ListView.prototype, \"onContextMenu\", null);\n__decorate([memoize], ListView.prototype, \"onTouchStart\", null);\n__decorate([memoize], ListView.prototype, \"onTap\", null);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","getOrDefault","dispose","Disposable","toDisposable","DisposableStore","Gesture","EventType","TouchEventType","Event","Emitter","domEvent","SmoothScrollableElement","Scrollable","RangeMap","shift","RowCache","memoize","Range","equals","distinct","DataTransfers","StaticDND","disposableTimeout","Delayer","isFirefox","$","animate","getContentHeight","getContentWidth","getTopLeftOffset","scheduleAtNextAnimationFrame","DefaultOptions","useShadows","verticalScrollMode","setRowLineHeight","setRowHeight","supportDynamicHeights","dnd","getDragElements","e","getDragURI","onDragStart","onDragOver","drop","horizontalScrolling","transformOptimization","ElementsDragAndDropData","constructor","elements","update","getData","ExternalElementsDragAndDropData","NativeDragAndDropData","types","files","dataTransfer","splice","file","item","size","type","push","equalsDragFeedback","f1","f2","Array","isArray","ListViewAccessibilityProvider","accessibilityProvider","getSetSize","bind","l","getPosInSet","getRole","_","isChecked","undefined","ListView","container","virtualDelegate","renderers","options","domId","concat","InstanceCount","Map","renderWidth","_scrollHeight","scrollableElementUpdateDisposable","scrollableElementWidthDelayer","splicing","dragOverAnimationStopDisposable","None","dragOverMouseY","canDrop","currentDragFeedbackDisposable","onDragLeaveTimeout","disposables","_onDidChangeContentHeight","_horizontalScrolling","Error","items","itemId","rangeMap","renderer","set","templateId","cache","add","lastRenderTop","lastRenderHeight","domNode","document","createElement","className","classList","tabIndex","toggle","mouseSupport","o","additionalScrollHeight","rowsContainer","style","transform","addTarget","scrollable","smoothScrolling","cb","scrollableElement","horizontal","vertical","appendChild","getDomNode","onScroll","Change","onTouchChange","scrollTop","map","toDragEvent","onDrop","onDragLeave","window","onDragEnd","layout","contentHeight","value","measureItemWidth","updateScrollWidth","setScrollDimensions","width","Math","max","scrollWidth","cancel","updateOptions","setSmoothScrollDuration","start","deleteCount","_splice","fire","previousRenderRange","getRenderRange","deleteRange","end","removeRange","intersect","rowsToDispose","dragStartDisposable","row","rows","get","element","previousRestRange","previousRenderedRestRange","previousUnrenderedRestRanges","relativeComplement","inserted","id","String","getTemplateId","getHeight","hasDynamicHeight","lastDynamicHeightWidth","uri","dropTarget","deleted","delta","renderRange","renderedRestRange","updateRange","updateItemInDOM","removeRanges","range","removeItemFromDOM","unrenderedRestRanges","elementsRange","insertRanges","beforeElement","getNextToLastElement","rowData","pop","insertItemInDOM","index","disposeElement","templateData","release","eventuallyUpdateScrollDimensions","_rerender","renderHeight","height","scrollHeight","eventuallyUpdateScrollWidth","trigger","rerender","scrollDimensions","getScrollDimensions","domElement","elementHeight","elementTop","positionAt","indexAt","position","indexAfter","render","renderTop","renderLeft","updateItemsInDOM","rangesToInsert","rangesToRemove","rangesToUpdate","left","top","alloc","role","setAttribute","checked","parentElement","insertBefore","renderElement","draggable","event","getComputedStyle","paddingLeft","parseFloat","paddingRight","lineHeight","getElementDomId","getScrollTop","scrollPosition","getScrollPosition","setScrollTop","reuseAnimation","setScrollPosition","onMouseClick","toMouseEvent","onMouseDblClick","onMouseMiddleClick","filter","browserEvent","button","onMouseDown","onContextMenu","onTouchStart","toTouchEvent","onTap","Tap","toGestureEvent","getItemIndexFromEventTarget","initialTarget","scrollLeft","inSmoothScrolling","err","console","error","preventDefault","stopPropagation","translationY","effectAllowed","setData","RESOURCES","JSON","stringify","setDragImage","label","getDragLabel","dragImage","textContent","body","setTimeout","removeChild","currentDragData","CurrentDragAndDropData","setupDragAndDropScrollTopAnimation","result","accept","currentDragFeedback","dropEffect","effect","feedback","sort","a","b","remove","clearDragOverFeedback","dragData","teardownDragAndDropScrollTopAnimation","dragOverAnimationDisposable","viewTop","animateDragAndDropScrollTop","pageY","diff","upperLimit","floor","min","HTMLElement","contains","rawIndex","getAttribute","Number","isNaN","anchorElementIndex","anchorElementTopDelta","heightDiff","didChange","probeDynamicHeight","unrenderRanges","renderRanges","afterIndex","beforeRow","deltaScrollTop","getFutureScrollPosition","newScrollTop","newSize","offsetHeight","setDynamicHeight","ranges","lastRange","nextToLastItem","disposeTemplate","parentNode","prototype"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listView.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport { getOrDefault } from '../../../common/objects.js';\r\nimport { dispose, Disposable, toDisposable, DisposableStore } from '../../../common/lifecycle.js';\r\nimport { Gesture, EventType as TouchEventType } from '../../touch.js';\r\nimport { Event, Emitter } from '../../../common/event.js';\r\nimport { domEvent } from '../../event.js';\r\nimport { SmoothScrollableElement } from '../scrollbar/scrollableElement.js';\r\nimport { Scrollable } from '../../../common/scrollable.js';\r\nimport { RangeMap, shift } from './rangeMap.js';\r\nimport { RowCache } from './rowCache.js';\r\nimport { memoize } from '../../../common/decorators.js';\r\nimport { Range } from '../../../common/range.js';\r\nimport { equals, distinct } from '../../../common/arrays.js';\r\nimport { DataTransfers, StaticDND } from '../../dnd.js';\r\nimport { disposableTimeout, Delayer } from '../../../common/async.js';\r\nimport { isFirefox } from '../../browser.js';\r\nimport { $, animate, getContentHeight, getContentWidth, getTopLeftOffset, scheduleAtNextAnimationFrame } from '../../dom.js';\r\nconst DefaultOptions = {\r\n    useShadows: true,\r\n    verticalScrollMode: 1 /* Auto */,\r\n    setRowLineHeight: true,\r\n    setRowHeight: true,\r\n    supportDynamicHeights: false,\r\n    dnd: {\r\n        getDragElements(e) { return [e]; },\r\n        getDragURI() { return null; },\r\n        onDragStart() { },\r\n        onDragOver() { return false; },\r\n        drop() { }\r\n    },\r\n    horizontalScrolling: false,\r\n    transformOptimization: true\r\n};\r\nexport class ElementsDragAndDropData {\r\n    constructor(elements) {\r\n        this.elements = elements;\r\n    }\r\n    update() { }\r\n    getData() {\r\n        return this.elements;\r\n    }\r\n}\r\nexport class ExternalElementsDragAndDropData {\r\n    constructor(elements) {\r\n        this.elements = elements;\r\n    }\r\n    update() { }\r\n    getData() {\r\n        return this.elements;\r\n    }\r\n}\r\nexport class NativeDragAndDropData {\r\n    constructor() {\r\n        this.types = [];\r\n        this.files = [];\r\n    }\r\n    update(dataTransfer) {\r\n        if (dataTransfer.types) {\r\n            this.types.splice(0, this.types.length, ...dataTransfer.types);\r\n        }\r\n        if (dataTransfer.files) {\r\n            this.files.splice(0, this.files.length);\r\n            for (let i = 0; i < dataTransfer.files.length; i++) {\r\n                const file = dataTransfer.files.item(i);\r\n                if (file && (file.size || file.type)) {\r\n                    this.files.push(file);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    getData() {\r\n        return {\r\n            types: this.types,\r\n            files: this.files\r\n        };\r\n    }\r\n}\r\nfunction equalsDragFeedback(f1, f2) {\r\n    if (Array.isArray(f1) && Array.isArray(f2)) {\r\n        return equals(f1, f2);\r\n    }\r\n    return f1 === f2;\r\n}\r\nclass ListViewAccessibilityProvider {\r\n    constructor(accessibilityProvider) {\r\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getSetSize) {\r\n            this.getSetSize = accessibilityProvider.getSetSize.bind(accessibilityProvider);\r\n        }\r\n        else {\r\n            this.getSetSize = (e, i, l) => l;\r\n        }\r\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getPosInSet) {\r\n            this.getPosInSet = accessibilityProvider.getPosInSet.bind(accessibilityProvider);\r\n        }\r\n        else {\r\n            this.getPosInSet = (e, i) => i + 1;\r\n        }\r\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getRole) {\r\n            this.getRole = accessibilityProvider.getRole.bind(accessibilityProvider);\r\n        }\r\n        else {\r\n            this.getRole = _ => 'listitem';\r\n        }\r\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.isChecked) {\r\n            this.isChecked = accessibilityProvider.isChecked.bind(accessibilityProvider);\r\n        }\r\n        else {\r\n            this.isChecked = _ => undefined;\r\n        }\r\n    }\r\n}\r\nexport class ListView {\r\n    constructor(container, virtualDelegate, renderers, options = DefaultOptions) {\r\n        this.virtualDelegate = virtualDelegate;\r\n        this.domId = `list_id_${++ListView.InstanceCount}`;\r\n        this.renderers = new Map();\r\n        this.renderWidth = 0;\r\n        this._scrollHeight = 0;\r\n        this.scrollableElementUpdateDisposable = null;\r\n        this.scrollableElementWidthDelayer = new Delayer(50);\r\n        this.splicing = false;\r\n        this.dragOverAnimationStopDisposable = Disposable.None;\r\n        this.dragOverMouseY = 0;\r\n        this.canDrop = false;\r\n        this.currentDragFeedbackDisposable = Disposable.None;\r\n        this.onDragLeaveTimeout = Disposable.None;\r\n        this.disposables = new DisposableStore();\r\n        this._onDidChangeContentHeight = new Emitter();\r\n        this._horizontalScrolling = false;\r\n        if (options.horizontalScrolling && options.supportDynamicHeights) {\r\n            throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\r\n        }\r\n        this.items = [];\r\n        this.itemId = 0;\r\n        this.rangeMap = new RangeMap();\r\n        for (const renderer of renderers) {\r\n            this.renderers.set(renderer.templateId, renderer);\r\n        }\r\n        this.cache = this.disposables.add(new RowCache(this.renderers));\r\n        this.lastRenderTop = 0;\r\n        this.lastRenderHeight = 0;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.className = 'monaco-list';\r\n        this.domNode.classList.add(this.domId);\r\n        this.domNode.tabIndex = 0;\r\n        this.domNode.classList.toggle('mouse-support', typeof options.mouseSupport === 'boolean' ? options.mouseSupport : true);\r\n        this._horizontalScrolling = getOrDefault(options, o => o.horizontalScrolling, DefaultOptions.horizontalScrolling);\r\n        this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\r\n        this.additionalScrollHeight = typeof options.additionalScrollHeight === 'undefined' ? 0 : options.additionalScrollHeight;\r\n        this.accessibilityProvider = new ListViewAccessibilityProvider(options.accessibilityProvider);\r\n        this.rowsContainer = document.createElement('div');\r\n        this.rowsContainer.className = 'monaco-list-rows';\r\n        const transformOptimization = getOrDefault(options, o => o.transformOptimization, DefaultOptions.transformOptimization);\r\n        if (transformOptimization) {\r\n            this.rowsContainer.style.transform = 'translate3d(0px, 0px, 0px)';\r\n        }\r\n        this.disposables.add(Gesture.addTarget(this.rowsContainer));\r\n        this.scrollable = new Scrollable(getOrDefault(options, o => o.smoothScrolling, false) ? 125 : 0, cb => scheduleAtNextAnimationFrame(cb));\r\n        this.scrollableElement = this.disposables.add(new SmoothScrollableElement(this.rowsContainer, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: getOrDefault(options, o => o.verticalScrollMode, DefaultOptions.verticalScrollMode),\r\n            useShadows: getOrDefault(options, o => o.useShadows, DefaultOptions.useShadows),\r\n        }, this.scrollable));\r\n        this.domNode.appendChild(this.scrollableElement.getDomNode());\r\n        container.appendChild(this.domNode);\r\n        this.scrollableElement.onScroll(this.onScroll, this, this.disposables);\r\n        domEvent(this.rowsContainer, TouchEventType.Change)(this.onTouchChange, this, this.disposables);\r\n        // Prevent the monaco-scrollable-element from scrolling\r\n        // https://github.com/microsoft/vscode/issues/44181\r\n        domEvent(this.scrollableElement.getDomNode(), 'scroll')(e => e.target.scrollTop = 0, null, this.disposables);\r\n        Event.map(domEvent(this.domNode, 'dragover'), e => this.toDragEvent(e))(this.onDragOver, this, this.disposables);\r\n        Event.map(domEvent(this.domNode, 'drop'), e => this.toDragEvent(e))(this.onDrop, this, this.disposables);\r\n        domEvent(this.domNode, 'dragleave')(this.onDragLeave, this, this.disposables);\r\n        domEvent(window, 'dragend')(this.onDragEnd, this, this.disposables);\r\n        this.setRowLineHeight = getOrDefault(options, o => o.setRowLineHeight, DefaultOptions.setRowLineHeight);\r\n        this.setRowHeight = getOrDefault(options, o => o.setRowHeight, DefaultOptions.setRowHeight);\r\n        this.supportDynamicHeights = getOrDefault(options, o => o.supportDynamicHeights, DefaultOptions.supportDynamicHeights);\r\n        this.dnd = getOrDefault(options, o => o.dnd, DefaultOptions.dnd);\r\n        this.layout();\r\n    }\r\n    get contentHeight() { return this.rangeMap.size; }\r\n    get horizontalScrolling() { return this._horizontalScrolling; }\r\n    set horizontalScrolling(value) {\r\n        if (value === this._horizontalScrolling) {\r\n            return;\r\n        }\r\n        if (value && this.supportDynamicHeights) {\r\n            throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\r\n        }\r\n        this._horizontalScrolling = value;\r\n        this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\r\n        if (this._horizontalScrolling) {\r\n            for (const item of this.items) {\r\n                this.measureItemWidth(item);\r\n            }\r\n            this.updateScrollWidth();\r\n            this.scrollableElement.setScrollDimensions({ width: getContentWidth(this.domNode) });\r\n            this.rowsContainer.style.width = `${Math.max(this.scrollWidth || 0, this.renderWidth)}px`;\r\n        }\r\n        else {\r\n            this.scrollableElementWidthDelayer.cancel();\r\n            this.scrollableElement.setScrollDimensions({ width: this.renderWidth, scrollWidth: this.renderWidth });\r\n            this.rowsContainer.style.width = '';\r\n        }\r\n    }\r\n    updateOptions(options) {\r\n        if (options.additionalScrollHeight !== undefined) {\r\n            this.additionalScrollHeight = options.additionalScrollHeight;\r\n        }\r\n        if (options.smoothScrolling !== undefined) {\r\n            this.scrollable.setSmoothScrollDuration(options.smoothScrolling ? 125 : 0);\r\n        }\r\n        if (options.horizontalScrolling !== undefined) {\r\n            this.horizontalScrolling = options.horizontalScrolling;\r\n        }\r\n    }\r\n    splice(start, deleteCount, elements = []) {\r\n        if (this.splicing) {\r\n            throw new Error('Can\\'t run recursive splices.');\r\n        }\r\n        this.splicing = true;\r\n        try {\r\n            return this._splice(start, deleteCount, elements);\r\n        }\r\n        finally {\r\n            this.splicing = false;\r\n            this._onDidChangeContentHeight.fire(this.contentHeight);\r\n        }\r\n    }\r\n    _splice(start, deleteCount, elements = []) {\r\n        const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\r\n        const deleteRange = { start, end: start + deleteCount };\r\n        const removeRange = Range.intersect(previousRenderRange, deleteRange);\r\n        // try to reuse rows, avoid removing them from DOM\r\n        const rowsToDispose = new Map();\r\n        for (let i = removeRange.start; i < removeRange.end; i++) {\r\n            const item = this.items[i];\r\n            item.dragStartDisposable.dispose();\r\n            if (item.row) {\r\n                let rows = rowsToDispose.get(item.templateId);\r\n                if (!rows) {\r\n                    rows = [];\r\n                    rowsToDispose.set(item.templateId, rows);\r\n                }\r\n                rows.push([item.row, item.element, i, item.size]);\r\n            }\r\n            item.row = null;\r\n        }\r\n        const previousRestRange = { start: start + deleteCount, end: this.items.length };\r\n        const previousRenderedRestRange = Range.intersect(previousRestRange, previousRenderRange);\r\n        const previousUnrenderedRestRanges = Range.relativeComplement(previousRestRange, previousRenderRange);\r\n        const inserted = elements.map(element => ({\r\n            id: String(this.itemId++),\r\n            element,\r\n            templateId: this.virtualDelegate.getTemplateId(element),\r\n            size: this.virtualDelegate.getHeight(element),\r\n            width: undefined,\r\n            hasDynamicHeight: !!this.virtualDelegate.hasDynamicHeight && this.virtualDelegate.hasDynamicHeight(element),\r\n            lastDynamicHeightWidth: undefined,\r\n            row: null,\r\n            uri: undefined,\r\n            dropTarget: false,\r\n            dragStartDisposable: Disposable.None\r\n        }));\r\n        let deleted;\r\n        // TODO@joao: improve this optimization to catch even more cases\r\n        if (start === 0 && deleteCount >= this.items.length) {\r\n            this.rangeMap = new RangeMap();\r\n            this.rangeMap.splice(0, 0, inserted);\r\n            this.items = inserted;\r\n            deleted = [];\r\n        }\r\n        else {\r\n            this.rangeMap.splice(start, deleteCount, inserted);\r\n            deleted = this.items.splice(start, deleteCount, ...inserted);\r\n        }\r\n        const delta = elements.length - deleteCount;\r\n        const renderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\r\n        const renderedRestRange = shift(previousRenderedRestRange, delta);\r\n        const updateRange = Range.intersect(renderRange, renderedRestRange);\r\n        for (let i = updateRange.start; i < updateRange.end; i++) {\r\n            this.updateItemInDOM(this.items[i], i);\r\n        }\r\n        const removeRanges = Range.relativeComplement(renderedRestRange, renderRange);\r\n        for (const range of removeRanges) {\r\n            for (let i = range.start; i < range.end; i++) {\r\n                this.removeItemFromDOM(i);\r\n            }\r\n        }\r\n        const unrenderedRestRanges = previousUnrenderedRestRanges.map(r => shift(r, delta));\r\n        const elementsRange = { start, end: start + elements.length };\r\n        const insertRanges = [elementsRange, ...unrenderedRestRanges].map(r => Range.intersect(renderRange, r));\r\n        const beforeElement = this.getNextToLastElement(insertRanges);\r\n        for (const range of insertRanges) {\r\n            for (let i = range.start; i < range.end; i++) {\r\n                const item = this.items[i];\r\n                const rows = rowsToDispose.get(item.templateId);\r\n                const rowData = rows === null || rows === void 0 ? void 0 : rows.pop();\r\n                if (!rowData) {\r\n                    this.insertItemInDOM(i, beforeElement);\r\n                }\r\n                else {\r\n                    const [row, element, index, size] = rowData;\r\n                    const renderer = this.renderers.get(item.templateId);\r\n                    if (renderer && renderer.disposeElement) {\r\n                        renderer.disposeElement(element, index, row.templateData, size);\r\n                    }\r\n                    this.insertItemInDOM(i, beforeElement, row);\r\n                }\r\n            }\r\n        }\r\n        for (const [templateId, rows] of rowsToDispose) {\r\n            for (const [row, element, index, size] of rows) {\r\n                const renderer = this.renderers.get(templateId);\r\n                if (renderer && renderer.disposeElement) {\r\n                    renderer.disposeElement(element, index, row.templateData, size);\r\n                }\r\n                this.cache.release(row);\r\n            }\r\n        }\r\n        this.eventuallyUpdateScrollDimensions();\r\n        if (this.supportDynamicHeights) {\r\n            this._rerender(this.scrollTop, this.renderHeight);\r\n        }\r\n        return deleted.map(i => i.element);\r\n    }\r\n    eventuallyUpdateScrollDimensions() {\r\n        this._scrollHeight = this.contentHeight;\r\n        this.rowsContainer.style.height = `${this._scrollHeight}px`;\r\n        if (!this.scrollableElementUpdateDisposable) {\r\n            this.scrollableElementUpdateDisposable = scheduleAtNextAnimationFrame(() => {\r\n                this.scrollableElement.setScrollDimensions({ scrollHeight: this.scrollHeight });\r\n                this.updateScrollWidth();\r\n                this.scrollableElementUpdateDisposable = null;\r\n            });\r\n        }\r\n    }\r\n    eventuallyUpdateScrollWidth() {\r\n        if (!this.horizontalScrolling) {\r\n            this.scrollableElementWidthDelayer.cancel();\r\n            return;\r\n        }\r\n        this.scrollableElementWidthDelayer.trigger(() => this.updateScrollWidth());\r\n    }\r\n    updateScrollWidth() {\r\n        if (!this.horizontalScrolling) {\r\n            return;\r\n        }\r\n        let scrollWidth = 0;\r\n        for (const item of this.items) {\r\n            if (typeof item.width !== 'undefined') {\r\n                scrollWidth = Math.max(scrollWidth, item.width);\r\n            }\r\n        }\r\n        this.scrollWidth = scrollWidth;\r\n        this.scrollableElement.setScrollDimensions({ scrollWidth: scrollWidth === 0 ? 0 : (scrollWidth + 10) });\r\n    }\r\n    rerender() {\r\n        if (!this.supportDynamicHeights) {\r\n            return;\r\n        }\r\n        for (const item of this.items) {\r\n            item.lastDynamicHeightWidth = undefined;\r\n        }\r\n        this._rerender(this.lastRenderTop, this.lastRenderHeight);\r\n    }\r\n    get length() {\r\n        return this.items.length;\r\n    }\r\n    get renderHeight() {\r\n        const scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n        return scrollDimensions.height;\r\n    }\r\n    element(index) {\r\n        return this.items[index].element;\r\n    }\r\n    domElement(index) {\r\n        const row = this.items[index].row;\r\n        return row && row.domNode;\r\n    }\r\n    elementHeight(index) {\r\n        return this.items[index].size;\r\n    }\r\n    elementTop(index) {\r\n        return this.rangeMap.positionAt(index);\r\n    }\r\n    indexAt(position) {\r\n        return this.rangeMap.indexAt(position);\r\n    }\r\n    indexAfter(position) {\r\n        return this.rangeMap.indexAfter(position);\r\n    }\r\n    layout(height, width) {\r\n        let scrollDimensions = {\r\n            height: typeof height === 'number' ? height : getContentHeight(this.domNode)\r\n        };\r\n        if (this.scrollableElementUpdateDisposable) {\r\n            this.scrollableElementUpdateDisposable.dispose();\r\n            this.scrollableElementUpdateDisposable = null;\r\n            scrollDimensions.scrollHeight = this.scrollHeight;\r\n        }\r\n        this.scrollableElement.setScrollDimensions(scrollDimensions);\r\n        if (typeof width !== 'undefined') {\r\n            this.renderWidth = width;\r\n            if (this.supportDynamicHeights) {\r\n                this._rerender(this.scrollTop, this.renderHeight);\r\n            }\r\n            if (this.horizontalScrolling) {\r\n                this.scrollableElement.setScrollDimensions({\r\n                    width: typeof width === 'number' ? width : getContentWidth(this.domNode)\r\n                });\r\n            }\r\n        }\r\n    }\r\n    // Render\r\n    render(previousRenderRange, renderTop, renderHeight, renderLeft, scrollWidth, updateItemsInDOM = false) {\r\n        const renderRange = this.getRenderRange(renderTop, renderHeight);\r\n        const rangesToInsert = Range.relativeComplement(renderRange, previousRenderRange);\r\n        const rangesToRemove = Range.relativeComplement(previousRenderRange, renderRange);\r\n        const beforeElement = this.getNextToLastElement(rangesToInsert);\r\n        if (updateItemsInDOM) {\r\n            const rangesToUpdate = Range.intersect(previousRenderRange, renderRange);\r\n            for (let i = rangesToUpdate.start; i < rangesToUpdate.end; i++) {\r\n                this.updateItemInDOM(this.items[i], i);\r\n            }\r\n        }\r\n        for (const range of rangesToInsert) {\r\n            for (let i = range.start; i < range.end; i++) {\r\n                this.insertItemInDOM(i, beforeElement);\r\n            }\r\n        }\r\n        for (const range of rangesToRemove) {\r\n            for (let i = range.start; i < range.end; i++) {\r\n                this.removeItemFromDOM(i);\r\n            }\r\n        }\r\n        if (renderLeft !== undefined) {\r\n            this.rowsContainer.style.left = `-${renderLeft}px`;\r\n        }\r\n        this.rowsContainer.style.top = `-${renderTop}px`;\r\n        if (this.horizontalScrolling && scrollWidth !== undefined) {\r\n            this.rowsContainer.style.width = `${Math.max(scrollWidth, this.renderWidth)}px`;\r\n        }\r\n        this.lastRenderTop = renderTop;\r\n        this.lastRenderHeight = renderHeight;\r\n    }\r\n    // DOM operations\r\n    insertItemInDOM(index, beforeElement, row) {\r\n        const item = this.items[index];\r\n        if (!item.row) {\r\n            item.row = row !== null && row !== void 0 ? row : this.cache.alloc(item.templateId);\r\n        }\r\n        const role = this.accessibilityProvider.getRole(item.element) || 'listitem';\r\n        item.row.domNode.setAttribute('role', role);\r\n        const checked = this.accessibilityProvider.isChecked(item.element);\r\n        if (typeof checked !== 'undefined') {\r\n            item.row.domNode.setAttribute('aria-checked', String(!!checked));\r\n        }\r\n        if (!item.row.domNode.parentElement) {\r\n            if (beforeElement) {\r\n                this.rowsContainer.insertBefore(item.row.domNode, beforeElement);\r\n            }\r\n            else {\r\n                this.rowsContainer.appendChild(item.row.domNode);\r\n            }\r\n        }\r\n        this.updateItemInDOM(item, index);\r\n        const renderer = this.renderers.get(item.templateId);\r\n        if (!renderer) {\r\n            throw new Error(`No renderer found for template id ${item.templateId}`);\r\n        }\r\n        if (renderer) {\r\n            renderer.renderElement(item.element, index, item.row.templateData, item.size);\r\n        }\r\n        const uri = this.dnd.getDragURI(item.element);\r\n        item.dragStartDisposable.dispose();\r\n        item.row.domNode.draggable = !!uri;\r\n        if (uri) {\r\n            const onDragStart = domEvent(item.row.domNode, 'dragstart');\r\n            item.dragStartDisposable = onDragStart(event => this.onDragStart(item.element, uri, event));\r\n        }\r\n        if (this.horizontalScrolling) {\r\n            this.measureItemWidth(item);\r\n            this.eventuallyUpdateScrollWidth();\r\n        }\r\n    }\r\n    measureItemWidth(item) {\r\n        if (!item.row || !item.row.domNode) {\r\n            return;\r\n        }\r\n        item.row.domNode.style.width = isFirefox ? '-moz-fit-content' : 'fit-content';\r\n        item.width = getContentWidth(item.row.domNode);\r\n        const style = window.getComputedStyle(item.row.domNode);\r\n        if (style.paddingLeft) {\r\n            item.width += parseFloat(style.paddingLeft);\r\n        }\r\n        if (style.paddingRight) {\r\n            item.width += parseFloat(style.paddingRight);\r\n        }\r\n        item.row.domNode.style.width = '';\r\n    }\r\n    updateItemInDOM(item, index) {\r\n        item.row.domNode.style.top = `${this.elementTop(index)}px`;\r\n        if (this.setRowHeight) {\r\n            item.row.domNode.style.height = `${item.size}px`;\r\n        }\r\n        if (this.setRowLineHeight) {\r\n            item.row.domNode.style.lineHeight = `${item.size}px`;\r\n        }\r\n        item.row.domNode.setAttribute('data-index', `${index}`);\r\n        item.row.domNode.setAttribute('data-last-element', index === this.length - 1 ? 'true' : 'false');\r\n        item.row.domNode.setAttribute('aria-setsize', String(this.accessibilityProvider.getSetSize(item.element, index, this.length)));\r\n        item.row.domNode.setAttribute('aria-posinset', String(this.accessibilityProvider.getPosInSet(item.element, index)));\r\n        item.row.domNode.setAttribute('id', this.getElementDomId(index));\r\n        item.row.domNode.classList.toggle('drop-target', item.dropTarget);\r\n    }\r\n    removeItemFromDOM(index) {\r\n        const item = this.items[index];\r\n        item.dragStartDisposable.dispose();\r\n        if (item.row) {\r\n            const renderer = this.renderers.get(item.templateId);\r\n            if (renderer && renderer.disposeElement) {\r\n                renderer.disposeElement(item.element, index, item.row.templateData, item.size);\r\n            }\r\n            this.cache.release(item.row);\r\n            item.row = null;\r\n        }\r\n        if (this.horizontalScrolling) {\r\n            this.eventuallyUpdateScrollWidth();\r\n        }\r\n    }\r\n    getScrollTop() {\r\n        const scrollPosition = this.scrollableElement.getScrollPosition();\r\n        return scrollPosition.scrollTop;\r\n    }\r\n    setScrollTop(scrollTop, reuseAnimation) {\r\n        if (this.scrollableElementUpdateDisposable) {\r\n            this.scrollableElementUpdateDisposable.dispose();\r\n            this.scrollableElementUpdateDisposable = null;\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: this.scrollHeight });\r\n        }\r\n        this.scrollableElement.setScrollPosition({ scrollTop, reuseAnimation });\r\n    }\r\n    get scrollTop() {\r\n        return this.getScrollTop();\r\n    }\r\n    set scrollTop(scrollTop) {\r\n        this.setScrollTop(scrollTop);\r\n    }\r\n    get scrollHeight() {\r\n        return this._scrollHeight + (this.horizontalScrolling ? 10 : 0) + this.additionalScrollHeight;\r\n    }\r\n    // Events\r\n    get onMouseClick() { return Event.map(domEvent(this.domNode, 'click'), e => this.toMouseEvent(e)); }\r\n    get onMouseDblClick() { return Event.map(domEvent(this.domNode, 'dblclick'), e => this.toMouseEvent(e)); }\r\n    get onMouseMiddleClick() { return Event.filter(Event.map(domEvent(this.domNode, 'auxclick'), e => this.toMouseEvent(e)), e => e.browserEvent.button === 1); }\r\n    get onMouseDown() { return Event.map(domEvent(this.domNode, 'mousedown'), e => this.toMouseEvent(e)); }\r\n    get onContextMenu() { return Event.map(domEvent(this.domNode, 'contextmenu'), e => this.toMouseEvent(e)); }\r\n    get onTouchStart() { return Event.map(domEvent(this.domNode, 'touchstart'), e => this.toTouchEvent(e)); }\r\n    get onTap() { return Event.map(domEvent(this.rowsContainer, TouchEventType.Tap), e => this.toGestureEvent(e)); }\r\n    toMouseEvent(browserEvent) {\r\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\r\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\r\n        const element = item && item.element;\r\n        return { browserEvent, index, element };\r\n    }\r\n    toTouchEvent(browserEvent) {\r\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\r\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\r\n        const element = item && item.element;\r\n        return { browserEvent, index, element };\r\n    }\r\n    toGestureEvent(browserEvent) {\r\n        const index = this.getItemIndexFromEventTarget(browserEvent.initialTarget || null);\r\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\r\n        const element = item && item.element;\r\n        return { browserEvent, index, element };\r\n    }\r\n    toDragEvent(browserEvent) {\r\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\r\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\r\n        const element = item && item.element;\r\n        return { browserEvent, index, element };\r\n    }\r\n    onScroll(e) {\r\n        try {\r\n            const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\r\n            this.render(previousRenderRange, e.scrollTop, e.height, e.scrollLeft, e.scrollWidth);\r\n            if (this.supportDynamicHeights) {\r\n                this._rerender(e.scrollTop, e.height, e.inSmoothScrolling);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.error('Got bad scroll event:', e);\r\n            throw err;\r\n        }\r\n    }\r\n    onTouchChange(event) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        this.scrollTop -= event.translationY;\r\n    }\r\n    // DND\r\n    onDragStart(element, uri, event) {\r\n        if (!event.dataTransfer) {\r\n            return;\r\n        }\r\n        const elements = this.dnd.getDragElements(element);\r\n        event.dataTransfer.effectAllowed = 'copyMove';\r\n        event.dataTransfer.setData(DataTransfers.RESOURCES, JSON.stringify([uri]));\r\n        if (event.dataTransfer.setDragImage) {\r\n            let label;\r\n            if (this.dnd.getDragLabel) {\r\n                label = this.dnd.getDragLabel(elements, event);\r\n            }\r\n            if (typeof label === 'undefined') {\r\n                label = String(elements.length);\r\n            }\r\n            const dragImage = $('.monaco-drag-image');\r\n            dragImage.textContent = label;\r\n            document.body.appendChild(dragImage);\r\n            event.dataTransfer.setDragImage(dragImage, -10, -10);\r\n            setTimeout(() => document.body.removeChild(dragImage), 0);\r\n        }\r\n        this.currentDragData = new ElementsDragAndDropData(elements);\r\n        StaticDND.CurrentDragAndDropData = new ExternalElementsDragAndDropData(elements);\r\n        if (this.dnd.onDragStart) {\r\n            this.dnd.onDragStart(this.currentDragData, event);\r\n        }\r\n    }\r\n    onDragOver(event) {\r\n        event.browserEvent.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\r\n        this.onDragLeaveTimeout.dispose();\r\n        if (StaticDND.CurrentDragAndDropData && StaticDND.CurrentDragAndDropData.getData() === 'vscode-ui') {\r\n            return false;\r\n        }\r\n        this.setupDragAndDropScrollTopAnimation(event.browserEvent);\r\n        if (!event.browserEvent.dataTransfer) {\r\n            return false;\r\n        }\r\n        // Drag over from outside\r\n        if (!this.currentDragData) {\r\n            if (StaticDND.CurrentDragAndDropData) {\r\n                // Drag over from another list\r\n                this.currentDragData = StaticDND.CurrentDragAndDropData;\r\n            }\r\n            else {\r\n                // Drag over from the desktop\r\n                if (!event.browserEvent.dataTransfer.types) {\r\n                    return false;\r\n                }\r\n                this.currentDragData = new NativeDragAndDropData();\r\n            }\r\n        }\r\n        const result = this.dnd.onDragOver(this.currentDragData, event.element, event.index, event.browserEvent);\r\n        this.canDrop = typeof result === 'boolean' ? result : result.accept;\r\n        if (!this.canDrop) {\r\n            this.currentDragFeedback = undefined;\r\n            this.currentDragFeedbackDisposable.dispose();\r\n            return false;\r\n        }\r\n        event.browserEvent.dataTransfer.dropEffect = (typeof result !== 'boolean' && result.effect === 0 /* Copy */) ? 'copy' : 'move';\r\n        let feedback;\r\n        if (typeof result !== 'boolean' && result.feedback) {\r\n            feedback = result.feedback;\r\n        }\r\n        else {\r\n            if (typeof event.index === 'undefined') {\r\n                feedback = [-1];\r\n            }\r\n            else {\r\n                feedback = [event.index];\r\n            }\r\n        }\r\n        // sanitize feedback list\r\n        feedback = distinct(feedback).filter(i => i >= -1 && i < this.length).sort((a, b) => a - b);\r\n        feedback = feedback[0] === -1 ? [-1] : feedback;\r\n        if (equalsDragFeedback(this.currentDragFeedback, feedback)) {\r\n            return true;\r\n        }\r\n        this.currentDragFeedback = feedback;\r\n        this.currentDragFeedbackDisposable.dispose();\r\n        if (feedback[0] === -1) { // entire list feedback\r\n            this.domNode.classList.add('drop-target');\r\n            this.rowsContainer.classList.add('drop-target');\r\n            this.currentDragFeedbackDisposable = toDisposable(() => {\r\n                this.domNode.classList.remove('drop-target');\r\n                this.rowsContainer.classList.remove('drop-target');\r\n            });\r\n        }\r\n        else {\r\n            for (const index of feedback) {\r\n                const item = this.items[index];\r\n                item.dropTarget = true;\r\n                if (item.row) {\r\n                    item.row.domNode.classList.add('drop-target');\r\n                }\r\n            }\r\n            this.currentDragFeedbackDisposable = toDisposable(() => {\r\n                for (const index of feedback) {\r\n                    const item = this.items[index];\r\n                    item.dropTarget = false;\r\n                    if (item.row) {\r\n                        item.row.domNode.classList.remove('drop-target');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return true;\r\n    }\r\n    onDragLeave() {\r\n        this.onDragLeaveTimeout.dispose();\r\n        this.onDragLeaveTimeout = disposableTimeout(() => this.clearDragOverFeedback(), 100);\r\n    }\r\n    onDrop(event) {\r\n        if (!this.canDrop) {\r\n            return;\r\n        }\r\n        const dragData = this.currentDragData;\r\n        this.teardownDragAndDropScrollTopAnimation();\r\n        this.clearDragOverFeedback();\r\n        this.currentDragData = undefined;\r\n        StaticDND.CurrentDragAndDropData = undefined;\r\n        if (!dragData || !event.browserEvent.dataTransfer) {\r\n            return;\r\n        }\r\n        event.browserEvent.preventDefault();\r\n        dragData.update(event.browserEvent.dataTransfer);\r\n        this.dnd.drop(dragData, event.element, event.index, event.browserEvent);\r\n    }\r\n    onDragEnd(event) {\r\n        this.canDrop = false;\r\n        this.teardownDragAndDropScrollTopAnimation();\r\n        this.clearDragOverFeedback();\r\n        this.currentDragData = undefined;\r\n        StaticDND.CurrentDragAndDropData = undefined;\r\n        if (this.dnd.onDragEnd) {\r\n            this.dnd.onDragEnd(event);\r\n        }\r\n    }\r\n    clearDragOverFeedback() {\r\n        this.currentDragFeedback = undefined;\r\n        this.currentDragFeedbackDisposable.dispose();\r\n        this.currentDragFeedbackDisposable = Disposable.None;\r\n    }\r\n    // DND scroll top animation\r\n    setupDragAndDropScrollTopAnimation(event) {\r\n        if (!this.dragOverAnimationDisposable) {\r\n            const viewTop = getTopLeftOffset(this.domNode).top;\r\n            this.dragOverAnimationDisposable = animate(this.animateDragAndDropScrollTop.bind(this, viewTop));\r\n        }\r\n        this.dragOverAnimationStopDisposable.dispose();\r\n        this.dragOverAnimationStopDisposable = disposableTimeout(() => {\r\n            if (this.dragOverAnimationDisposable) {\r\n                this.dragOverAnimationDisposable.dispose();\r\n                this.dragOverAnimationDisposable = undefined;\r\n            }\r\n        }, 1000);\r\n        this.dragOverMouseY = event.pageY;\r\n    }\r\n    animateDragAndDropScrollTop(viewTop) {\r\n        if (this.dragOverMouseY === undefined) {\r\n            return;\r\n        }\r\n        const diff = this.dragOverMouseY - viewTop;\r\n        const upperLimit = this.renderHeight - 35;\r\n        if (diff < 35) {\r\n            this.scrollTop += Math.max(-14, Math.floor(0.3 * (diff - 35)));\r\n        }\r\n        else if (diff > upperLimit) {\r\n            this.scrollTop += Math.min(14, Math.floor(0.3 * (diff - upperLimit)));\r\n        }\r\n    }\r\n    teardownDragAndDropScrollTopAnimation() {\r\n        this.dragOverAnimationStopDisposable.dispose();\r\n        if (this.dragOverAnimationDisposable) {\r\n            this.dragOverAnimationDisposable.dispose();\r\n            this.dragOverAnimationDisposable = undefined;\r\n        }\r\n    }\r\n    // Util\r\n    getItemIndexFromEventTarget(target) {\r\n        const scrollableElement = this.scrollableElement.getDomNode();\r\n        let element = target;\r\n        while (element instanceof HTMLElement && element !== this.rowsContainer && scrollableElement.contains(element)) {\r\n            const rawIndex = element.getAttribute('data-index');\r\n            if (rawIndex) {\r\n                const index = Number(rawIndex);\r\n                if (!isNaN(index)) {\r\n                    return index;\r\n                }\r\n            }\r\n            element = element.parentElement;\r\n        }\r\n        return undefined;\r\n    }\r\n    getRenderRange(renderTop, renderHeight) {\r\n        return {\r\n            start: this.rangeMap.indexAt(renderTop),\r\n            end: this.rangeMap.indexAfter(renderTop + renderHeight - 1)\r\n        };\r\n    }\r\n    /**\r\n     * Given a stable rendered state, checks every rendered element whether it needs\r\n     * to be probed for dynamic height. Adjusts scroll height and top if necessary.\r\n     */\r\n    _rerender(renderTop, renderHeight, inSmoothScrolling) {\r\n        const previousRenderRange = this.getRenderRange(renderTop, renderHeight);\r\n        // Let's remember the second element's position, this helps in scrolling up\r\n        // and preserving a linear upwards scroll movement\r\n        let anchorElementIndex;\r\n        let anchorElementTopDelta;\r\n        if (renderTop === this.elementTop(previousRenderRange.start)) {\r\n            anchorElementIndex = previousRenderRange.start;\r\n            anchorElementTopDelta = 0;\r\n        }\r\n        else if (previousRenderRange.end - previousRenderRange.start > 1) {\r\n            anchorElementIndex = previousRenderRange.start + 1;\r\n            anchorElementTopDelta = this.elementTop(anchorElementIndex) - renderTop;\r\n        }\r\n        let heightDiff = 0;\r\n        while (true) {\r\n            const renderRange = this.getRenderRange(renderTop, renderHeight);\r\n            let didChange = false;\r\n            for (let i = renderRange.start; i < renderRange.end; i++) {\r\n                const diff = this.probeDynamicHeight(i);\r\n                if (diff !== 0) {\r\n                    this.rangeMap.splice(i, 1, [this.items[i]]);\r\n                }\r\n                heightDiff += diff;\r\n                didChange = didChange || diff !== 0;\r\n            }\r\n            if (!didChange) {\r\n                if (heightDiff !== 0) {\r\n                    this.eventuallyUpdateScrollDimensions();\r\n                }\r\n                const unrenderRanges = Range.relativeComplement(previousRenderRange, renderRange);\r\n                for (const range of unrenderRanges) {\r\n                    for (let i = range.start; i < range.end; i++) {\r\n                        if (this.items[i].row) {\r\n                            this.removeItemFromDOM(i);\r\n                        }\r\n                    }\r\n                }\r\n                const renderRanges = Range.relativeComplement(renderRange, previousRenderRange);\r\n                for (const range of renderRanges) {\r\n                    for (let i = range.start; i < range.end; i++) {\r\n                        const afterIndex = i + 1;\r\n                        const beforeRow = afterIndex < this.items.length ? this.items[afterIndex].row : null;\r\n                        const beforeElement = beforeRow ? beforeRow.domNode : null;\r\n                        this.insertItemInDOM(i, beforeElement);\r\n                    }\r\n                }\r\n                for (let i = renderRange.start; i < renderRange.end; i++) {\r\n                    if (this.items[i].row) {\r\n                        this.updateItemInDOM(this.items[i], i);\r\n                    }\r\n                }\r\n                if (typeof anchorElementIndex === 'number') {\r\n                    // To compute a destination scroll top, we need to take into account the current smooth scrolling\r\n                    // animation, and then reuse it with a new target (to avoid prolonging the scroll)\r\n                    // See https://github.com/microsoft/vscode/issues/104144\r\n                    // See https://github.com/microsoft/vscode/pull/104284\r\n                    // See https://github.com/microsoft/vscode/issues/107704\r\n                    const deltaScrollTop = this.scrollable.getFutureScrollPosition().scrollTop - renderTop;\r\n                    const newScrollTop = this.elementTop(anchorElementIndex) - anchorElementTopDelta + deltaScrollTop;\r\n                    this.setScrollTop(newScrollTop, inSmoothScrolling);\r\n                }\r\n                this._onDidChangeContentHeight.fire(this.contentHeight);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    probeDynamicHeight(index) {\r\n        const item = this.items[index];\r\n        if (!item.hasDynamicHeight || item.lastDynamicHeightWidth === this.renderWidth) {\r\n            return 0;\r\n        }\r\n        if (!!this.virtualDelegate.hasDynamicHeight && !this.virtualDelegate.hasDynamicHeight(item.element)) {\r\n            return 0;\r\n        }\r\n        const size = item.size;\r\n        if (!this.setRowHeight && item.row) {\r\n            let newSize = item.row.domNode.offsetHeight;\r\n            item.size = newSize;\r\n            item.lastDynamicHeightWidth = this.renderWidth;\r\n            return newSize - size;\r\n        }\r\n        const row = this.cache.alloc(item.templateId);\r\n        row.domNode.style.height = '';\r\n        this.rowsContainer.appendChild(row.domNode);\r\n        const renderer = this.renderers.get(item.templateId);\r\n        if (renderer) {\r\n            renderer.renderElement(item.element, index, row.templateData, undefined);\r\n            if (renderer.disposeElement) {\r\n                renderer.disposeElement(item.element, index, row.templateData, undefined);\r\n            }\r\n        }\r\n        item.size = row.domNode.offsetHeight;\r\n        if (this.virtualDelegate.setDynamicHeight) {\r\n            this.virtualDelegate.setDynamicHeight(item.element, item.size);\r\n        }\r\n        item.lastDynamicHeightWidth = this.renderWidth;\r\n        this.rowsContainer.removeChild(row.domNode);\r\n        this.cache.release(row);\r\n        return item.size - size;\r\n    }\r\n    getNextToLastElement(ranges) {\r\n        const lastRange = ranges[ranges.length - 1];\r\n        if (!lastRange) {\r\n            return null;\r\n        }\r\n        const nextToLastItem = this.items[lastRange.end];\r\n        if (!nextToLastItem) {\r\n            return null;\r\n        }\r\n        if (!nextToLastItem.row) {\r\n            return null;\r\n        }\r\n        return nextToLastItem.row.domNode;\r\n    }\r\n    getElementDomId(index) {\r\n        return `${this.domId}_${index}`;\r\n    }\r\n    // Dispose\r\n    dispose() {\r\n        if (this.items) {\r\n            for (const item of this.items) {\r\n                if (item.row) {\r\n                    const renderer = this.renderers.get(item.row.templateId);\r\n                    if (renderer) {\r\n                        if (renderer.disposeElement) {\r\n                            renderer.disposeElement(item.element, -1, item.row.templateData, undefined);\r\n                        }\r\n                        renderer.disposeTemplate(item.row.templateData);\r\n                    }\r\n                }\r\n            }\r\n            this.items = [];\r\n        }\r\n        if (this.domNode && this.domNode.parentNode) {\r\n            this.domNode.parentNode.removeChild(this.domNode);\r\n        }\r\n        dispose(this.disposables);\r\n    }\r\n}\r\nListView.InstanceCount = 0;\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onMouseClick\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onMouseDblClick\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onMouseMiddleClick\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onMouseDown\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onContextMenu\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onTouchStart\", null);\r\n__decorate([\r\n    memoize\r\n], ListView.prototype, \"onTap\", null);\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,IAAI,IAAI,IAAI,CAACA,UAAU,IAAK,UAAUC,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACnF,IAAIC,CAAC,GAAGC,SAAS,CAACC,MAAM;IAAEC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGH,MAAM,GAAGE,IAAI,KAAK,IAAI,GAAGA,IAAI,GAAGK,MAAM,CAACC,wBAAwB,CAACR,MAAM,EAAEC,GAAG,CAAC,GAAGC,IAAI;IAAEO,CAAC;EAC5H,IAAI,OAAOC,OAAO,KAAK,QAAQ,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAEL,CAAC,GAAGI,OAAO,CAACC,QAAQ,CAACZ,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,CAAC,CAAC,KAC1H,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAM,GAAG,CAAC,EAAEO,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAC,CAAC,EAAEN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACH,CAAC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACT,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,GAAGG,CAAC,CAACT,MAAM,EAAEC,GAAG,CAAC,KAAKK,CAAC;EACjJ,OAAOH,CAAC,GAAG,CAAC,IAAIG,CAAC,IAAIC,MAAM,CAACM,cAAc,CAACb,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,EAAEA,CAAC;AACjE,CAAC;AACD,SAASQ,YAAY,QAAQ,4BAA4B;AACzD,SAASC,OAAO,EAAEC,UAAU,EAAEC,YAAY,EAAEC,eAAe,QAAQ,8BAA8B;AACjG,SAASC,OAAO,EAAEC,SAAS,IAAIC,cAAc,QAAQ,gBAAgB;AACrE,SAASC,KAAK,EAAEC,OAAO,QAAQ,0BAA0B;AACzD,SAASC,QAAQ,QAAQ,gBAAgB;AACzC,SAASC,uBAAuB,QAAQ,mCAAmC;AAC3E,SAASC,UAAU,QAAQ,+BAA+B;AAC1D,SAASC,QAAQ,EAAEC,KAAK,QAAQ,eAAe;AAC/C,SAASC,QAAQ,QAAQ,eAAe;AACxC,SAASC,OAAO,QAAQ,+BAA+B;AACvD,SAASC,KAAK,QAAQ,0BAA0B;AAChD,SAASC,MAAM,EAAEC,QAAQ,QAAQ,2BAA2B;AAC5D,SAASC,aAAa,EAAEC,SAAS,QAAQ,cAAc;AACvD,SAASC,iBAAiB,EAAEC,OAAO,QAAQ,0BAA0B;AACrE,SAASC,SAAS,QAAQ,kBAAkB;AAC5C,SAASC,CAAC,EAAEC,OAAO,EAAEC,gBAAgB,EAAEC,eAAe,EAAEC,gBAAgB,EAAEC,4BAA4B,QAAQ,cAAc;AAC5H,MAAMC,cAAc,GAAG;EACnBC,UAAU,EAAE,IAAI;EAChBC,kBAAkB,EAAE,CAAC,CAAC;EACtBC,gBAAgB,EAAE,IAAI;EACtBC,YAAY,EAAE,IAAI;EAClBC,qBAAqB,EAAE,KAAK;EAC5BC,GAAG,EAAE;IACDC,eAAeA,CAACC,CAAC,EAAE;MAAE,OAAO,CAACA,CAAC,CAAC;IAAE,CAAC;IAClCC,UAAUA,CAAA,EAAG;MAAE,OAAO,IAAI;IAAE,CAAC;IAC7BC,WAAWA,CAAA,EAAG,CAAE,CAAC;IACjBC,UAAUA,CAAA,EAAG;MAAE,OAAO,KAAK;IAAE,CAAC;IAC9BC,IAAIA,CAAA,EAAG,CAAE;EACb,CAAC;EACDC,mBAAmB,EAAE,KAAK;EAC1BC,qBAAqB,EAAE;AAC3B,CAAC;AACD,OAAO,MAAMC,uBAAuB,CAAC;EACjCC,WAAWA,CAACC,QAAQ,EAAE;IAClB,IAAI,CAACA,QAAQ,GAAGA,QAAQ;EAC5B;EACAC,MAAMA,CAAA,EAAG,CAAE;EACXC,OAAOA,CAAA,EAAG;IACN,OAAO,IAAI,CAACF,QAAQ;EACxB;AACJ;AACA,OAAO,MAAMG,+BAA+B,CAAC;EACzCJ,WAAWA,CAACC,QAAQ,EAAE;IAClB,IAAI,CAACA,QAAQ,GAAGA,QAAQ;EAC5B;EACAC,MAAMA,CAAA,EAAG,CAAE;EACXC,OAAOA,CAAA,EAAG;IACN,OAAO,IAAI,CAACF,QAAQ;EACxB;AACJ;AACA,OAAO,MAAMI,qBAAqB,CAAC;EAC/BL,WAAWA,CAAA,EAAG;IACV,IAAI,CAACM,KAAK,GAAG,EAAE;IACf,IAAI,CAACC,KAAK,GAAG,EAAE;EACnB;EACAL,MAAMA,CAACM,YAAY,EAAE;IACjB,IAAIA,YAAY,CAACF,KAAK,EAAE;MACpB,IAAI,CAACA,KAAK,CAACG,MAAM,CAAC,CAAC,EAAE,IAAI,CAACH,KAAK,CAAC9D,MAAM,EAAE,GAAGgE,YAAY,CAACF,KAAK,CAAC;IAClE;IACA,IAAIE,YAAY,CAACD,KAAK,EAAE;MACpB,IAAI,CAACA,KAAK,CAACE,MAAM,CAAC,CAAC,EAAE,IAAI,CAACF,KAAK,CAAC/D,MAAM,CAAC;MACvC,KAAK,IAAIO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyD,YAAY,CAACD,KAAK,CAAC/D,MAAM,EAAEO,CAAC,EAAE,EAAE;QAChD,MAAM2D,IAAI,GAAGF,YAAY,CAACD,KAAK,CAACI,IAAI,CAAC5D,CAAC,CAAC;QACvC,IAAI2D,IAAI,KAAKA,IAAI,CAACE,IAAI,IAAIF,IAAI,CAACG,IAAI,CAAC,EAAE;UAClC,IAAI,CAACN,KAAK,CAACO,IAAI,CAACJ,IAAI,CAAC;QACzB;MACJ;IACJ;EACJ;EACAP,OAAOA,CAAA,EAAG;IACN,OAAO;MACHG,KAAK,EAAE,IAAI,CAACA,KAAK;MACjBC,KAAK,EAAE,IAAI,CAACA;IAChB,CAAC;EACL;AACJ;AACA,SAASQ,kBAAkBA,CAACC,EAAE,EAAEC,EAAE,EAAE;EAChC,IAAIC,KAAK,CAACC,OAAO,CAACH,EAAE,CAAC,IAAIE,KAAK,CAACC,OAAO,CAACF,EAAE,CAAC,EAAE;IACxC,OAAO9C,MAAM,CAAC6C,EAAE,EAAEC,EAAE,CAAC;EACzB;EACA,OAAOD,EAAE,KAAKC,EAAE;AACpB;AACA,MAAMG,6BAA6B,CAAC;EAChCpB,WAAWA,CAACqB,qBAAqB,EAAE;IAC/B,IAAIA,qBAAqB,KAAK,IAAI,IAAIA,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACC,UAAU,EAAE;MAChH,IAAI,CAACA,UAAU,GAAGD,qBAAqB,CAACC,UAAU,CAACC,IAAI,CAACF,qBAAqB,CAAC;IAClF,CAAC,MACI;MACD,IAAI,CAACC,UAAU,GAAG,CAAC9B,CAAC,EAAEzC,CAAC,EAAEyE,CAAC,KAAKA,CAAC;IACpC;IACA,IAAIH,qBAAqB,KAAK,IAAI,IAAIA,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACI,WAAW,EAAE;MACjH,IAAI,CAACA,WAAW,GAAGJ,qBAAqB,CAACI,WAAW,CAACF,IAAI,CAACF,qBAAqB,CAAC;IACpF,CAAC,MACI;MACD,IAAI,CAACI,WAAW,GAAG,CAACjC,CAAC,EAAEzC,CAAC,KAAKA,CAAC,GAAG,CAAC;IACtC;IACA,IAAIsE,qBAAqB,KAAK,IAAI,IAAIA,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACK,OAAO,EAAE;MAC7G,IAAI,CAACA,OAAO,GAAGL,qBAAqB,CAACK,OAAO,CAACH,IAAI,CAACF,qBAAqB,CAAC;IAC5E,CAAC,MACI;MACD,IAAI,CAACK,OAAO,GAAGC,CAAC,IAAI,UAAU;IAClC;IACA,IAAIN,qBAAqB,KAAK,IAAI,IAAIA,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACO,SAAS,EAAE;MAC/G,IAAI,CAACA,SAAS,GAAGP,qBAAqB,CAACO,SAAS,CAACL,IAAI,CAACF,qBAAqB,CAAC;IAChF,CAAC,MACI;MACD,IAAI,CAACO,SAAS,GAAGD,CAAC,IAAIE,SAAS;IACnC;EACJ;AACJ;AACA,OAAO,MAAMC,QAAQ,CAAC;EAClB9B,WAAWA,CAAC+B,SAAS,EAAEC,eAAe,EAAEC,SAAS,EAA4B;IAAA,IAA1BC,OAAO,GAAA3F,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAsF,SAAA,GAAAtF,SAAA,MAAGyC,cAAc;IACvE,IAAI,CAACgD,eAAe,GAAGA,eAAe;IACtC,IAAI,CAACG,KAAK,cAAAC,MAAA,CAAc,EAAEN,QAAQ,CAACO,aAAa,CAAE;IAClD,IAAI,CAACJ,SAAS,GAAG,IAAIK,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACC,WAAW,GAAG,CAAC;IACpB,IAAI,CAACC,aAAa,GAAG,CAAC;IACtB,IAAI,CAACC,iCAAiC,GAAG,IAAI;IAC7C,IAAI,CAACC,6BAA6B,GAAG,IAAIlE,OAAO,CAAC,EAAE,CAAC;IACpD,IAAI,CAACmE,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACC,+BAA+B,GAAGzF,UAAU,CAAC0F,IAAI;IACtD,IAAI,CAACC,cAAc,GAAG,CAAC;IACvB,IAAI,CAACC,OAAO,GAAG,KAAK;IACpB,IAAI,CAACC,6BAA6B,GAAG7F,UAAU,CAAC0F,IAAI;IACpD,IAAI,CAACI,kBAAkB,GAAG9F,UAAU,CAAC0F,IAAI;IACzC,IAAI,CAACK,WAAW,GAAG,IAAI7F,eAAe,CAAC,CAAC;IACxC,IAAI,CAAC8F,yBAAyB,GAAG,IAAIzF,OAAO,CAAC,CAAC;IAC9C,IAAI,CAAC0F,oBAAoB,GAAG,KAAK;IACjC,IAAIlB,OAAO,CAACrC,mBAAmB,IAAIqC,OAAO,CAAC7C,qBAAqB,EAAE;MAC9D,MAAM,IAAIgE,KAAK,CAAC,uEAAuE,CAAC;IAC5F;IACA,IAAI,CAACC,KAAK,GAAG,EAAE;IACf,IAAI,CAACC,MAAM,GAAG,CAAC;IACf,IAAI,CAACC,QAAQ,GAAG,IAAI1F,QAAQ,CAAC,CAAC;IAC9B,KAAK,MAAM2F,QAAQ,IAAIxB,SAAS,EAAE;MAC9B,IAAI,CAACA,SAAS,CAACyB,GAAG,CAACD,QAAQ,CAACE,UAAU,EAAEF,QAAQ,CAAC;IACrD;IACA,IAAI,CAACG,KAAK,GAAG,IAAI,CAACV,WAAW,CAACW,GAAG,CAAC,IAAI7F,QAAQ,CAAC,IAAI,CAACiE,SAAS,CAAC,CAAC;IAC/D,IAAI,CAAC6B,aAAa,GAAG,CAAC;IACtB,IAAI,CAACC,gBAAgB,GAAG,CAAC;IACzB,IAAI,CAACC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IAC5C,IAAI,CAACF,OAAO,CAACG,SAAS,GAAG,aAAa;IACtC,IAAI,CAACH,OAAO,CAACI,SAAS,CAACP,GAAG,CAAC,IAAI,CAAC1B,KAAK,CAAC;IACtC,IAAI,CAAC6B,OAAO,CAACK,QAAQ,GAAG,CAAC;IACzB,IAAI,CAACL,OAAO,CAACI,SAAS,CAACE,MAAM,CAAC,eAAe,EAAE,OAAOpC,OAAO,CAACqC,YAAY,KAAK,SAAS,GAAGrC,OAAO,CAACqC,YAAY,GAAG,IAAI,CAAC;IACvH,IAAI,CAACnB,oBAAoB,GAAGnG,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAAC3E,mBAAmB,EAAEb,cAAc,CAACa,mBAAmB,CAAC;IACjH,IAAI,CAACmE,OAAO,CAACI,SAAS,CAACE,MAAM,CAAC,sBAAsB,EAAE,IAAI,CAAClB,oBAAoB,CAAC;IAChF,IAAI,CAACqB,sBAAsB,GAAG,OAAOvC,OAAO,CAACuC,sBAAsB,KAAK,WAAW,GAAG,CAAC,GAAGvC,OAAO,CAACuC,sBAAsB;IACxH,IAAI,CAACpD,qBAAqB,GAAG,IAAID,6BAA6B,CAACc,OAAO,CAACb,qBAAqB,CAAC;IAC7F,IAAI,CAACqD,aAAa,GAAGT,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IAClD,IAAI,CAACQ,aAAa,CAACP,SAAS,GAAG,kBAAkB;IACjD,MAAMrE,qBAAqB,GAAG7C,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAAC1E,qBAAqB,EAAEd,cAAc,CAACc,qBAAqB,CAAC;IACvH,IAAIA,qBAAqB,EAAE;MACvB,IAAI,CAAC4E,aAAa,CAACC,KAAK,CAACC,SAAS,GAAG,4BAA4B;IACrE;IACA,IAAI,CAAC1B,WAAW,CAACW,GAAG,CAACvG,OAAO,CAACuH,SAAS,CAAC,IAAI,CAACH,aAAa,CAAC,CAAC;IAC3D,IAAI,CAACI,UAAU,GAAG,IAAIjH,UAAU,CAACZ,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACO,eAAe,EAAE,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,EAAEC,EAAE,IAAIjG,4BAA4B,CAACiG,EAAE,CAAC,CAAC;IACxI,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAC/B,WAAW,CAACW,GAAG,CAAC,IAAIjG,uBAAuB,CAAC,IAAI,CAAC8G,aAAa,EAAE;MAC1FQ,UAAU,EAAE,CAAC,CAAC;MACdC,QAAQ,EAAElI,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACtF,kBAAkB,EAAEF,cAAc,CAACE,kBAAkB,CAAC;MAC7FD,UAAU,EAAEhC,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACvF,UAAU,EAAED,cAAc,CAACC,UAAU;IAClF,CAAC,EAAE,IAAI,CAAC6F,UAAU,CAAC,CAAC;IACpB,IAAI,CAACd,OAAO,CAACoB,WAAW,CAAC,IAAI,CAACH,iBAAiB,CAACI,UAAU,CAAC,CAAC,CAAC;IAC7DtD,SAAS,CAACqD,WAAW,CAAC,IAAI,CAACpB,OAAO,CAAC;IACnC,IAAI,CAACiB,iBAAiB,CAACK,QAAQ,CAAC,IAAI,CAACA,QAAQ,EAAE,IAAI,EAAE,IAAI,CAACpC,WAAW,CAAC;IACtEvF,QAAQ,CAAC,IAAI,CAAC+G,aAAa,EAAElH,cAAc,CAAC+H,MAAM,CAAC,CAAC,IAAI,CAACC,aAAa,EAAE,IAAI,EAAE,IAAI,CAACtC,WAAW,CAAC;IAC/F;IACA;IACAvF,QAAQ,CAAC,IAAI,CAACsH,iBAAiB,CAACI,UAAU,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC7F,CAAC,IAAIA,CAAC,CAACrD,MAAM,CAACsJ,SAAS,GAAG,CAAC,EAAE,IAAI,EAAE,IAAI,CAACvC,WAAW,CAAC;IAC5GzF,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,UAAU,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACmG,WAAW,CAACnG,CAAC,CAAC,CAAC,CAAC,IAAI,CAACG,UAAU,EAAE,IAAI,EAAE,IAAI,CAACuD,WAAW,CAAC;IAChHzF,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,MAAM,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACmG,WAAW,CAACnG,CAAC,CAAC,CAAC,CAAC,IAAI,CAACoG,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC1C,WAAW,CAAC;IACxGvF,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,WAAW,CAAC,CAAC,IAAI,CAAC6B,WAAW,EAAE,IAAI,EAAE,IAAI,CAAC3C,WAAW,CAAC;IAC7EvF,QAAQ,CAACmI,MAAM,EAAE,SAAS,CAAC,CAAC,IAAI,CAACC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC7C,WAAW,CAAC;IACnE,IAAI,CAAC/D,gBAAgB,GAAGlC,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACrF,gBAAgB,EAAEH,cAAc,CAACG,gBAAgB,CAAC;IACvG,IAAI,CAACC,YAAY,GAAGnC,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACpF,YAAY,EAAEJ,cAAc,CAACI,YAAY,CAAC;IAC3F,IAAI,CAACC,qBAAqB,GAAGpC,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAACnF,qBAAqB,EAAEL,cAAc,CAACK,qBAAqB,CAAC;IACtH,IAAI,CAACC,GAAG,GAAGrC,YAAY,CAACiF,OAAO,EAAEsC,CAAC,IAAIA,CAAC,CAAClF,GAAG,EAAEN,cAAc,CAACM,GAAG,CAAC;IAChE,IAAI,CAAC0G,MAAM,CAAC,CAAC;EACjB;EACA,IAAIC,aAAaA,CAAA,EAAG;IAAE,OAAO,IAAI,CAACzC,QAAQ,CAAC5C,IAAI;EAAE;EACjD,IAAIf,mBAAmBA,CAAA,EAAG;IAAE,OAAO,IAAI,CAACuD,oBAAoB;EAAE;EAC9D,IAAIvD,mBAAmBA,CAACqG,KAAK,EAAE;IAC3B,IAAIA,KAAK,KAAK,IAAI,CAAC9C,oBAAoB,EAAE;MACrC;IACJ;IACA,IAAI8C,KAAK,IAAI,IAAI,CAAC7G,qBAAqB,EAAE;MACrC,MAAM,IAAIgE,KAAK,CAAC,uEAAuE,CAAC;IAC5F;IACA,IAAI,CAACD,oBAAoB,GAAG8C,KAAK;IACjC,IAAI,CAAClC,OAAO,CAACI,SAAS,CAACE,MAAM,CAAC,sBAAsB,EAAE,IAAI,CAAClB,oBAAoB,CAAC;IAChF,IAAI,IAAI,CAACA,oBAAoB,EAAE;MAC3B,KAAK,MAAMzC,IAAI,IAAI,IAAI,CAAC2C,KAAK,EAAE;QAC3B,IAAI,CAAC6C,gBAAgB,CAACxF,IAAI,CAAC;MAC/B;MACA,IAAI,CAACyF,iBAAiB,CAAC,CAAC;MACxB,IAAI,CAACnB,iBAAiB,CAACoB,mBAAmB,CAAC;QAAEC,KAAK,EAAEzH,eAAe,CAAC,IAAI,CAACmF,OAAO;MAAE,CAAC,CAAC;MACpF,IAAI,CAACU,aAAa,CAACC,KAAK,CAAC2B,KAAK,MAAAlE,MAAA,CAAMmE,IAAI,CAACC,GAAG,CAAC,IAAI,CAACC,WAAW,IAAI,CAAC,EAAE,IAAI,CAAClE,WAAW,CAAC,OAAI;IAC7F,CAAC,MACI;MACD,IAAI,CAACG,6BAA6B,CAACgE,MAAM,CAAC,CAAC;MAC3C,IAAI,CAACzB,iBAAiB,CAACoB,mBAAmB,CAAC;QAAEC,KAAK,EAAE,IAAI,CAAC/D,WAAW;QAAEkE,WAAW,EAAE,IAAI,CAAClE;MAAY,CAAC,CAAC;MACtG,IAAI,CAACmC,aAAa,CAACC,KAAK,CAAC2B,KAAK,GAAG,EAAE;IACvC;EACJ;EACAK,aAAaA,CAACzE,OAAO,EAAE;IACnB,IAAIA,OAAO,CAACuC,sBAAsB,KAAK5C,SAAS,EAAE;MAC9C,IAAI,CAAC4C,sBAAsB,GAAGvC,OAAO,CAACuC,sBAAsB;IAChE;IACA,IAAIvC,OAAO,CAAC6C,eAAe,KAAKlD,SAAS,EAAE;MACvC,IAAI,CAACiD,UAAU,CAAC8B,uBAAuB,CAAC1E,OAAO,CAAC6C,eAAe,GAAG,GAAG,GAAG,CAAC,CAAC;IAC9E;IACA,IAAI7C,OAAO,CAACrC,mBAAmB,KAAKgC,SAAS,EAAE;MAC3C,IAAI,CAAChC,mBAAmB,GAAGqC,OAAO,CAACrC,mBAAmB;IAC1D;EACJ;EACAY,MAAMA,CAACoG,KAAK,EAAEC,WAAW,EAAiB;IAAA,IAAf7G,QAAQ,GAAA1D,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAsF,SAAA,GAAAtF,SAAA,MAAG,EAAE;IACpC,IAAI,IAAI,CAACoG,QAAQ,EAAE;MACf,MAAM,IAAIU,KAAK,CAAC,+BAA+B,CAAC;IACpD;IACA,IAAI,CAACV,QAAQ,GAAG,IAAI;IACpB,IAAI;MACA,OAAO,IAAI,CAACoE,OAAO,CAACF,KAAK,EAAEC,WAAW,EAAE7G,QAAQ,CAAC;IACrD,CAAC,SACO;MACJ,IAAI,CAAC0C,QAAQ,GAAG,KAAK;MACrB,IAAI,CAACQ,yBAAyB,CAAC6D,IAAI,CAAC,IAAI,CAACf,aAAa,CAAC;IAC3D;EACJ;EACAc,OAAOA,CAACF,KAAK,EAAEC,WAAW,EAAiB;IAAA,IAAf7G,QAAQ,GAAA1D,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAsF,SAAA,GAAAtF,SAAA,MAAG,EAAE;IACrC,MAAM0K,mBAAmB,GAAG,IAAI,CAACC,cAAc,CAAC,IAAI,CAACpD,aAAa,EAAE,IAAI,CAACC,gBAAgB,CAAC;IAC1F,MAAMoD,WAAW,GAAG;MAAEN,KAAK;MAAEO,GAAG,EAAEP,KAAK,GAAGC;IAAY,CAAC;IACvD,MAAMO,WAAW,GAAGnJ,KAAK,CAACoJ,SAAS,CAACL,mBAAmB,EAAEE,WAAW,CAAC;IACrE;IACA,MAAMI,aAAa,GAAG,IAAIjF,GAAG,CAAC,CAAC;IAC/B,KAAK,IAAIvF,CAAC,GAAGsK,WAAW,CAACR,KAAK,EAAE9J,CAAC,GAAGsK,WAAW,CAACD,GAAG,EAAErK,CAAC,EAAE,EAAE;MACtD,MAAM4D,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACvG,CAAC,CAAC;MAC1B4D,IAAI,CAAC6G,mBAAmB,CAACtK,OAAO,CAAC,CAAC;MAClC,IAAIyD,IAAI,CAAC8G,GAAG,EAAE;QACV,IAAIC,IAAI,GAAGH,aAAa,CAACI,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;QAC7C,IAAI,CAAC+D,IAAI,EAAE;UACPA,IAAI,GAAG,EAAE;UACTH,aAAa,CAAC7D,GAAG,CAAC/C,IAAI,CAACgD,UAAU,EAAE+D,IAAI,CAAC;QAC5C;QACAA,IAAI,CAAC5G,IAAI,CAAC,CAACH,IAAI,CAAC8G,GAAG,EAAE9G,IAAI,CAACiH,OAAO,EAAE7K,CAAC,EAAE4D,IAAI,CAACC,IAAI,CAAC,CAAC;MACrD;MACAD,IAAI,CAAC8G,GAAG,GAAG,IAAI;IACnB;IACA,MAAMI,iBAAiB,GAAG;MAAEhB,KAAK,EAAEA,KAAK,GAAGC,WAAW;MAAEM,GAAG,EAAE,IAAI,CAAC9D,KAAK,CAAC9G;IAAO,CAAC;IAChF,MAAMsL,yBAAyB,GAAG5J,KAAK,CAACoJ,SAAS,CAACO,iBAAiB,EAAEZ,mBAAmB,CAAC;IACzF,MAAMc,4BAA4B,GAAG7J,KAAK,CAAC8J,kBAAkB,CAACH,iBAAiB,EAAEZ,mBAAmB,CAAC;IACrG,MAAMgB,QAAQ,GAAGhI,QAAQ,CAACyF,GAAG,CAACkC,OAAO,KAAK;MACtCM,EAAE,EAAEC,MAAM,CAAC,IAAI,CAAC5E,MAAM,EAAE,CAAC;MACzBqE,OAAO;MACPjE,UAAU,EAAE,IAAI,CAAC3B,eAAe,CAACoG,aAAa,CAACR,OAAO,CAAC;MACvDhH,IAAI,EAAE,IAAI,CAACoB,eAAe,CAACqG,SAAS,CAACT,OAAO,CAAC;MAC7CtB,KAAK,EAAEzE,SAAS;MAChByG,gBAAgB,EAAE,CAAC,CAAC,IAAI,CAACtG,eAAe,CAACsG,gBAAgB,IAAI,IAAI,CAACtG,eAAe,CAACsG,gBAAgB,CAACV,OAAO,CAAC;MAC3GW,sBAAsB,EAAE1G,SAAS;MACjC4F,GAAG,EAAE,IAAI;MACTe,GAAG,EAAE3G,SAAS;MACd4G,UAAU,EAAE,KAAK;MACjBjB,mBAAmB,EAAErK,UAAU,CAAC0F;IACpC,CAAC,CAAC,CAAC;IACH,IAAI6F,OAAO;IACX;IACA,IAAI7B,KAAK,KAAK,CAAC,IAAIC,WAAW,IAAI,IAAI,CAACxD,KAAK,CAAC9G,MAAM,EAAE;MACjD,IAAI,CAACgH,QAAQ,GAAG,IAAI1F,QAAQ,CAAC,CAAC;MAC9B,IAAI,CAAC0F,QAAQ,CAAC/C,MAAM,CAAC,CAAC,EAAE,CAAC,EAAEwH,QAAQ,CAAC;MACpC,IAAI,CAAC3E,KAAK,GAAG2E,QAAQ;MACrBS,OAAO,GAAG,EAAE;IAChB,CAAC,MACI;MACD,IAAI,CAAClF,QAAQ,CAAC/C,MAAM,CAACoG,KAAK,EAAEC,WAAW,EAAEmB,QAAQ,CAAC;MAClDS,OAAO,GAAG,IAAI,CAACpF,KAAK,CAAC7C,MAAM,CAACoG,KAAK,EAAEC,WAAW,EAAE,GAAGmB,QAAQ,CAAC;IAChE;IACA,MAAMU,KAAK,GAAG1I,QAAQ,CAACzD,MAAM,GAAGsK,WAAW;IAC3C,MAAM8B,WAAW,GAAG,IAAI,CAAC1B,cAAc,CAAC,IAAI,CAACpD,aAAa,EAAE,IAAI,CAACC,gBAAgB,CAAC;IAClF,MAAM8E,iBAAiB,GAAG9K,KAAK,CAAC+J,yBAAyB,EAAEa,KAAK,CAAC;IACjE,MAAMG,WAAW,GAAG5K,KAAK,CAACoJ,SAAS,CAACsB,WAAW,EAAEC,iBAAiB,CAAC;IACnE,KAAK,IAAI9L,CAAC,GAAG+L,WAAW,CAACjC,KAAK,EAAE9J,CAAC,GAAG+L,WAAW,CAAC1B,GAAG,EAAErK,CAAC,EAAE,EAAE;MACtD,IAAI,CAACgM,eAAe,CAAC,IAAI,CAACzF,KAAK,CAACvG,CAAC,CAAC,EAAEA,CAAC,CAAC;IAC1C;IACA,MAAMiM,YAAY,GAAG9K,KAAK,CAAC8J,kBAAkB,CAACa,iBAAiB,EAAED,WAAW,CAAC;IAC7E,KAAK,MAAMK,KAAK,IAAID,YAAY,EAAE;MAC9B,KAAK,IAAIjM,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;QAC1C,IAAI,CAACmM,iBAAiB,CAACnM,CAAC,CAAC;MAC7B;IACJ;IACA,MAAMoM,oBAAoB,GAAGpB,4BAA4B,CAACrC,GAAG,CAACjJ,CAAC,IAAIsB,KAAK,CAACtB,CAAC,EAAEkM,KAAK,CAAC,CAAC;IACnF,MAAMS,aAAa,GAAG;MAAEvC,KAAK;MAAEO,GAAG,EAAEP,KAAK,GAAG5G,QAAQ,CAACzD;IAAO,CAAC;IAC7D,MAAM6M,YAAY,GAAG,CAACD,aAAa,EAAE,GAAGD,oBAAoB,CAAC,CAACzD,GAAG,CAACjJ,CAAC,IAAIyB,KAAK,CAACoJ,SAAS,CAACsB,WAAW,EAAEnM,CAAC,CAAC,CAAC;IACvG,MAAM6M,aAAa,GAAG,IAAI,CAACC,oBAAoB,CAACF,YAAY,CAAC;IAC7D,KAAK,MAAMJ,KAAK,IAAII,YAAY,EAAE;MAC9B,KAAK,IAAItM,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;QAC1C,MAAM4D,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACvG,CAAC,CAAC;QAC1B,MAAM2K,IAAI,GAAGH,aAAa,CAACI,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;QAC/C,MAAM6F,OAAO,GAAG9B,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAAC+B,GAAG,CAAC,CAAC;QACtE,IAAI,CAACD,OAAO,EAAE;UACV,IAAI,CAACE,eAAe,CAAC3M,CAAC,EAAEuM,aAAa,CAAC;QAC1C,CAAC,MACI;UACD,MAAM,CAAC7B,GAAG,EAAEG,OAAO,EAAE+B,KAAK,EAAE/I,IAAI,CAAC,GAAG4I,OAAO;UAC3C,MAAM/F,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;UACpD,IAAIF,QAAQ,IAAIA,QAAQ,CAACmG,cAAc,EAAE;YACrCnG,QAAQ,CAACmG,cAAc,CAAChC,OAAO,EAAE+B,KAAK,EAAElC,GAAG,CAACoC,YAAY,EAAEjJ,IAAI,CAAC;UACnE;UACA,IAAI,CAAC8I,eAAe,CAAC3M,CAAC,EAAEuM,aAAa,EAAE7B,GAAG,CAAC;QAC/C;MACJ;IACJ;IACA,KAAK,MAAM,CAAC9D,UAAU,EAAE+D,IAAI,CAAC,IAAIH,aAAa,EAAE;MAC5C,KAAK,MAAM,CAACE,GAAG,EAAEG,OAAO,EAAE+B,KAAK,EAAE/I,IAAI,CAAC,IAAI8G,IAAI,EAAE;QAC5C,MAAMjE,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChE,UAAU,CAAC;QAC/C,IAAIF,QAAQ,IAAIA,QAAQ,CAACmG,cAAc,EAAE;UACrCnG,QAAQ,CAACmG,cAAc,CAAChC,OAAO,EAAE+B,KAAK,EAAElC,GAAG,CAACoC,YAAY,EAAEjJ,IAAI,CAAC;QACnE;QACA,IAAI,CAACgD,KAAK,CAACkG,OAAO,CAACrC,GAAG,CAAC;MAC3B;IACJ;IACA,IAAI,CAACsC,gCAAgC,CAAC,CAAC;IACvC,IAAI,IAAI,CAAC1K,qBAAqB,EAAE;MAC5B,IAAI,CAAC2K,SAAS,CAAC,IAAI,CAACvE,SAAS,EAAE,IAAI,CAACwE,YAAY,CAAC;IACrD;IACA,OAAOvB,OAAO,CAAChD,GAAG,CAAC3I,CAAC,IAAIA,CAAC,CAAC6K,OAAO,CAAC;EACtC;EACAmC,gCAAgCA,CAAA,EAAG;IAC/B,IAAI,CAACvH,aAAa,GAAG,IAAI,CAACyD,aAAa;IACvC,IAAI,CAACvB,aAAa,CAACC,KAAK,CAACuF,MAAM,MAAA9H,MAAA,CAAM,IAAI,CAACI,aAAa,OAAI;IAC3D,IAAI,CAAC,IAAI,CAACC,iCAAiC,EAAE;MACzC,IAAI,CAACA,iCAAiC,GAAG1D,4BAA4B,CAAC,MAAM;QACxE,IAAI,CAACkG,iBAAiB,CAACoB,mBAAmB,CAAC;UAAE8D,YAAY,EAAE,IAAI,CAACA;QAAa,CAAC,CAAC;QAC/E,IAAI,CAAC/D,iBAAiB,CAAC,CAAC;QACxB,IAAI,CAAC3D,iCAAiC,GAAG,IAAI;MACjD,CAAC,CAAC;IACN;EACJ;EACA2H,2BAA2BA,CAAA,EAAG;IAC1B,IAAI,CAAC,IAAI,CAACvK,mBAAmB,EAAE;MAC3B,IAAI,CAAC6C,6BAA6B,CAACgE,MAAM,CAAC,CAAC;MAC3C;IACJ;IACA,IAAI,CAAChE,6BAA6B,CAAC2H,OAAO,CAAC,MAAM,IAAI,CAACjE,iBAAiB,CAAC,CAAC,CAAC;EAC9E;EACAA,iBAAiBA,CAAA,EAAG;IAChB,IAAI,CAAC,IAAI,CAACvG,mBAAmB,EAAE;MAC3B;IACJ;IACA,IAAI4G,WAAW,GAAG,CAAC;IACnB,KAAK,MAAM9F,IAAI,IAAI,IAAI,CAAC2C,KAAK,EAAE;MAC3B,IAAI,OAAO3C,IAAI,CAAC2F,KAAK,KAAK,WAAW,EAAE;QACnCG,WAAW,GAAGF,IAAI,CAACC,GAAG,CAACC,WAAW,EAAE9F,IAAI,CAAC2F,KAAK,CAAC;MACnD;IACJ;IACA,IAAI,CAACG,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACxB,iBAAiB,CAACoB,mBAAmB,CAAC;MAAEI,WAAW,EAAEA,WAAW,KAAK,CAAC,GAAG,CAAC,GAAIA,WAAW,GAAG;IAAI,CAAC,CAAC;EAC3G;EACA6D,QAAQA,CAAA,EAAG;IACP,IAAI,CAAC,IAAI,CAACjL,qBAAqB,EAAE;MAC7B;IACJ;IACA,KAAK,MAAMsB,IAAI,IAAI,IAAI,CAAC2C,KAAK,EAAE;MAC3B3C,IAAI,CAAC4H,sBAAsB,GAAG1G,SAAS;IAC3C;IACA,IAAI,CAACmI,SAAS,CAAC,IAAI,CAAClG,aAAa,EAAE,IAAI,CAACC,gBAAgB,CAAC;EAC7D;EACA,IAAIvH,MAAMA,CAAA,EAAG;IACT,OAAO,IAAI,CAAC8G,KAAK,CAAC9G,MAAM;EAC5B;EACA,IAAIyN,YAAYA,CAAA,EAAG;IACf,MAAMM,gBAAgB,GAAG,IAAI,CAACtF,iBAAiB,CAACuF,mBAAmB,CAAC,CAAC;IACrE,OAAOD,gBAAgB,CAACL,MAAM;EAClC;EACAtC,OAAOA,CAAC+B,KAAK,EAAE;IACX,OAAO,IAAI,CAACrG,KAAK,CAACqG,KAAK,CAAC,CAAC/B,OAAO;EACpC;EACA6C,UAAUA,CAACd,KAAK,EAAE;IACd,MAAMlC,GAAG,GAAG,IAAI,CAACnE,KAAK,CAACqG,KAAK,CAAC,CAAClC,GAAG;IACjC,OAAOA,GAAG,IAAIA,GAAG,CAACzD,OAAO;EAC7B;EACA0G,aAAaA,CAACf,KAAK,EAAE;IACjB,OAAO,IAAI,CAACrG,KAAK,CAACqG,KAAK,CAAC,CAAC/I,IAAI;EACjC;EACA+J,UAAUA,CAAChB,KAAK,EAAE;IACd,OAAO,IAAI,CAACnG,QAAQ,CAACoH,UAAU,CAACjB,KAAK,CAAC;EAC1C;EACAkB,OAAOA,CAACC,QAAQ,EAAE;IACd,OAAO,IAAI,CAACtH,QAAQ,CAACqH,OAAO,CAACC,QAAQ,CAAC;EAC1C;EACAC,UAAUA,CAACD,QAAQ,EAAE;IACjB,OAAO,IAAI,CAACtH,QAAQ,CAACuH,UAAU,CAACD,QAAQ,CAAC;EAC7C;EACA9E,MAAMA,CAACkE,MAAM,EAAE5D,KAAK,EAAE;IAClB,IAAIiE,gBAAgB,GAAG;MACnBL,MAAM,EAAE,OAAOA,MAAM,KAAK,QAAQ,GAAGA,MAAM,GAAGtL,gBAAgB,CAAC,IAAI,CAACoF,OAAO;IAC/E,CAAC;IACD,IAAI,IAAI,CAACvB,iCAAiC,EAAE;MACxC,IAAI,CAACA,iCAAiC,CAACvF,OAAO,CAAC,CAAC;MAChD,IAAI,CAACuF,iCAAiC,GAAG,IAAI;MAC7C8H,gBAAgB,CAACJ,YAAY,GAAG,IAAI,CAACA,YAAY;IACrD;IACA,IAAI,CAAClF,iBAAiB,CAACoB,mBAAmB,CAACkE,gBAAgB,CAAC;IAC5D,IAAI,OAAOjE,KAAK,KAAK,WAAW,EAAE;MAC9B,IAAI,CAAC/D,WAAW,GAAG+D,KAAK;MACxB,IAAI,IAAI,CAACjH,qBAAqB,EAAE;QAC5B,IAAI,CAAC2K,SAAS,CAAC,IAAI,CAACvE,SAAS,EAAE,IAAI,CAACwE,YAAY,CAAC;MACrD;MACA,IAAI,IAAI,CAACpK,mBAAmB,EAAE;QAC1B,IAAI,CAACoF,iBAAiB,CAACoB,mBAAmB,CAAC;UACvCC,KAAK,EAAE,OAAOA,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAGzH,eAAe,CAAC,IAAI,CAACmF,OAAO;QAC3E,CAAC,CAAC;MACN;IACJ;EACJ;EACA;EACAgH,MAAMA,CAAC/D,mBAAmB,EAAEgE,SAAS,EAAEhB,YAAY,EAAEiB,UAAU,EAAEzE,WAAW,EAA4B;IAAA,IAA1B0E,gBAAgB,GAAA5O,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAsF,SAAA,GAAAtF,SAAA,MAAG,KAAK;IAClG,MAAMqM,WAAW,GAAG,IAAI,CAAC1B,cAAc,CAAC+D,SAAS,EAAEhB,YAAY,CAAC;IAChE,MAAMmB,cAAc,GAAGlN,KAAK,CAAC8J,kBAAkB,CAACY,WAAW,EAAE3B,mBAAmB,CAAC;IACjF,MAAMoE,cAAc,GAAGnN,KAAK,CAAC8J,kBAAkB,CAACf,mBAAmB,EAAE2B,WAAW,CAAC;IACjF,MAAMU,aAAa,GAAG,IAAI,CAACC,oBAAoB,CAAC6B,cAAc,CAAC;IAC/D,IAAID,gBAAgB,EAAE;MAClB,MAAMG,cAAc,GAAGpN,KAAK,CAACoJ,SAAS,CAACL,mBAAmB,EAAE2B,WAAW,CAAC;MACxE,KAAK,IAAI7L,CAAC,GAAGuO,cAAc,CAACzE,KAAK,EAAE9J,CAAC,GAAGuO,cAAc,CAAClE,GAAG,EAAErK,CAAC,EAAE,EAAE;QAC5D,IAAI,CAACgM,eAAe,CAAC,IAAI,CAACzF,KAAK,CAACvG,CAAC,CAAC,EAAEA,CAAC,CAAC;MAC1C;IACJ;IACA,KAAK,MAAMkM,KAAK,IAAImC,cAAc,EAAE;MAChC,KAAK,IAAIrO,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;QAC1C,IAAI,CAAC2M,eAAe,CAAC3M,CAAC,EAAEuM,aAAa,CAAC;MAC1C;IACJ;IACA,KAAK,MAAML,KAAK,IAAIoC,cAAc,EAAE;MAChC,KAAK,IAAItO,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;QAC1C,IAAI,CAACmM,iBAAiB,CAACnM,CAAC,CAAC;MAC7B;IACJ;IACA,IAAImO,UAAU,KAAKrJ,SAAS,EAAE;MAC1B,IAAI,CAAC6C,aAAa,CAACC,KAAK,CAAC4G,IAAI,OAAAnJ,MAAA,CAAO8I,UAAU,OAAI;IACtD;IACA,IAAI,CAACxG,aAAa,CAACC,KAAK,CAAC6G,GAAG,OAAApJ,MAAA,CAAO6I,SAAS,OAAI;IAChD,IAAI,IAAI,CAACpL,mBAAmB,IAAI4G,WAAW,KAAK5E,SAAS,EAAE;MACvD,IAAI,CAAC6C,aAAa,CAACC,KAAK,CAAC2B,KAAK,MAAAlE,MAAA,CAAMmE,IAAI,CAACC,GAAG,CAACC,WAAW,EAAE,IAAI,CAAClE,WAAW,CAAC,OAAI;IACnF;IACA,IAAI,CAACuB,aAAa,GAAGmH,SAAS;IAC9B,IAAI,CAAClH,gBAAgB,GAAGkG,YAAY;EACxC;EACA;EACAP,eAAeA,CAACC,KAAK,EAAEL,aAAa,EAAE7B,GAAG,EAAE;IACvC,MAAM9G,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACqG,KAAK,CAAC;IAC9B,IAAI,CAAChJ,IAAI,CAAC8G,GAAG,EAAE;MACX9G,IAAI,CAAC8G,GAAG,GAAGA,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAK,KAAK,CAAC,GAAGA,GAAG,GAAG,IAAI,CAAC7D,KAAK,CAAC6H,KAAK,CAAC9K,IAAI,CAACgD,UAAU,CAAC;IACvF;IACA,MAAM+H,IAAI,GAAG,IAAI,CAACrK,qBAAqB,CAACK,OAAO,CAACf,IAAI,CAACiH,OAAO,CAAC,IAAI,UAAU;IAC3EjH,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,MAAM,EAAED,IAAI,CAAC;IAC3C,MAAME,OAAO,GAAG,IAAI,CAACvK,qBAAqB,CAACO,SAAS,CAACjB,IAAI,CAACiH,OAAO,CAAC;IAClE,IAAI,OAAOgE,OAAO,KAAK,WAAW,EAAE;MAChCjL,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,cAAc,EAAExD,MAAM,CAAC,CAAC,CAACyD,OAAO,CAAC,CAAC;IACpE;IACA,IAAI,CAACjL,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC6H,aAAa,EAAE;MACjC,IAAIvC,aAAa,EAAE;QACf,IAAI,CAAC5E,aAAa,CAACoH,YAAY,CAACnL,IAAI,CAAC8G,GAAG,CAACzD,OAAO,EAAEsF,aAAa,CAAC;MACpE,CAAC,MACI;QACD,IAAI,CAAC5E,aAAa,CAACU,WAAW,CAACzE,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC;MACpD;IACJ;IACA,IAAI,CAAC+E,eAAe,CAACpI,IAAI,EAAEgJ,KAAK,CAAC;IACjC,MAAMlG,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;IACpD,IAAI,CAACF,QAAQ,EAAE;MACX,MAAM,IAAIJ,KAAK,sCAAAjB,MAAA,CAAsCzB,IAAI,CAACgD,UAAU,CAAE,CAAC;IAC3E;IACA,IAAIF,QAAQ,EAAE;MACVA,QAAQ,CAACsI,aAAa,CAACpL,IAAI,CAACiH,OAAO,EAAE+B,KAAK,EAAEhJ,IAAI,CAAC8G,GAAG,CAACoC,YAAY,EAAElJ,IAAI,CAACC,IAAI,CAAC;IACjF;IACA,MAAM4H,GAAG,GAAG,IAAI,CAAClJ,GAAG,CAACG,UAAU,CAACkB,IAAI,CAACiH,OAAO,CAAC;IAC7CjH,IAAI,CAAC6G,mBAAmB,CAACtK,OAAO,CAAC,CAAC;IAClCyD,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACgI,SAAS,GAAG,CAAC,CAACxD,GAAG;IAClC,IAAIA,GAAG,EAAE;MACL,MAAM9I,WAAW,GAAG/B,QAAQ,CAACgD,IAAI,CAAC8G,GAAG,CAACzD,OAAO,EAAE,WAAW,CAAC;MAC3DrD,IAAI,CAAC6G,mBAAmB,GAAG9H,WAAW,CAACuM,KAAK,IAAI,IAAI,CAACvM,WAAW,CAACiB,IAAI,CAACiH,OAAO,EAAEY,GAAG,EAAEyD,KAAK,CAAC,CAAC;IAC/F;IACA,IAAI,IAAI,CAACpM,mBAAmB,EAAE;MAC1B,IAAI,CAACsG,gBAAgB,CAACxF,IAAI,CAAC;MAC3B,IAAI,CAACyJ,2BAA2B,CAAC,CAAC;IACtC;EACJ;EACAjE,gBAAgBA,CAACxF,IAAI,EAAE;IACnB,IAAI,CAACA,IAAI,CAAC8G,GAAG,IAAI,CAAC9G,IAAI,CAAC8G,GAAG,CAACzD,OAAO,EAAE;MAChC;IACJ;IACArD,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACW,KAAK,CAAC2B,KAAK,GAAG7H,SAAS,GAAG,kBAAkB,GAAG,aAAa;IAC7EkC,IAAI,CAAC2F,KAAK,GAAGzH,eAAe,CAAC8B,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC;IAC9C,MAAMW,KAAK,GAAGmB,MAAM,CAACoG,gBAAgB,CAACvL,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC;IACvD,IAAIW,KAAK,CAACwH,WAAW,EAAE;MACnBxL,IAAI,CAAC2F,KAAK,IAAI8F,UAAU,CAACzH,KAAK,CAACwH,WAAW,CAAC;IAC/C;IACA,IAAIxH,KAAK,CAAC0H,YAAY,EAAE;MACpB1L,IAAI,CAAC2F,KAAK,IAAI8F,UAAU,CAACzH,KAAK,CAAC0H,YAAY,CAAC;IAChD;IACA1L,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACW,KAAK,CAAC2B,KAAK,GAAG,EAAE;EACrC;EACAyC,eAAeA,CAACpI,IAAI,EAAEgJ,KAAK,EAAE;IACzBhJ,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACW,KAAK,CAAC6G,GAAG,MAAApJ,MAAA,CAAM,IAAI,CAACuI,UAAU,CAAChB,KAAK,CAAC,OAAI;IAC1D,IAAI,IAAI,CAACvK,YAAY,EAAE;MACnBuB,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACW,KAAK,CAACuF,MAAM,MAAA9H,MAAA,CAAMzB,IAAI,CAACC,IAAI,OAAI;IACpD;IACA,IAAI,IAAI,CAACzB,gBAAgB,EAAE;MACvBwB,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACW,KAAK,CAAC2H,UAAU,MAAAlK,MAAA,CAAMzB,IAAI,CAACC,IAAI,OAAI;IACxD;IACAD,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,YAAY,KAAAvJ,MAAA,CAAKuH,KAAK,CAAE,CAAC;IACvDhJ,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,mBAAmB,EAAEhC,KAAK,KAAK,IAAI,CAACnN,MAAM,GAAG,CAAC,GAAG,MAAM,GAAG,OAAO,CAAC;IAChGmE,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,cAAc,EAAExD,MAAM,CAAC,IAAI,CAAC9G,qBAAqB,CAACC,UAAU,CAACX,IAAI,CAACiH,OAAO,EAAE+B,KAAK,EAAE,IAAI,CAACnN,MAAM,CAAC,CAAC,CAAC;IAC9HmE,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,eAAe,EAAExD,MAAM,CAAC,IAAI,CAAC9G,qBAAqB,CAACI,WAAW,CAACd,IAAI,CAACiH,OAAO,EAAE+B,KAAK,CAAC,CAAC,CAAC;IACnHhJ,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC2H,YAAY,CAAC,IAAI,EAAE,IAAI,CAACY,eAAe,CAAC5C,KAAK,CAAC,CAAC;IAChEhJ,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACI,SAAS,CAACE,MAAM,CAAC,aAAa,EAAE3D,IAAI,CAAC8H,UAAU,CAAC;EACrE;EACAS,iBAAiBA,CAACS,KAAK,EAAE;IACrB,MAAMhJ,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACqG,KAAK,CAAC;IAC9BhJ,IAAI,CAAC6G,mBAAmB,CAACtK,OAAO,CAAC,CAAC;IAClC,IAAIyD,IAAI,CAAC8G,GAAG,EAAE;MACV,MAAMhE,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;MACpD,IAAIF,QAAQ,IAAIA,QAAQ,CAACmG,cAAc,EAAE;QACrCnG,QAAQ,CAACmG,cAAc,CAACjJ,IAAI,CAACiH,OAAO,EAAE+B,KAAK,EAAEhJ,IAAI,CAAC8G,GAAG,CAACoC,YAAY,EAAElJ,IAAI,CAACC,IAAI,CAAC;MAClF;MACA,IAAI,CAACgD,KAAK,CAACkG,OAAO,CAACnJ,IAAI,CAAC8G,GAAG,CAAC;MAC5B9G,IAAI,CAAC8G,GAAG,GAAG,IAAI;IACnB;IACA,IAAI,IAAI,CAAC5H,mBAAmB,EAAE;MAC1B,IAAI,CAACuK,2BAA2B,CAAC,CAAC;IACtC;EACJ;EACAoC,YAAYA,CAAA,EAAG;IACX,MAAMC,cAAc,GAAG,IAAI,CAACxH,iBAAiB,CAACyH,iBAAiB,CAAC,CAAC;IACjE,OAAOD,cAAc,CAAChH,SAAS;EACnC;EACAkH,YAAYA,CAAClH,SAAS,EAAEmH,cAAc,EAAE;IACpC,IAAI,IAAI,CAACnK,iCAAiC,EAAE;MACxC,IAAI,CAACA,iCAAiC,CAACvF,OAAO,CAAC,CAAC;MAChD,IAAI,CAACuF,iCAAiC,GAAG,IAAI;MAC7C,IAAI,CAACwC,iBAAiB,CAACoB,mBAAmB,CAAC;QAAE8D,YAAY,EAAE,IAAI,CAACA;MAAa,CAAC,CAAC;IACnF;IACA,IAAI,CAAClF,iBAAiB,CAAC4H,iBAAiB,CAAC;MAAEpH,SAAS;MAAEmH;IAAe,CAAC,CAAC;EAC3E;EACA,IAAInH,SAASA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC+G,YAAY,CAAC,CAAC;EAC9B;EACA,IAAI/G,SAASA,CAACA,SAAS,EAAE;IACrB,IAAI,CAACkH,YAAY,CAAClH,SAAS,CAAC;EAChC;EACA,IAAI0E,YAAYA,CAAA,EAAG;IACf,OAAO,IAAI,CAAC3H,aAAa,IAAI,IAAI,CAAC3C,mBAAmB,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC4E,sBAAsB;EACjG;EACA;EACA,IAAIqI,YAAYA,CAAA,EAAG;IAAE,OAAOrP,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,OAAO,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACuN,YAAY,CAACvN,CAAC,CAAC,CAAC;EAAE;EACnG,IAAIwN,eAAeA,CAAA,EAAG;IAAE,OAAOvP,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,UAAU,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACuN,YAAY,CAACvN,CAAC,CAAC,CAAC;EAAE;EACzG,IAAIyN,kBAAkBA,CAAA,EAAG;IAAE,OAAOxP,KAAK,CAACyP,MAAM,CAACzP,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,UAAU,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACuN,YAAY,CAACvN,CAAC,CAAC,CAAC,EAAEA,CAAC,IAAIA,CAAC,CAAC2N,YAAY,CAACC,MAAM,KAAK,CAAC,CAAC;EAAE;EAC5J,IAAIC,WAAWA,CAAA,EAAG;IAAE,OAAO5P,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,WAAW,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACuN,YAAY,CAACvN,CAAC,CAAC,CAAC;EAAE;EACtG,IAAI8N,aAAaA,CAAA,EAAG;IAAE,OAAO7P,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,aAAa,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACuN,YAAY,CAACvN,CAAC,CAAC,CAAC;EAAE;EAC1G,IAAI+N,YAAYA,CAAA,EAAG;IAAE,OAAO9P,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAACqG,OAAO,EAAE,YAAY,CAAC,EAAExE,CAAC,IAAI,IAAI,CAACgO,YAAY,CAAChO,CAAC,CAAC,CAAC;EAAE;EACxG,IAAIiO,KAAKA,CAAA,EAAG;IAAE,OAAOhQ,KAAK,CAACiI,GAAG,CAAC/H,QAAQ,CAAC,IAAI,CAAC+G,aAAa,EAAElH,cAAc,CAACkQ,GAAG,CAAC,EAAElO,CAAC,IAAI,IAAI,CAACmO,cAAc,CAACnO,CAAC,CAAC,CAAC;EAAE;EAC/GuN,YAAYA,CAACI,YAAY,EAAE;IACvB,MAAMxD,KAAK,GAAG,IAAI,CAACiE,2BAA2B,CAACT,YAAY,CAAChR,MAAM,IAAI,IAAI,CAAC;IAC3E,MAAMwE,IAAI,GAAG,OAAOgJ,KAAK,KAAK,WAAW,GAAG9H,SAAS,GAAG,IAAI,CAACyB,KAAK,CAACqG,KAAK,CAAC;IACzE,MAAM/B,OAAO,GAAGjH,IAAI,IAAIA,IAAI,CAACiH,OAAO;IACpC,OAAO;MAAEuF,YAAY;MAAExD,KAAK;MAAE/B;IAAQ,CAAC;EAC3C;EACA4F,YAAYA,CAACL,YAAY,EAAE;IACvB,MAAMxD,KAAK,GAAG,IAAI,CAACiE,2BAA2B,CAACT,YAAY,CAAChR,MAAM,IAAI,IAAI,CAAC;IAC3E,MAAMwE,IAAI,GAAG,OAAOgJ,KAAK,KAAK,WAAW,GAAG9H,SAAS,GAAG,IAAI,CAACyB,KAAK,CAACqG,KAAK,CAAC;IACzE,MAAM/B,OAAO,GAAGjH,IAAI,IAAIA,IAAI,CAACiH,OAAO;IACpC,OAAO;MAAEuF,YAAY;MAAExD,KAAK;MAAE/B;IAAQ,CAAC;EAC3C;EACA+F,cAAcA,CAACR,YAAY,EAAE;IACzB,MAAMxD,KAAK,GAAG,IAAI,CAACiE,2BAA2B,CAACT,YAAY,CAACU,aAAa,IAAI,IAAI,CAAC;IAClF,MAAMlN,IAAI,GAAG,OAAOgJ,KAAK,KAAK,WAAW,GAAG9H,SAAS,GAAG,IAAI,CAACyB,KAAK,CAACqG,KAAK,CAAC;IACzE,MAAM/B,OAAO,GAAGjH,IAAI,IAAIA,IAAI,CAACiH,OAAO;IACpC,OAAO;MAAEuF,YAAY;MAAExD,KAAK;MAAE/B;IAAQ,CAAC;EAC3C;EACAjC,WAAWA,CAACwH,YAAY,EAAE;IACtB,MAAMxD,KAAK,GAAG,IAAI,CAACiE,2BAA2B,CAACT,YAAY,CAAChR,MAAM,IAAI,IAAI,CAAC;IAC3E,MAAMwE,IAAI,GAAG,OAAOgJ,KAAK,KAAK,WAAW,GAAG9H,SAAS,GAAG,IAAI,CAACyB,KAAK,CAACqG,KAAK,CAAC;IACzE,MAAM/B,OAAO,GAAGjH,IAAI,IAAIA,IAAI,CAACiH,OAAO;IACpC,OAAO;MAAEuF,YAAY;MAAExD,KAAK;MAAE/B;IAAQ,CAAC;EAC3C;EACAtC,QAAQA,CAAC9F,CAAC,EAAE;IACR,IAAI;MACA,MAAMyH,mBAAmB,GAAG,IAAI,CAACC,cAAc,CAAC,IAAI,CAACpD,aAAa,EAAE,IAAI,CAACC,gBAAgB,CAAC;MAC1F,IAAI,CAACiH,MAAM,CAAC/D,mBAAmB,EAAEzH,CAAC,CAACiG,SAAS,EAAEjG,CAAC,CAAC0K,MAAM,EAAE1K,CAAC,CAACsO,UAAU,EAAEtO,CAAC,CAACiH,WAAW,CAAC;MACpF,IAAI,IAAI,CAACpH,qBAAqB,EAAE;QAC5B,IAAI,CAAC2K,SAAS,CAACxK,CAAC,CAACiG,SAAS,EAAEjG,CAAC,CAAC0K,MAAM,EAAE1K,CAAC,CAACuO,iBAAiB,CAAC;MAC9D;IACJ,CAAC,CACD,OAAOC,GAAG,EAAE;MACRC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAE1O,CAAC,CAAC;MACzC,MAAMwO,GAAG;IACb;EACJ;EACAxI,aAAaA,CAACyG,KAAK,EAAE;IACjBA,KAAK,CAACkC,cAAc,CAAC,CAAC;IACtBlC,KAAK,CAACmC,eAAe,CAAC,CAAC;IACvB,IAAI,CAAC3I,SAAS,IAAIwG,KAAK,CAACoC,YAAY;EACxC;EACA;EACA3O,WAAWA,CAACkI,OAAO,EAAEY,GAAG,EAAEyD,KAAK,EAAE;IAC7B,IAAI,CAACA,KAAK,CAACzL,YAAY,EAAE;MACrB;IACJ;IACA,MAAMP,QAAQ,GAAG,IAAI,CAACX,GAAG,CAACC,eAAe,CAACqI,OAAO,CAAC;IAClDqE,KAAK,CAACzL,YAAY,CAAC8N,aAAa,GAAG,UAAU;IAC7CrC,KAAK,CAACzL,YAAY,CAAC+N,OAAO,CAAClQ,aAAa,CAACmQ,SAAS,EAAEC,IAAI,CAACC,SAAS,CAAC,CAAClG,GAAG,CAAC,CAAC,CAAC;IAC1E,IAAIyD,KAAK,CAACzL,YAAY,CAACmO,YAAY,EAAE;MACjC,IAAIC,KAAK;MACT,IAAI,IAAI,CAACtP,GAAG,CAACuP,YAAY,EAAE;QACvBD,KAAK,GAAG,IAAI,CAACtP,GAAG,CAACuP,YAAY,CAAC5O,QAAQ,EAAEgM,KAAK,CAAC;MAClD;MACA,IAAI,OAAO2C,KAAK,KAAK,WAAW,EAAE;QAC9BA,KAAK,GAAGzG,MAAM,CAAClI,QAAQ,CAACzD,MAAM,CAAC;MACnC;MACA,MAAMsS,SAAS,GAAGpQ,CAAC,CAAC,oBAAoB,CAAC;MACzCoQ,SAAS,CAACC,WAAW,GAAGH,KAAK;MAC7B3K,QAAQ,CAAC+K,IAAI,CAAC5J,WAAW,CAAC0J,SAAS,CAAC;MACpC7C,KAAK,CAACzL,YAAY,CAACmO,YAAY,CAACG,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;MACpDG,UAAU,CAAC,MAAMhL,QAAQ,CAAC+K,IAAI,CAACE,WAAW,CAACJ,SAAS,CAAC,EAAE,CAAC,CAAC;IAC7D;IACA,IAAI,CAACK,eAAe,GAAG,IAAIpP,uBAAuB,CAACE,QAAQ,CAAC;IAC5D3B,SAAS,CAAC8Q,sBAAsB,GAAG,IAAIhP,+BAA+B,CAACH,QAAQ,CAAC;IAChF,IAAI,IAAI,CAACX,GAAG,CAACI,WAAW,EAAE;MACtB,IAAI,CAACJ,GAAG,CAACI,WAAW,CAAC,IAAI,CAACyP,eAAe,EAAElD,KAAK,CAAC;IACrD;EACJ;EACAtM,UAAUA,CAACsM,KAAK,EAAE;IACdA,KAAK,CAACkB,YAAY,CAACgB,cAAc,CAAC,CAAC,CAAC,CAAC;IACrC,IAAI,CAAClL,kBAAkB,CAAC/F,OAAO,CAAC,CAAC;IACjC,IAAIoB,SAAS,CAAC8Q,sBAAsB,IAAI9Q,SAAS,CAAC8Q,sBAAsB,CAACjP,OAAO,CAAC,CAAC,KAAK,WAAW,EAAE;MAChG,OAAO,KAAK;IAChB;IACA,IAAI,CAACkP,kCAAkC,CAACpD,KAAK,CAACkB,YAAY,CAAC;IAC3D,IAAI,CAAClB,KAAK,CAACkB,YAAY,CAAC3M,YAAY,EAAE;MAClC,OAAO,KAAK;IAChB;IACA;IACA,IAAI,CAAC,IAAI,CAAC2O,eAAe,EAAE;MACvB,IAAI7Q,SAAS,CAAC8Q,sBAAsB,EAAE;QAClC;QACA,IAAI,CAACD,eAAe,GAAG7Q,SAAS,CAAC8Q,sBAAsB;MAC3D,CAAC,MACI;QACD;QACA,IAAI,CAACnD,KAAK,CAACkB,YAAY,CAAC3M,YAAY,CAACF,KAAK,EAAE;UACxC,OAAO,KAAK;QAChB;QACA,IAAI,CAAC6O,eAAe,GAAG,IAAI9O,qBAAqB,CAAC,CAAC;MACtD;IACJ;IACA,MAAMiP,MAAM,GAAG,IAAI,CAAChQ,GAAG,CAACK,UAAU,CAAC,IAAI,CAACwP,eAAe,EAAElD,KAAK,CAACrE,OAAO,EAAEqE,KAAK,CAACtC,KAAK,EAAEsC,KAAK,CAACkB,YAAY,CAAC;IACxG,IAAI,CAACpK,OAAO,GAAG,OAAOuM,MAAM,KAAK,SAAS,GAAGA,MAAM,GAAGA,MAAM,CAACC,MAAM;IACnE,IAAI,CAAC,IAAI,CAACxM,OAAO,EAAE;MACf,IAAI,CAACyM,mBAAmB,GAAG3N,SAAS;MACpC,IAAI,CAACmB,6BAA6B,CAAC9F,OAAO,CAAC,CAAC;MAC5C,OAAO,KAAK;IAChB;IACA+O,KAAK,CAACkB,YAAY,CAAC3M,YAAY,CAACiP,UAAU,GAAI,OAAOH,MAAM,KAAK,SAAS,IAAIA,MAAM,CAACI,MAAM,KAAK,CAAC,CAAC,aAAc,MAAM,GAAG,MAAM;IAC9H,IAAIC,QAAQ;IACZ,IAAI,OAAOL,MAAM,KAAK,SAAS,IAAIA,MAAM,CAACK,QAAQ,EAAE;MAChDA,QAAQ,GAAGL,MAAM,CAACK,QAAQ;IAC9B,CAAC,MACI;MACD,IAAI,OAAO1D,KAAK,CAACtC,KAAK,KAAK,WAAW,EAAE;QACpCgG,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;MACnB,CAAC,MACI;QACDA,QAAQ,GAAG,CAAC1D,KAAK,CAACtC,KAAK,CAAC;MAC5B;IACJ;IACA;IACAgG,QAAQ,GAAGvR,QAAQ,CAACuR,QAAQ,CAAC,CAACzC,MAAM,CAACnQ,CAAC,IAAIA,CAAC,IAAI,CAAC,CAAC,IAAIA,CAAC,GAAG,IAAI,CAACP,MAAM,CAAC,CAACoT,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,GAAGC,CAAC,CAAC;IAC3FH,QAAQ,GAAGA,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAGA,QAAQ;IAC/C,IAAI5O,kBAAkB,CAAC,IAAI,CAACyO,mBAAmB,EAAEG,QAAQ,CAAC,EAAE;MACxD,OAAO,IAAI;IACf;IACA,IAAI,CAACH,mBAAmB,GAAGG,QAAQ;IACnC,IAAI,CAAC3M,6BAA6B,CAAC9F,OAAO,CAAC,CAAC;IAC5C,IAAIyS,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;MAAE;MACtB,IAAI,CAAC3L,OAAO,CAACI,SAAS,CAACP,GAAG,CAAC,aAAa,CAAC;MACzC,IAAI,CAACa,aAAa,CAACN,SAAS,CAACP,GAAG,CAAC,aAAa,CAAC;MAC/C,IAAI,CAACb,6BAA6B,GAAG5F,YAAY,CAAC,MAAM;QACpD,IAAI,CAAC4G,OAAO,CAACI,SAAS,CAAC2L,MAAM,CAAC,aAAa,CAAC;QAC5C,IAAI,CAACrL,aAAa,CAACN,SAAS,CAAC2L,MAAM,CAAC,aAAa,CAAC;MACtD,CAAC,CAAC;IACN,CAAC,MACI;MACD,KAAK,MAAMpG,KAAK,IAAIgG,QAAQ,EAAE;QAC1B,MAAMhP,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACqG,KAAK,CAAC;QAC9BhJ,IAAI,CAAC8H,UAAU,GAAG,IAAI;QACtB,IAAI9H,IAAI,CAAC8G,GAAG,EAAE;UACV9G,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACI,SAAS,CAACP,GAAG,CAAC,aAAa,CAAC;QACjD;MACJ;MACA,IAAI,CAACb,6BAA6B,GAAG5F,YAAY,CAAC,MAAM;QACpD,KAAK,MAAMuM,KAAK,IAAIgG,QAAQ,EAAE;UAC1B,MAAMhP,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACqG,KAAK,CAAC;UAC9BhJ,IAAI,CAAC8H,UAAU,GAAG,KAAK;UACvB,IAAI9H,IAAI,CAAC8G,GAAG,EAAE;YACV9G,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAACI,SAAS,CAAC2L,MAAM,CAAC,aAAa,CAAC;UACpD;QACJ;MACJ,CAAC,CAAC;IACN;IACA,OAAO,IAAI;EACf;EACAlK,WAAWA,CAAA,EAAG;IACV,IAAI,CAAC5C,kBAAkB,CAAC/F,OAAO,CAAC,CAAC;IACjC,IAAI,CAAC+F,kBAAkB,GAAG1E,iBAAiB,CAAC,MAAM,IAAI,CAACyR,qBAAqB,CAAC,CAAC,EAAE,GAAG,CAAC;EACxF;EACApK,MAAMA,CAACqG,KAAK,EAAE;IACV,IAAI,CAAC,IAAI,CAAClJ,OAAO,EAAE;MACf;IACJ;IACA,MAAMkN,QAAQ,GAAG,IAAI,CAACd,eAAe;IACrC,IAAI,CAACe,qCAAqC,CAAC,CAAC;IAC5C,IAAI,CAACF,qBAAqB,CAAC,CAAC;IAC5B,IAAI,CAACb,eAAe,GAAGtN,SAAS;IAChCvD,SAAS,CAAC8Q,sBAAsB,GAAGvN,SAAS;IAC5C,IAAI,CAACoO,QAAQ,IAAI,CAAChE,KAAK,CAACkB,YAAY,CAAC3M,YAAY,EAAE;MAC/C;IACJ;IACAyL,KAAK,CAACkB,YAAY,CAACgB,cAAc,CAAC,CAAC;IACnC8B,QAAQ,CAAC/P,MAAM,CAAC+L,KAAK,CAACkB,YAAY,CAAC3M,YAAY,CAAC;IAChD,IAAI,CAAClB,GAAG,CAACM,IAAI,CAACqQ,QAAQ,EAAEhE,KAAK,CAACrE,OAAO,EAAEqE,KAAK,CAACtC,KAAK,EAAEsC,KAAK,CAACkB,YAAY,CAAC;EAC3E;EACApH,SAASA,CAACkG,KAAK,EAAE;IACb,IAAI,CAAClJ,OAAO,GAAG,KAAK;IACpB,IAAI,CAACmN,qCAAqC,CAAC,CAAC;IAC5C,IAAI,CAACF,qBAAqB,CAAC,CAAC;IAC5B,IAAI,CAACb,eAAe,GAAGtN,SAAS;IAChCvD,SAAS,CAAC8Q,sBAAsB,GAAGvN,SAAS;IAC5C,IAAI,IAAI,CAACvC,GAAG,CAACyG,SAAS,EAAE;MACpB,IAAI,CAACzG,GAAG,CAACyG,SAAS,CAACkG,KAAK,CAAC;IAC7B;EACJ;EACA+D,qBAAqBA,CAAA,EAAG;IACpB,IAAI,CAACR,mBAAmB,GAAG3N,SAAS;IACpC,IAAI,CAACmB,6BAA6B,CAAC9F,OAAO,CAAC,CAAC;IAC5C,IAAI,CAAC8F,6BAA6B,GAAG7F,UAAU,CAAC0F,IAAI;EACxD;EACA;EACAwM,kCAAkCA,CAACpD,KAAK,EAAE;IACtC,IAAI,CAAC,IAAI,CAACkE,2BAA2B,EAAE;MACnC,MAAMC,OAAO,GAAGtR,gBAAgB,CAAC,IAAI,CAACkF,OAAO,CAAC,CAACwH,GAAG;MAClD,IAAI,CAAC2E,2BAA2B,GAAGxR,OAAO,CAAC,IAAI,CAAC0R,2BAA2B,CAAC9O,IAAI,CAAC,IAAI,EAAE6O,OAAO,CAAC,CAAC;IACpG;IACA,IAAI,CAACxN,+BAA+B,CAAC1F,OAAO,CAAC,CAAC;IAC9C,IAAI,CAAC0F,+BAA+B,GAAGrE,iBAAiB,CAAC,MAAM;MAC3D,IAAI,IAAI,CAAC4R,2BAA2B,EAAE;QAClC,IAAI,CAACA,2BAA2B,CAACjT,OAAO,CAAC,CAAC;QAC1C,IAAI,CAACiT,2BAA2B,GAAGtO,SAAS;MAChD;IACJ,CAAC,EAAE,IAAI,CAAC;IACR,IAAI,CAACiB,cAAc,GAAGmJ,KAAK,CAACqE,KAAK;EACrC;EACAD,2BAA2BA,CAACD,OAAO,EAAE;IACjC,IAAI,IAAI,CAACtN,cAAc,KAAKjB,SAAS,EAAE;MACnC;IACJ;IACA,MAAM0O,IAAI,GAAG,IAAI,CAACzN,cAAc,GAAGsN,OAAO;IAC1C,MAAMI,UAAU,GAAG,IAAI,CAACvG,YAAY,GAAG,EAAE;IACzC,IAAIsG,IAAI,GAAG,EAAE,EAAE;MACX,IAAI,CAAC9K,SAAS,IAAIc,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,EAAED,IAAI,CAACkK,KAAK,CAAC,GAAG,IAAIF,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC;IAClE,CAAC,MACI,IAAIA,IAAI,GAAGC,UAAU,EAAE;MACxB,IAAI,CAAC/K,SAAS,IAAIc,IAAI,CAACmK,GAAG,CAAC,EAAE,EAAEnK,IAAI,CAACkK,KAAK,CAAC,GAAG,IAAIF,IAAI,GAAGC,UAAU,CAAC,CAAC,CAAC;IACzE;EACJ;EACAN,qCAAqCA,CAAA,EAAG;IACpC,IAAI,CAACtN,+BAA+B,CAAC1F,OAAO,CAAC,CAAC;IAC9C,IAAI,IAAI,CAACiT,2BAA2B,EAAE;MAClC,IAAI,CAACA,2BAA2B,CAACjT,OAAO,CAAC,CAAC;MAC1C,IAAI,CAACiT,2BAA2B,GAAGtO,SAAS;IAChD;EACJ;EACA;EACA+L,2BAA2BA,CAACzR,MAAM,EAAE;IAChC,MAAM8I,iBAAiB,GAAG,IAAI,CAACA,iBAAiB,CAACI,UAAU,CAAC,CAAC;IAC7D,IAAIuC,OAAO,GAAGzL,MAAM;IACpB,OAAOyL,OAAO,YAAY+I,WAAW,IAAI/I,OAAO,KAAK,IAAI,CAAClD,aAAa,IAAIO,iBAAiB,CAAC2L,QAAQ,CAAChJ,OAAO,CAAC,EAAE;MAC5G,MAAMiJ,QAAQ,GAAGjJ,OAAO,CAACkJ,YAAY,CAAC,YAAY,CAAC;MACnD,IAAID,QAAQ,EAAE;QACV,MAAMlH,KAAK,GAAGoH,MAAM,CAACF,QAAQ,CAAC;QAC9B,IAAI,CAACG,KAAK,CAACrH,KAAK,CAAC,EAAE;UACf,OAAOA,KAAK;QAChB;MACJ;MACA/B,OAAO,GAAGA,OAAO,CAACiE,aAAa;IACnC;IACA,OAAOhK,SAAS;EACpB;EACAqF,cAAcA,CAAC+D,SAAS,EAAEhB,YAAY,EAAE;IACpC,OAAO;MACHpD,KAAK,EAAE,IAAI,CAACrD,QAAQ,CAACqH,OAAO,CAACI,SAAS,CAAC;MACvC7D,GAAG,EAAE,IAAI,CAAC5D,QAAQ,CAACuH,UAAU,CAACE,SAAS,GAAGhB,YAAY,GAAG,CAAC;IAC9D,CAAC;EACL;EACA;AACJ;AACA;AACA;EACID,SAASA,CAACiB,SAAS,EAAEhB,YAAY,EAAE8D,iBAAiB,EAAE;IAClD,MAAM9G,mBAAmB,GAAG,IAAI,CAACC,cAAc,CAAC+D,SAAS,EAAEhB,YAAY,CAAC;IACxE;IACA;IACA,IAAIgH,kBAAkB;IACtB,IAAIC,qBAAqB;IACzB,IAAIjG,SAAS,KAAK,IAAI,CAACN,UAAU,CAAC1D,mBAAmB,CAACJ,KAAK,CAAC,EAAE;MAC1DoK,kBAAkB,GAAGhK,mBAAmB,CAACJ,KAAK;MAC9CqK,qBAAqB,GAAG,CAAC;IAC7B,CAAC,MACI,IAAIjK,mBAAmB,CAACG,GAAG,GAAGH,mBAAmB,CAACJ,KAAK,GAAG,CAAC,EAAE;MAC9DoK,kBAAkB,GAAGhK,mBAAmB,CAACJ,KAAK,GAAG,CAAC;MAClDqK,qBAAqB,GAAG,IAAI,CAACvG,UAAU,CAACsG,kBAAkB,CAAC,GAAGhG,SAAS;IAC3E;IACA,IAAIkG,UAAU,GAAG,CAAC;IAClB,OAAO,IAAI,EAAE;MACT,MAAMvI,WAAW,GAAG,IAAI,CAAC1B,cAAc,CAAC+D,SAAS,EAAEhB,YAAY,CAAC;MAChE,IAAImH,SAAS,GAAG,KAAK;MACrB,KAAK,IAAIrU,CAAC,GAAG6L,WAAW,CAAC/B,KAAK,EAAE9J,CAAC,GAAG6L,WAAW,CAACxB,GAAG,EAAErK,CAAC,EAAE,EAAE;QACtD,MAAMwT,IAAI,GAAG,IAAI,CAACc,kBAAkB,CAACtU,CAAC,CAAC;QACvC,IAAIwT,IAAI,KAAK,CAAC,EAAE;UACZ,IAAI,CAAC/M,QAAQ,CAAC/C,MAAM,CAAC1D,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAACuG,KAAK,CAACvG,CAAC,CAAC,CAAC,CAAC;QAC/C;QACAoU,UAAU,IAAIZ,IAAI;QAClBa,SAAS,GAAGA,SAAS,IAAIb,IAAI,KAAK,CAAC;MACvC;MACA,IAAI,CAACa,SAAS,EAAE;QACZ,IAAID,UAAU,KAAK,CAAC,EAAE;UAClB,IAAI,CAACpH,gCAAgC,CAAC,CAAC;QAC3C;QACA,MAAMuH,cAAc,GAAGpT,KAAK,CAAC8J,kBAAkB,CAACf,mBAAmB,EAAE2B,WAAW,CAAC;QACjF,KAAK,MAAMK,KAAK,IAAIqI,cAAc,EAAE;UAChC,KAAK,IAAIvU,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;YAC1C,IAAI,IAAI,CAACuG,KAAK,CAACvG,CAAC,CAAC,CAAC0K,GAAG,EAAE;cACnB,IAAI,CAACyB,iBAAiB,CAACnM,CAAC,CAAC;YAC7B;UACJ;QACJ;QACA,MAAMwU,YAAY,GAAGrT,KAAK,CAAC8J,kBAAkB,CAACY,WAAW,EAAE3B,mBAAmB,CAAC;QAC/E,KAAK,MAAMgC,KAAK,IAAIsI,YAAY,EAAE;UAC9B,KAAK,IAAIxU,CAAC,GAAGkM,KAAK,CAACpC,KAAK,EAAE9J,CAAC,GAAGkM,KAAK,CAAC7B,GAAG,EAAErK,CAAC,EAAE,EAAE;YAC1C,MAAMyU,UAAU,GAAGzU,CAAC,GAAG,CAAC;YACxB,MAAM0U,SAAS,GAAGD,UAAU,GAAG,IAAI,CAAClO,KAAK,CAAC9G,MAAM,GAAG,IAAI,CAAC8G,KAAK,CAACkO,UAAU,CAAC,CAAC/J,GAAG,GAAG,IAAI;YACpF,MAAM6B,aAAa,GAAGmI,SAAS,GAAGA,SAAS,CAACzN,OAAO,GAAG,IAAI;YAC1D,IAAI,CAAC0F,eAAe,CAAC3M,CAAC,EAAEuM,aAAa,CAAC;UAC1C;QACJ;QACA,KAAK,IAAIvM,CAAC,GAAG6L,WAAW,CAAC/B,KAAK,EAAE9J,CAAC,GAAG6L,WAAW,CAACxB,GAAG,EAAErK,CAAC,EAAE,EAAE;UACtD,IAAI,IAAI,CAACuG,KAAK,CAACvG,CAAC,CAAC,CAAC0K,GAAG,EAAE;YACnB,IAAI,CAACsB,eAAe,CAAC,IAAI,CAACzF,KAAK,CAACvG,CAAC,CAAC,EAAEA,CAAC,CAAC;UAC1C;QACJ;QACA,IAAI,OAAOkU,kBAAkB,KAAK,QAAQ,EAAE;UACxC;UACA;UACA;UACA;UACA;UACA,MAAMS,cAAc,GAAG,IAAI,CAAC5M,UAAU,CAAC6M,uBAAuB,CAAC,CAAC,CAAClM,SAAS,GAAGwF,SAAS;UACtF,MAAM2G,YAAY,GAAG,IAAI,CAACjH,UAAU,CAACsG,kBAAkB,CAAC,GAAGC,qBAAqB,GAAGQ,cAAc;UACjG,IAAI,CAAC/E,YAAY,CAACiF,YAAY,EAAE7D,iBAAiB,CAAC;QACtD;QACA,IAAI,CAAC5K,yBAAyB,CAAC6D,IAAI,CAAC,IAAI,CAACf,aAAa,CAAC;QACvD;MACJ;IACJ;EACJ;EACAoL,kBAAkBA,CAAC1H,KAAK,EAAE;IACtB,MAAMhJ,IAAI,GAAG,IAAI,CAAC2C,KAAK,CAACqG,KAAK,CAAC;IAC9B,IAAI,CAAChJ,IAAI,CAAC2H,gBAAgB,IAAI3H,IAAI,CAAC4H,sBAAsB,KAAK,IAAI,CAAChG,WAAW,EAAE;MAC5E,OAAO,CAAC;IACZ;IACA,IAAI,CAAC,CAAC,IAAI,CAACP,eAAe,CAACsG,gBAAgB,IAAI,CAAC,IAAI,CAACtG,eAAe,CAACsG,gBAAgB,CAAC3H,IAAI,CAACiH,OAAO,CAAC,EAAE;MACjG,OAAO,CAAC;IACZ;IACA,MAAMhH,IAAI,GAAGD,IAAI,CAACC,IAAI;IACtB,IAAI,CAAC,IAAI,CAACxB,YAAY,IAAIuB,IAAI,CAAC8G,GAAG,EAAE;MAChC,IAAIoK,OAAO,GAAGlR,IAAI,CAAC8G,GAAG,CAACzD,OAAO,CAAC8N,YAAY;MAC3CnR,IAAI,CAACC,IAAI,GAAGiR,OAAO;MACnBlR,IAAI,CAAC4H,sBAAsB,GAAG,IAAI,CAAChG,WAAW;MAC9C,OAAOsP,OAAO,GAAGjR,IAAI;IACzB;IACA,MAAM6G,GAAG,GAAG,IAAI,CAAC7D,KAAK,CAAC6H,KAAK,CAAC9K,IAAI,CAACgD,UAAU,CAAC;IAC7C8D,GAAG,CAACzD,OAAO,CAACW,KAAK,CAACuF,MAAM,GAAG,EAAE;IAC7B,IAAI,CAACxF,aAAa,CAACU,WAAW,CAACqC,GAAG,CAACzD,OAAO,CAAC;IAC3C,MAAMP,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChH,IAAI,CAACgD,UAAU,CAAC;IACpD,IAAIF,QAAQ,EAAE;MACVA,QAAQ,CAACsI,aAAa,CAACpL,IAAI,CAACiH,OAAO,EAAE+B,KAAK,EAAElC,GAAG,CAACoC,YAAY,EAAEhI,SAAS,CAAC;MACxE,IAAI4B,QAAQ,CAACmG,cAAc,EAAE;QACzBnG,QAAQ,CAACmG,cAAc,CAACjJ,IAAI,CAACiH,OAAO,EAAE+B,KAAK,EAAElC,GAAG,CAACoC,YAAY,EAAEhI,SAAS,CAAC;MAC7E;IACJ;IACAlB,IAAI,CAACC,IAAI,GAAG6G,GAAG,CAACzD,OAAO,CAAC8N,YAAY;IACpC,IAAI,IAAI,CAAC9P,eAAe,CAAC+P,gBAAgB,EAAE;MACvC,IAAI,CAAC/P,eAAe,CAAC+P,gBAAgB,CAACpR,IAAI,CAACiH,OAAO,EAAEjH,IAAI,CAACC,IAAI,CAAC;IAClE;IACAD,IAAI,CAAC4H,sBAAsB,GAAG,IAAI,CAAChG,WAAW;IAC9C,IAAI,CAACmC,aAAa,CAACwK,WAAW,CAACzH,GAAG,CAACzD,OAAO,CAAC;IAC3C,IAAI,CAACJ,KAAK,CAACkG,OAAO,CAACrC,GAAG,CAAC;IACvB,OAAO9G,IAAI,CAACC,IAAI,GAAGA,IAAI;EAC3B;EACA2I,oBAAoBA,CAACyI,MAAM,EAAE;IACzB,MAAMC,SAAS,GAAGD,MAAM,CAACA,MAAM,CAACxV,MAAM,GAAG,CAAC,CAAC;IAC3C,IAAI,CAACyV,SAAS,EAAE;MACZ,OAAO,IAAI;IACf;IACA,MAAMC,cAAc,GAAG,IAAI,CAAC5O,KAAK,CAAC2O,SAAS,CAAC7K,GAAG,CAAC;IAChD,IAAI,CAAC8K,cAAc,EAAE;MACjB,OAAO,IAAI;IACf;IACA,IAAI,CAACA,cAAc,CAACzK,GAAG,EAAE;MACrB,OAAO,IAAI;IACf;IACA,OAAOyK,cAAc,CAACzK,GAAG,CAACzD,OAAO;EACrC;EACAuI,eAAeA,CAAC5C,KAAK,EAAE;IACnB,UAAAvH,MAAA,CAAU,IAAI,CAACD,KAAK,OAAAC,MAAA,CAAIuH,KAAK;EACjC;EACA;EACAzM,OAAOA,CAAA,EAAG;IACN,IAAI,IAAI,CAACoG,KAAK,EAAE;MACZ,KAAK,MAAM3C,IAAI,IAAI,IAAI,CAAC2C,KAAK,EAAE;QAC3B,IAAI3C,IAAI,CAAC8G,GAAG,EAAE;UACV,MAAMhE,QAAQ,GAAG,IAAI,CAACxB,SAAS,CAAC0F,GAAG,CAAChH,IAAI,CAAC8G,GAAG,CAAC9D,UAAU,CAAC;UACxD,IAAIF,QAAQ,EAAE;YACV,IAAIA,QAAQ,CAACmG,cAAc,EAAE;cACzBnG,QAAQ,CAACmG,cAAc,CAACjJ,IAAI,CAACiH,OAAO,EAAE,CAAC,CAAC,EAAEjH,IAAI,CAAC8G,GAAG,CAACoC,YAAY,EAAEhI,SAAS,CAAC;YAC/E;YACA4B,QAAQ,CAAC0O,eAAe,CAACxR,IAAI,CAAC8G,GAAG,CAACoC,YAAY,CAAC;UACnD;QACJ;MACJ;MACA,IAAI,CAACvG,KAAK,GAAG,EAAE;IACnB;IACA,IAAI,IAAI,CAACU,OAAO,IAAI,IAAI,CAACA,OAAO,CAACoO,UAAU,EAAE;MACzC,IAAI,CAACpO,OAAO,CAACoO,UAAU,CAAClD,WAAW,CAAC,IAAI,CAAClL,OAAO,CAAC;IACrD;IACA9G,OAAO,CAAC,IAAI,CAACgG,WAAW,CAAC;EAC7B;AACJ;AACApB,QAAQ,CAACO,aAAa,GAAG,CAAC;AAC1BpG,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,cAAc,EAAE,IAAI,CAAC;AAC5CpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,iBAAiB,EAAE,IAAI,CAAC;AAC/CpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,oBAAoB,EAAE,IAAI,CAAC;AAClDpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,aAAa,EAAE,IAAI,CAAC;AAC3CpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,eAAe,EAAE,IAAI,CAAC;AAC7CpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,cAAc,EAAE,IAAI,CAAC;AAC5CpW,UAAU,CAAC,CACPgC,OAAO,CACV,EAAE6D,QAAQ,CAACuQ,SAAS,EAAE,OAAO,EAAE,IAAI,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}