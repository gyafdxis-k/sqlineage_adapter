{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from './dom.js';\nimport { IframeUtils } from './iframe.js';\nimport { StandardMouseEvent } from './mouseEvent.js';\nimport { DisposableStore } from '../common/lifecycle.js';\nexport function standardMouseMoveMerger(lastEvent, currentEvent) {\n  let ev = new StandardMouseEvent(currentEvent);\n  ev.preventDefault();\n  return {\n    leftButton: ev.leftButton,\n    buttons: ev.buttons,\n    posx: ev.posx,\n    posy: ev.posy\n  };\n}\nexport class GlobalMouseMoveMonitor {\n  constructor() {\n    this._hooks = new DisposableStore();\n    this._mouseMoveEventMerger = null;\n    this._mouseMoveCallback = null;\n    this._onStopCallback = null;\n  }\n  dispose() {\n    this.stopMonitoring(false);\n    this._hooks.dispose();\n  }\n  stopMonitoring(invokeStopCallback, browserEvent) {\n    if (!this.isMonitoring()) {\n      // Not monitoring\n      return;\n    }\n    // Unhook\n    this._hooks.clear();\n    this._mouseMoveEventMerger = null;\n    this._mouseMoveCallback = null;\n    const onStopCallback = this._onStopCallback;\n    this._onStopCallback = null;\n    if (invokeStopCallback && onStopCallback) {\n      onStopCallback(browserEvent);\n    }\n  }\n  isMonitoring() {\n    return !!this._mouseMoveEventMerger;\n  }\n  startMonitoring(initialElement, initialButtons, mouseMoveEventMerger, mouseMoveCallback, onStopCallback) {\n    if (this.isMonitoring()) {\n      // I am already hooked\n      return;\n    }\n    this._mouseMoveEventMerger = mouseMoveEventMerger;\n    this._mouseMoveCallback = mouseMoveCallback;\n    this._onStopCallback = onStopCallback;\n    const windowChain = IframeUtils.getSameOriginWindowChain();\n    const mouseMove = 'mousemove';\n    const mouseUp = 'mouseup';\n    const listenTo = windowChain.map(element => element.window.document);\n    const shadowRoot = dom.getShadowRoot(initialElement);\n    if (shadowRoot) {\n      listenTo.unshift(shadowRoot);\n    }\n    for (const element of listenTo) {\n      this._hooks.add(dom.addDisposableThrottledListener(element, mouseMove, data => {\n        if (data.buttons !== initialButtons) {\n          // Buttons state has changed in the meantime\n          this.stopMonitoring(true);\n          return;\n        }\n        this._mouseMoveCallback(data);\n      }, (lastEvent, currentEvent) => this._mouseMoveEventMerger(lastEvent, currentEvent)));\n      this._hooks.add(dom.addDisposableListener(element, mouseUp, e => this.stopMonitoring(true)));\n    }\n    if (IframeUtils.hasDifferentOriginAncestor()) {\n      let lastSameOriginAncestor = windowChain[windowChain.length - 1];\n      // We might miss a mouse up if it happens outside the iframe\n      // This one is for Chrome\n      this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseout', browserEvent => {\n        let e = new StandardMouseEvent(browserEvent);\n        if (e.target.tagName.toLowerCase() === 'html') {\n          this.stopMonitoring(true);\n        }\n      }));\n      // This one is for FF\n      this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseover', browserEvent => {\n        let e = new StandardMouseEvent(browserEvent);\n        if (e.target.tagName.toLowerCase() === 'html') {\n          this.stopMonitoring(true);\n        }\n      }));\n      // This one is for IE\n      this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document.body, 'mouseleave', browserEvent => {\n        this.stopMonitoring(true);\n      }));\n    }\n  }\n}","map":{"version":3,"names":["dom","IframeUtils","StandardMouseEvent","DisposableStore","standardMouseMoveMerger","lastEvent","currentEvent","ev","preventDefault","leftButton","buttons","posx","posy","GlobalMouseMoveMonitor","constructor","_hooks","_mouseMoveEventMerger","_mouseMoveCallback","_onStopCallback","dispose","stopMonitoring","invokeStopCallback","browserEvent","isMonitoring","clear","onStopCallback","startMonitoring","initialElement","initialButtons","mouseMoveEventMerger","mouseMoveCallback","windowChain","getSameOriginWindowChain","mouseMove","mouseUp","listenTo","map","element","window","document","shadowRoot","getShadowRoot","unshift","add","addDisposableThrottledListener","data","addDisposableListener","e","hasDifferentOriginAncestor","lastSameOriginAncestor","length","target","tagName","toLowerCase","body"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/base/browser/globalMouseMoveMonitor.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from './dom.js';\r\nimport { IframeUtils } from './iframe.js';\r\nimport { StandardMouseEvent } from './mouseEvent.js';\r\nimport { DisposableStore } from '../common/lifecycle.js';\r\nexport function standardMouseMoveMerger(lastEvent, currentEvent) {\r\n    let ev = new StandardMouseEvent(currentEvent);\r\n    ev.preventDefault();\r\n    return {\r\n        leftButton: ev.leftButton,\r\n        buttons: ev.buttons,\r\n        posx: ev.posx,\r\n        posy: ev.posy\r\n    };\r\n}\r\nexport class GlobalMouseMoveMonitor {\r\n    constructor() {\r\n        this._hooks = new DisposableStore();\r\n        this._mouseMoveEventMerger = null;\r\n        this._mouseMoveCallback = null;\r\n        this._onStopCallback = null;\r\n    }\r\n    dispose() {\r\n        this.stopMonitoring(false);\r\n        this._hooks.dispose();\r\n    }\r\n    stopMonitoring(invokeStopCallback, browserEvent) {\r\n        if (!this.isMonitoring()) {\r\n            // Not monitoring\r\n            return;\r\n        }\r\n        // Unhook\r\n        this._hooks.clear();\r\n        this._mouseMoveEventMerger = null;\r\n        this._mouseMoveCallback = null;\r\n        const onStopCallback = this._onStopCallback;\r\n        this._onStopCallback = null;\r\n        if (invokeStopCallback && onStopCallback) {\r\n            onStopCallback(browserEvent);\r\n        }\r\n    }\r\n    isMonitoring() {\r\n        return !!this._mouseMoveEventMerger;\r\n    }\r\n    startMonitoring(initialElement, initialButtons, mouseMoveEventMerger, mouseMoveCallback, onStopCallback) {\r\n        if (this.isMonitoring()) {\r\n            // I am already hooked\r\n            return;\r\n        }\r\n        this._mouseMoveEventMerger = mouseMoveEventMerger;\r\n        this._mouseMoveCallback = mouseMoveCallback;\r\n        this._onStopCallback = onStopCallback;\r\n        const windowChain = IframeUtils.getSameOriginWindowChain();\r\n        const mouseMove = 'mousemove';\r\n        const mouseUp = 'mouseup';\r\n        const listenTo = windowChain.map(element => element.window.document);\r\n        const shadowRoot = dom.getShadowRoot(initialElement);\r\n        if (shadowRoot) {\r\n            listenTo.unshift(shadowRoot);\r\n        }\r\n        for (const element of listenTo) {\r\n            this._hooks.add(dom.addDisposableThrottledListener(element, mouseMove, (data) => {\r\n                if (data.buttons !== initialButtons) {\r\n                    // Buttons state has changed in the meantime\r\n                    this.stopMonitoring(true);\r\n                    return;\r\n                }\r\n                this._mouseMoveCallback(data);\r\n            }, (lastEvent, currentEvent) => this._mouseMoveEventMerger(lastEvent, currentEvent)));\r\n            this._hooks.add(dom.addDisposableListener(element, mouseUp, (e) => this.stopMonitoring(true)));\r\n        }\r\n        if (IframeUtils.hasDifferentOriginAncestor()) {\r\n            let lastSameOriginAncestor = windowChain[windowChain.length - 1];\r\n            // We might miss a mouse up if it happens outside the iframe\r\n            // This one is for Chrome\r\n            this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseout', (browserEvent) => {\r\n                let e = new StandardMouseEvent(browserEvent);\r\n                if (e.target.tagName.toLowerCase() === 'html') {\r\n                    this.stopMonitoring(true);\r\n                }\r\n            }));\r\n            // This one is for FF\r\n            this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseover', (browserEvent) => {\r\n                let e = new StandardMouseEvent(browserEvent);\r\n                if (e.target.tagName.toLowerCase() === 'html') {\r\n                    this.stopMonitoring(true);\r\n                }\r\n            }));\r\n            // This one is for IE\r\n            this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document.body, 'mouseleave', (browserEvent) => {\r\n                this.stopMonitoring(true);\r\n            }));\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}