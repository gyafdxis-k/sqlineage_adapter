{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { splitLines } from '../../../base/common/strings.js';\nimport { Position } from '../core/position.js';\nimport { PrefixSumComputer } from '../viewModel/prefixSumComputer.js';\nexport class MirrorTextModel {\n  constructor(uri, lines, eol, versionId) {\n    this._uri = uri;\n    this._lines = lines;\n    this._eol = eol;\n    this._versionId = versionId;\n    this._lineStarts = null;\n    this._cachedTextValue = null;\n  }\n  dispose() {\n    this._lines.length = 0;\n  }\n  getText() {\n    if (this._cachedTextValue === null) {\n      this._cachedTextValue = this._lines.join(this._eol);\n    }\n    return this._cachedTextValue;\n  }\n  onEvents(e) {\n    if (e.eol && e.eol !== this._eol) {\n      this._eol = e.eol;\n      this._lineStarts = null;\n    }\n    // Update my lines\n    const changes = e.changes;\n    for (const change of changes) {\n      this._acceptDeleteRange(change.range);\n      this._acceptInsertText(new Position(change.range.startLineNumber, change.range.startColumn), change.text);\n    }\n    this._versionId = e.versionId;\n    this._cachedTextValue = null;\n  }\n  _ensureLineStarts() {\n    if (!this._lineStarts) {\n      const eolLength = this._eol.length;\n      const linesLength = this._lines.length;\n      const lineStartValues = new Uint32Array(linesLength);\n      for (let i = 0; i < linesLength; i++) {\n        lineStartValues[i] = this._lines[i].length + eolLength;\n      }\n      this._lineStarts = new PrefixSumComputer(lineStartValues);\n    }\n  }\n  /**\r\n   * All changes to a line's text go through this method\r\n   */\n  _setLineText(lineIndex, newValue) {\n    this._lines[lineIndex] = newValue;\n    if (this._lineStarts) {\n      // update prefix sum\n      this._lineStarts.changeValue(lineIndex, this._lines[lineIndex].length + this._eol.length);\n    }\n  }\n  _acceptDeleteRange(range) {\n    if (range.startLineNumber === range.endLineNumber) {\n      if (range.startColumn === range.endColumn) {\n        // Nothing to delete\n        return;\n      }\n      // Delete text on the affected line\n      this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1) + this._lines[range.startLineNumber - 1].substring(range.endColumn - 1));\n      return;\n    }\n    // Take remaining text on last line and append it to remaining text on first line\n    this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1) + this._lines[range.endLineNumber - 1].substring(range.endColumn - 1));\n    // Delete middle lines\n    this._lines.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\n    if (this._lineStarts) {\n      // update prefix sum\n      this._lineStarts.removeValues(range.startLineNumber, range.endLineNumber - range.startLineNumber);\n    }\n  }\n  _acceptInsertText(position, insertText) {\n    if (insertText.length === 0) {\n      // Nothing to insert\n      return;\n    }\n    let insertLines = splitLines(insertText);\n    if (insertLines.length === 1) {\n      // Inserting text on one line\n      this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1) + insertLines[0] + this._lines[position.lineNumber - 1].substring(position.column - 1));\n      return;\n    }\n    // Append overflowing text from first line to the end of text to insert\n    insertLines[insertLines.length - 1] += this._lines[position.lineNumber - 1].substring(position.column - 1);\n    // Delete overflowing text from first line and insert text on first line\n    this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1) + insertLines[0]);\n    // Insert new lines & store lengths\n    let newLengths = new Uint32Array(insertLines.length - 1);\n    for (let i = 1; i < insertLines.length; i++) {\n      this._lines.splice(position.lineNumber + i - 1, 0, insertLines[i]);\n      newLengths[i - 1] = insertLines[i].length + this._eol.length;\n    }\n    if (this._lineStarts) {\n      // update prefix sum\n      this._lineStarts.insertValues(position.lineNumber, newLengths);\n    }\n  }\n}","map":{"version":3,"names":["splitLines","Position","PrefixSumComputer","MirrorTextModel","constructor","uri","lines","eol","versionId","_uri","_lines","_eol","_versionId","_lineStarts","_cachedTextValue","dispose","length","getText","join","onEvents","e","changes","change","_acceptDeleteRange","range","_acceptInsertText","startLineNumber","startColumn","text","_ensureLineStarts","eolLength","linesLength","lineStartValues","Uint32Array","i","_setLineText","lineIndex","newValue","changeValue","endLineNumber","endColumn","substring","splice","removeValues","position","insertText","insertLines","lineNumber","column","newLengths","insertValues"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/editor/common/model/mirrorTextModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { splitLines } from '../../../base/common/strings.js';\r\nimport { Position } from '../core/position.js';\r\nimport { PrefixSumComputer } from '../viewModel/prefixSumComputer.js';\r\nexport class MirrorTextModel {\r\n    constructor(uri, lines, eol, versionId) {\r\n        this._uri = uri;\r\n        this._lines = lines;\r\n        this._eol = eol;\r\n        this._versionId = versionId;\r\n        this._lineStarts = null;\r\n        this._cachedTextValue = null;\r\n    }\r\n    dispose() {\r\n        this._lines.length = 0;\r\n    }\r\n    getText() {\r\n        if (this._cachedTextValue === null) {\r\n            this._cachedTextValue = this._lines.join(this._eol);\r\n        }\r\n        return this._cachedTextValue;\r\n    }\r\n    onEvents(e) {\r\n        if (e.eol && e.eol !== this._eol) {\r\n            this._eol = e.eol;\r\n            this._lineStarts = null;\r\n        }\r\n        // Update my lines\r\n        const changes = e.changes;\r\n        for (const change of changes) {\r\n            this._acceptDeleteRange(change.range);\r\n            this._acceptInsertText(new Position(change.range.startLineNumber, change.range.startColumn), change.text);\r\n        }\r\n        this._versionId = e.versionId;\r\n        this._cachedTextValue = null;\r\n    }\r\n    _ensureLineStarts() {\r\n        if (!this._lineStarts) {\r\n            const eolLength = this._eol.length;\r\n            const linesLength = this._lines.length;\r\n            const lineStartValues = new Uint32Array(linesLength);\r\n            for (let i = 0; i < linesLength; i++) {\r\n                lineStartValues[i] = this._lines[i].length + eolLength;\r\n            }\r\n            this._lineStarts = new PrefixSumComputer(lineStartValues);\r\n        }\r\n    }\r\n    /**\r\n     * All changes to a line's text go through this method\r\n     */\r\n    _setLineText(lineIndex, newValue) {\r\n        this._lines[lineIndex] = newValue;\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.changeValue(lineIndex, this._lines[lineIndex].length + this._eol.length);\r\n        }\r\n    }\r\n    _acceptDeleteRange(range) {\r\n        if (range.startLineNumber === range.endLineNumber) {\r\n            if (range.startColumn === range.endColumn) {\r\n                // Nothing to delete\r\n                return;\r\n            }\r\n            // Delete text on the affected line\r\n            this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n                + this._lines[range.startLineNumber - 1].substring(range.endColumn - 1));\r\n            return;\r\n        }\r\n        // Take remaining text on last line and append it to remaining text on first line\r\n        this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n            + this._lines[range.endLineNumber - 1].substring(range.endColumn - 1));\r\n        // Delete middle lines\r\n        this._lines.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.removeValues(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n        }\r\n    }\r\n    _acceptInsertText(position, insertText) {\r\n        if (insertText.length === 0) {\r\n            // Nothing to insert\r\n            return;\r\n        }\r\n        let insertLines = splitLines(insertText);\r\n        if (insertLines.length === 1) {\r\n            // Inserting text on one line\r\n            this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n                + insertLines[0]\r\n                + this._lines[position.lineNumber - 1].substring(position.column - 1));\r\n            return;\r\n        }\r\n        // Append overflowing text from first line to the end of text to insert\r\n        insertLines[insertLines.length - 1] += this._lines[position.lineNumber - 1].substring(position.column - 1);\r\n        // Delete overflowing text from first line and insert text on first line\r\n        this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n            + insertLines[0]);\r\n        // Insert new lines & store lengths\r\n        let newLengths = new Uint32Array(insertLines.length - 1);\r\n        for (let i = 1; i < insertLines.length; i++) {\r\n            this._lines.splice(position.lineNumber + i - 1, 0, insertLines[i]);\r\n            newLengths[i - 1] = insertLines[i].length + this._eol.length;\r\n        }\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.insertValues(position.lineNumber, newLengths);\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}