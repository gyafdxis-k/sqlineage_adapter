{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorCommand } from '../editorExtensions.js';\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nconst IEditorCancellationTokens = createDecorator('IEditorCancelService');\nconst ctxCancellableOperation = new RawContextKey('cancellableOperation', false);\nregisterSingleton(IEditorCancellationTokens, class {\n  constructor() {\n    this._tokens = new WeakMap();\n  }\n  add(editor, cts) {\n    let data = this._tokens.get(editor);\n    if (!data) {\n      data = editor.invokeWithinContext(accessor => {\n        const key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\n        const tokens = new LinkedList();\n        return {\n          key,\n          tokens\n        };\n      });\n      this._tokens.set(editor, data);\n    }\n    let removeFn;\n    data.key.set(true);\n    removeFn = data.tokens.push(cts);\n    return () => {\n      // remove w/o cancellation\n      if (removeFn) {\n        removeFn();\n        data.key.set(!data.tokens.isEmpty());\n        removeFn = undefined;\n      }\n    };\n  }\n  cancel(editor) {\n    const data = this._tokens.get(editor);\n    if (!data) {\n      return;\n    }\n    // remove with cancellation\n    const cts = data.tokens.pop();\n    if (cts) {\n      cts.cancel();\n      data.key.set(!data.tokens.isEmpty());\n    }\n  }\n}, true);\nexport class EditorKeybindingCancellationTokenSource extends CancellationTokenSource {\n  constructor(editor, parent) {\n    super(parent);\n    this.editor = editor;\n    this._unregister = editor.invokeWithinContext(accessor => accessor.get(IEditorCancellationTokens).add(editor, this));\n  }\n  dispose() {\n    this._unregister();\n    super.dispose();\n  }\n}\nregisterEditorCommand(new class extends EditorCommand {\n  constructor() {\n    super({\n      id: 'editor.cancelOperation',\n      kbOpts: {\n        weight: 100 /* EditorContrib */,\n        primary: 9 /* Escape */\n      },\n\n      precondition: ctxCancellableOperation\n    });\n  }\n  runEditorCommand(accessor, editor) {\n    accessor.get(IEditorCancellationTokens).cancel(editor);\n  }\n}());","map":{"version":3,"names":["EditorCommand","registerEditorCommand","IContextKeyService","RawContextKey","CancellationTokenSource","LinkedList","createDecorator","registerSingleton","IEditorCancellationTokens","ctxCancellableOperation","constructor","_tokens","WeakMap","add","editor","cts","data","get","invokeWithinContext","accessor","key","bindTo","tokens","set","removeFn","push","isEmpty","undefined","cancel","pop","EditorKeybindingCancellationTokenSource","parent","_unregister","dispose","id","kbOpts","weight","primary","precondition","runEditorCommand"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/editor/browser/core/keybindingCancellation.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditorCommand, registerEditorCommand } from '../editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nconst IEditorCancellationTokens = createDecorator('IEditorCancelService');\r\nconst ctxCancellableOperation = new RawContextKey('cancellableOperation', false);\r\nregisterSingleton(IEditorCancellationTokens, class {\r\n    constructor() {\r\n        this._tokens = new WeakMap();\r\n    }\r\n    add(editor, cts) {\r\n        let data = this._tokens.get(editor);\r\n        if (!data) {\r\n            data = editor.invokeWithinContext(accessor => {\r\n                const key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\r\n                const tokens = new LinkedList();\r\n                return { key, tokens };\r\n            });\r\n            this._tokens.set(editor, data);\r\n        }\r\n        let removeFn;\r\n        data.key.set(true);\r\n        removeFn = data.tokens.push(cts);\r\n        return () => {\r\n            // remove w/o cancellation\r\n            if (removeFn) {\r\n                removeFn();\r\n                data.key.set(!data.tokens.isEmpty());\r\n                removeFn = undefined;\r\n            }\r\n        };\r\n    }\r\n    cancel(editor) {\r\n        const data = this._tokens.get(editor);\r\n        if (!data) {\r\n            return;\r\n        }\r\n        // remove with cancellation\r\n        const cts = data.tokens.pop();\r\n        if (cts) {\r\n            cts.cancel();\r\n            data.key.set(!data.tokens.isEmpty());\r\n        }\r\n    }\r\n}, true);\r\nexport class EditorKeybindingCancellationTokenSource extends CancellationTokenSource {\r\n    constructor(editor, parent) {\r\n        super(parent);\r\n        this.editor = editor;\r\n        this._unregister = editor.invokeWithinContext(accessor => accessor.get(IEditorCancellationTokens).add(editor, this));\r\n    }\r\n    dispose() {\r\n        this._unregister();\r\n        super.dispose();\r\n    }\r\n}\r\nregisterEditorCommand(new class extends EditorCommand {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.cancelOperation',\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 9 /* Escape */\r\n            },\r\n            precondition: ctxCancellableOperation\r\n        });\r\n    }\r\n    runEditorCommand(accessor, editor) {\r\n        accessor.get(IEditorCancellationTokens).cancel(editor);\r\n    }\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}