{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport './links.css';\nimport * as nls from '../../../nls.js';\nimport * as async from '../../../base/common/async.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\nimport { LinkProviderRegistry } from '../../common/modes.js';\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\nimport { getLinks } from './getLinks.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport * as resources from '../../../base/common/resources.js';\nfunction getHoverMessage(link, useMetaKey) {\n  const executeCmd = link.url && /^command:/i.test(link.url.toString());\n  const label = link.tooltip ? link.tooltip : executeCmd ? nls.localize('links.navigate.executeCmd', 'Execute command') : nls.localize('links.navigate.follow', 'Follow link');\n  const kb = useMetaKey ? platform.isMacintosh ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\") : nls.localize('links.navigate.kb.meta', \"ctrl + click\") : platform.isMacintosh ? nls.localize('links.navigate.kb.alt.mac', \"option + click\") : nls.localize('links.navigate.kb.alt', \"alt + click\");\n  if (link.url) {\n    let nativeLabel = '';\n    if (/^command:/i.test(link.url.toString())) {\n      // Don't show complete command arguments in the native tooltip\n      const match = link.url.toString().match(/^command:([^?#]+)/);\n      if (match) {\n        const commandId = match[1];\n        const nativeLabelText = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\n        nativeLabel = \" \\\"\".concat(nativeLabelText, \"\\\"\");\n      }\n    }\n    const hoverMessage = new MarkdownString('', true).appendMarkdown(\"[\".concat(label, \"](\").concat(link.url.toString(true)).concat(nativeLabel, \") (\").concat(kb, \")\"));\n    return hoverMessage;\n  } else {\n    return new MarkdownString().appendText(\"\".concat(label, \" (\").concat(kb, \")\"));\n  }\n}\nconst decoration = {\n  general: ModelDecorationOptions.register({\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\n    collapseOnReplaceEdit: true,\n    inlineClassName: 'detected-link'\n  }),\n  active: ModelDecorationOptions.register({\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\n    collapseOnReplaceEdit: true,\n    inlineClassName: 'detected-link-active'\n  })\n};\nclass LinkOccurrence {\n  constructor(link, decorationId) {\n    this.link = link;\n    this.decorationId = decorationId;\n  }\n  static decoration(link, useMetaKey) {\n    return {\n      range: link.range,\n      options: LinkOccurrence._getOptions(link, useMetaKey, false)\n    };\n  }\n  static _getOptions(link, useMetaKey, isActive) {\n    const options = Object.assign({}, isActive ? decoration.active : decoration.general);\n    options.hoverMessage = getHoverMessage(link, useMetaKey);\n    return options;\n  }\n  activate(changeAccessor, useMetaKey) {\n    changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\n  }\n  deactivate(changeAccessor, useMetaKey) {\n    changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\n  }\n}\nlet LinkDetector = class LinkDetector {\n  constructor(editor, openerService, notificationService) {\n    this.listenersToRemove = new DisposableStore();\n    this.editor = editor;\n    this.openerService = openerService;\n    this.notificationService = notificationService;\n    let clickLinkGesture = new ClickLinkGesture(editor);\n    this.listenersToRemove.add(clickLinkGesture);\n    this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(_ref => {\n      let [mouseEvent, keyboardEvent] = _ref;\n      this._onEditorMouseMove(mouseEvent, keyboardEvent);\n    }));\n    this.listenersToRemove.add(clickLinkGesture.onExecute(e => {\n      this.onEditorMouseUp(e);\n    }));\n    this.listenersToRemove.add(clickLinkGesture.onCancel(e => {\n      this.cleanUpActiveLinkDecoration();\n    }));\n    this.enabled = editor.getOption(57 /* links */);\n    this.listenersToRemove.add(editor.onDidChangeConfiguration(e => {\n      const enabled = editor.getOption(57 /* links */);\n      if (this.enabled === enabled) {\n        // No change in our configuration option\n        return;\n      }\n      this.enabled = enabled;\n      // Remove any links (for the getting disabled case)\n      this.updateDecorations([]);\n      // Stop any computation (for the getting disabled case)\n      this.stop();\n      // Start computing (for the getting enabled case)\n      this.beginCompute();\n    }));\n    this.listenersToRemove.add(editor.onDidChangeModelContent(e => this.onChange()));\n    this.listenersToRemove.add(editor.onDidChangeModel(e => this.onModelChanged()));\n    this.listenersToRemove.add(editor.onDidChangeModelLanguage(e => this.onModelModeChanged()));\n    this.listenersToRemove.add(LinkProviderRegistry.onDidChange(e => this.onModelModeChanged()));\n    this.timeout = new async.TimeoutTimer();\n    this.computePromise = null;\n    this.activeLinksList = null;\n    this.currentOccurrences = {};\n    this.activeLinkDecorationId = null;\n    this.beginCompute();\n  }\n  static get(editor) {\n    return editor.getContribution(LinkDetector.ID);\n  }\n  onModelChanged() {\n    this.currentOccurrences = {};\n    this.activeLinkDecorationId = null;\n    this.stop();\n    this.beginCompute();\n  }\n  onModelModeChanged() {\n    this.stop();\n    this.beginCompute();\n  }\n  onChange() {\n    this.timeout.setIfNotSet(() => this.beginCompute(), LinkDetector.RECOMPUTE_TIME);\n  }\n  beginCompute() {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this.editor.hasModel() || !this.enabled) {\n        return;\n      }\n      const model = this.editor.getModel();\n      if (!LinkProviderRegistry.has(model)) {\n        return;\n      }\n      if (this.activeLinksList) {\n        this.activeLinksList.dispose();\n        this.activeLinksList = null;\n      }\n      this.computePromise = async.createCancelablePromise(token => getLinks(model, token));\n      try {\n        this.activeLinksList = yield this.computePromise;\n        this.updateDecorations(this.activeLinksList.links);\n      } catch (err) {\n        onUnexpectedError(err);\n      } finally {\n        this.computePromise = null;\n      }\n    });\n  }\n  updateDecorations(links) {\n    const useMetaKey = this.editor.getOption(64 /* multiCursorModifier */) === 'altKey';\n    let oldDecorations = [];\n    let keys = Object.keys(this.currentOccurrences);\n    for (let i = 0, len = keys.length; i < len; i++) {\n      let decorationId = keys[i];\n      let occurance = this.currentOccurrences[decorationId];\n      oldDecorations.push(occurance.decorationId);\n    }\n    let newDecorations = [];\n    if (links) {\n      // Not sure why this is sometimes null\n      for (const link of links) {\n        newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\n      }\n    }\n    let decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\n    this.currentOccurrences = {};\n    this.activeLinkDecorationId = null;\n    for (let i = 0, len = decorations.length; i < len; i++) {\n      let occurance = new LinkOccurrence(links[i], decorations[i]);\n      this.currentOccurrences[occurance.decorationId] = occurance;\n    }\n  }\n  _onEditorMouseMove(mouseEvent, withKey) {\n    const useMetaKey = this.editor.getOption(64 /* multiCursorModifier */) === 'altKey';\n    if (this.isEnabled(mouseEvent, withKey)) {\n      this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\n      const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n      if (occurrence) {\n        this.editor.changeDecorations(changeAccessor => {\n          occurrence.activate(changeAccessor, useMetaKey);\n          this.activeLinkDecorationId = occurrence.decorationId;\n        });\n      }\n    } else {\n      this.cleanUpActiveLinkDecoration();\n    }\n  }\n  cleanUpActiveLinkDecoration() {\n    const useMetaKey = this.editor.getOption(64 /* multiCursorModifier */) === 'altKey';\n    if (this.activeLinkDecorationId) {\n      const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\n      if (occurrence) {\n        this.editor.changeDecorations(changeAccessor => {\n          occurrence.deactivate(changeAccessor, useMetaKey);\n        });\n      }\n      this.activeLinkDecorationId = null;\n    }\n  }\n  onEditorMouseUp(mouseEvent) {\n    if (!this.isEnabled(mouseEvent)) {\n      return;\n    }\n    const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n    if (!occurrence) {\n      return;\n    }\n    this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\n  }\n\n  openLinkOccurrence(occurrence, openToSide) {\n    let fromUserGesture = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    if (!this.openerService) {\n      return;\n    }\n    const {\n      link\n    } = occurrence;\n    link.resolve(CancellationToken.None).then(uri => {\n      // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\n      if (typeof uri === 'string' && this.editor.hasModel()) {\n        const modelUri = this.editor.getModel().uri;\n        if (modelUri.scheme === Schemas.file && uri.startsWith(\"\".concat(Schemas.file, \":\"))) {\n          const parsedUri = URI.parse(uri);\n          if (parsedUri.scheme === Schemas.file) {\n            const fsPath = resources.originalFSPath(parsedUri);\n            let relativePath = null;\n            if (fsPath.startsWith('/./')) {\n              relativePath = \".\".concat(fsPath.substr(1));\n            } else if (fsPath.startsWith('//./')) {\n              relativePath = \".\".concat(fsPath.substr(2));\n            }\n            if (relativePath) {\n              uri = resources.joinPath(modelUri, relativePath);\n            }\n          }\n        }\n      }\n      return this.openerService.open(uri, {\n        openToSide,\n        fromUserGesture,\n        allowContributedOpeners: true\n      });\n    }, err => {\n      const messageOrError = err instanceof Error ? err.message : err;\n      // different error cases\n      if (messageOrError === 'invalid') {\n        this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\n      } else if (messageOrError === 'missing') {\n        this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\n      } else {\n        onUnexpectedError(err);\n      }\n    });\n  }\n  getLinkOccurrence(position) {\n    if (!this.editor.hasModel() || !position) {\n      return null;\n    }\n    const decorations = this.editor.getModel().getDecorationsInRange({\n      startLineNumber: position.lineNumber,\n      startColumn: position.column,\n      endLineNumber: position.lineNumber,\n      endColumn: position.column\n    }, 0, true);\n    for (const decoration of decorations) {\n      const currentOccurrence = this.currentOccurrences[decoration.id];\n      if (currentOccurrence) {\n        return currentOccurrence;\n      }\n    }\n    return null;\n  }\n  isEnabled(mouseEvent, withKey) {\n    return Boolean(mouseEvent.target.type === 6 /* CONTENT_TEXT */ && (mouseEvent.hasTriggerModifier || withKey && withKey.keyCodeIsTriggerKey));\n  }\n  stop() {\n    var _a;\n    this.timeout.cancel();\n    if (this.activeLinksList) {\n      (_a = this.activeLinksList) === null || _a === void 0 ? void 0 : _a.dispose();\n      this.activeLinksList = null;\n    }\n    if (this.computePromise) {\n      this.computePromise.cancel();\n      this.computePromise = null;\n    }\n  }\n  dispose() {\n    this.listenersToRemove.dispose();\n    this.stop();\n    this.timeout.dispose();\n  }\n};\nLinkDetector.ID = 'editor.linkDetector';\nLinkDetector.RECOMPUTE_TIME = 1000; // ms\nLinkDetector = __decorate([__param(1, IOpenerService), __param(2, INotificationService)], LinkDetector);\nexport { LinkDetector };\nclass OpenLinkAction extends EditorAction {\n  constructor() {\n    super({\n      id: 'editor.action.openLink',\n      label: nls.localize('label', \"Open Link\"),\n      alias: 'Open Link',\n      precondition: undefined\n    });\n  }\n  run(accessor, editor) {\n    let linkDetector = LinkDetector.get(editor);\n    if (!linkDetector) {\n      return;\n    }\n    if (!editor.hasModel()) {\n      return;\n    }\n    let selections = editor.getSelections();\n    for (let sel of selections) {\n      let link = linkDetector.getLinkOccurrence(sel.getEndPosition());\n      if (link) {\n        linkDetector.openLinkOccurrence(link, false);\n      }\n    }\n  }\n}\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\nregisterEditorAction(OpenLinkAction);\nregisterThemingParticipant((theme, collector) => {\n  const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n  if (activeLinkForeground) {\n    collector.addRule(\".monaco-editor .detected-link-active { color: \".concat(activeLinkForeground, \" !important; }\"));\n  }\n});","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","nls","async","CancellationToken","onUnexpectedError","MarkdownString","DisposableStore","platform","EditorAction","registerEditorAction","registerEditorContribution","ModelDecorationOptions","LinkProviderRegistry","ClickLinkGesture","getLinks","INotificationService","IOpenerService","editorActiveLinkForeground","registerThemingParticipant","URI","Schemas","resources","getHoverMessage","link","useMetaKey","executeCmd","url","test","toString","label","tooltip","localize","kb","isMacintosh","nativeLabel","match","commandId","nativeLabelText","concat","hoverMessage","appendMarkdown","appendText","decoration","general","register","stickiness","collapseOnReplaceEdit","inlineClassName","active","LinkOccurrence","constructor","decorationId","range","options","_getOptions","isActive","assign","activate","changeAccessor","changeDecorationOptions","deactivate","LinkDetector","editor","openerService","notificationService","listenersToRemove","clickLinkGesture","add","onMouseMoveOrRelevantKeyDown","_ref","mouseEvent","keyboardEvent","_onEditorMouseMove","onExecute","onEditorMouseUp","onCancel","cleanUpActiveLinkDecoration","enabled","getOption","onDidChangeConfiguration","updateDecorations","stop","beginCompute","onDidChangeModelContent","onChange","onDidChangeModel","onModelChanged","onDidChangeModelLanguage","onModelModeChanged","onDidChange","timeout","TimeoutTimer","computePromise","activeLinksList","currentOccurrences","activeLinkDecorationId","get","getContribution","ID","setIfNotSet","RECOMPUTE_TIME","hasModel","model","getModel","has","dispose","createCancelablePromise","token","links","err","oldDecorations","keys","len","occurance","push","newDecorations","decorations","deltaDecorations","withKey","isEnabled","occurrence","getLinkOccurrence","position","changeDecorations","openLinkOccurrence","hasSideBySideModifier","openToSide","fromUserGesture","undefined","None","uri","modelUri","scheme","file","startsWith","parsedUri","parse","fsPath","originalFSPath","relativePath","substr","joinPath","open","allowContributedOpeners","messageOrError","Error","message","warn","getDecorationsInRange","startLineNumber","lineNumber","startColumn","column","endLineNumber","endColumn","currentOccurrence","id","Boolean","type","hasTriggerModifier","keyCodeIsTriggerKey","_a","cancel","OpenLinkAction","alias","precondition","run","accessor","linkDetector","selections","getSelections","sel","getEndPosition","theme","collector","activeLinkForeground","getColor","addRule"],"sources":["C:/Users/Administrator/Desktop/sqllineage-master/sqllineagejs/node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './links.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as async from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\r\nimport { getLinks } from './getLinks.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport * as resources from '../../../base/common/resources.js';\r\nfunction getHoverMessage(link, useMetaKey) {\r\n    const executeCmd = link.url && /^command:/i.test(link.url.toString());\r\n    const label = link.tooltip\r\n        ? link.tooltip\r\n        : executeCmd\r\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\r\n            : nls.localize('links.navigate.follow', 'Follow link');\r\n    const kb = useMetaKey\r\n        ? platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\r\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\r\n        : platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\r\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\r\n    if (link.url) {\r\n        let nativeLabel = '';\r\n        if (/^command:/i.test(link.url.toString())) {\r\n            // Don't show complete command arguments in the native tooltip\r\n            const match = link.url.toString().match(/^command:([^?#]+)/);\r\n            if (match) {\r\n                const commandId = match[1];\r\n                const nativeLabelText = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\r\n                nativeLabel = ` \"${nativeLabelText}\"`;\r\n            }\r\n        }\r\n        const hoverMessage = new MarkdownString('', true).appendMarkdown(`[${label}](${link.url.toString(true)}${nativeLabel}) (${kb})`);\r\n        return hoverMessage;\r\n    }\r\n    else {\r\n        return new MarkdownString().appendText(`${label} (${kb})`);\r\n    }\r\n}\r\nconst decoration = {\r\n    general: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link'\r\n    }),\r\n    active: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link-active'\r\n    })\r\n};\r\nclass LinkOccurrence {\r\n    constructor(link, decorationId) {\r\n        this.link = link;\r\n        this.decorationId = decorationId;\r\n    }\r\n    static decoration(link, useMetaKey) {\r\n        return {\r\n            range: link.range,\r\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\r\n        };\r\n    }\r\n    static _getOptions(link, useMetaKey, isActive) {\r\n        const options = Object.assign({}, (isActive ? decoration.active : decoration.general));\r\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\r\n        return options;\r\n    }\r\n    activate(changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\r\n    }\r\n    deactivate(changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\r\n    }\r\n}\r\nlet LinkDetector = class LinkDetector {\r\n    constructor(editor, openerService, notificationService) {\r\n        this.listenersToRemove = new DisposableStore();\r\n        this.editor = editor;\r\n        this.openerService = openerService;\r\n        this.notificationService = notificationService;\r\n        let clickLinkGesture = new ClickLinkGesture(editor);\r\n        this.listenersToRemove.add(clickLinkGesture);\r\n        this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\r\n            this._onEditorMouseMove(mouseEvent, keyboardEvent);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onExecute((e) => {\r\n            this.onEditorMouseUp(e);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onCancel((e) => {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }));\r\n        this.enabled = editor.getOption(57 /* links */);\r\n        this.listenersToRemove.add(editor.onDidChangeConfiguration((e) => {\r\n            const enabled = editor.getOption(57 /* links */);\r\n            if (this.enabled === enabled) {\r\n                // No change in our configuration option\r\n                return;\r\n            }\r\n            this.enabled = enabled;\r\n            // Remove any links (for the getting disabled case)\r\n            this.updateDecorations([]);\r\n            // Stop any computation (for the getting disabled case)\r\n            this.stop();\r\n            // Start computing (for the getting enabled case)\r\n            this.beginCompute();\r\n        }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelContent((e) => this.onChange()));\r\n        this.listenersToRemove.add(editor.onDidChangeModel((e) => this.onModelChanged()));\r\n        this.listenersToRemove.add(editor.onDidChangeModelLanguage((e) => this.onModelModeChanged()));\r\n        this.listenersToRemove.add(LinkProviderRegistry.onDidChange((e) => this.onModelModeChanged()));\r\n        this.timeout = new async.TimeoutTimer();\r\n        this.computePromise = null;\r\n        this.activeLinksList = null;\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.beginCompute();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(LinkDetector.ID);\r\n    }\r\n    onModelChanged() {\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.stop();\r\n        this.beginCompute();\r\n    }\r\n    onModelModeChanged() {\r\n        this.stop();\r\n        this.beginCompute();\r\n    }\r\n    onChange() {\r\n        this.timeout.setIfNotSet(() => this.beginCompute(), LinkDetector.RECOMPUTE_TIME);\r\n    }\r\n    beginCompute() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.editor.hasModel() || !this.enabled) {\r\n                return;\r\n            }\r\n            const model = this.editor.getModel();\r\n            if (!LinkProviderRegistry.has(model)) {\r\n                return;\r\n            }\r\n            if (this.activeLinksList) {\r\n                this.activeLinksList.dispose();\r\n                this.activeLinksList = null;\r\n            }\r\n            this.computePromise = async.createCancelablePromise(token => getLinks(model, token));\r\n            try {\r\n                this.activeLinksList = yield this.computePromise;\r\n                this.updateDecorations(this.activeLinksList.links);\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n            finally {\r\n                this.computePromise = null;\r\n            }\r\n        });\r\n    }\r\n    updateDecorations(links) {\r\n        const useMetaKey = (this.editor.getOption(64 /* multiCursorModifier */) === 'altKey');\r\n        let oldDecorations = [];\r\n        let keys = Object.keys(this.currentOccurrences);\r\n        for (let i = 0, len = keys.length; i < len; i++) {\r\n            let decorationId = keys[i];\r\n            let occurance = this.currentOccurrences[decorationId];\r\n            oldDecorations.push(occurance.decorationId);\r\n        }\r\n        let newDecorations = [];\r\n        if (links) {\r\n            // Not sure why this is sometimes null\r\n            for (const link of links) {\r\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\r\n            }\r\n        }\r\n        let decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        for (let i = 0, len = decorations.length; i < len; i++) {\r\n            let occurance = new LinkOccurrence(links[i], decorations[i]);\r\n            this.currentOccurrences[occurance.decorationId] = occurance;\r\n        }\r\n    }\r\n    _onEditorMouseMove(mouseEvent, withKey) {\r\n        const useMetaKey = (this.editor.getOption(64 /* multiCursorModifier */) === 'altKey');\r\n        if (this.isEnabled(mouseEvent, withKey)) {\r\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\r\n            const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n            if (occurrence) {\r\n                this.editor.changeDecorations((changeAccessor) => {\r\n                    occurrence.activate(changeAccessor, useMetaKey);\r\n                    this.activeLinkDecorationId = occurrence.decorationId;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }\r\n    }\r\n    cleanUpActiveLinkDecoration() {\r\n        const useMetaKey = (this.editor.getOption(64 /* multiCursorModifier */) === 'altKey');\r\n        if (this.activeLinkDecorationId) {\r\n            const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\r\n            if (occurrence) {\r\n                this.editor.changeDecorations((changeAccessor) => {\r\n                    occurrence.deactivate(changeAccessor, useMetaKey);\r\n                });\r\n            }\r\n            this.activeLinkDecorationId = null;\r\n        }\r\n    }\r\n    onEditorMouseUp(mouseEvent) {\r\n        if (!this.isEnabled(mouseEvent)) {\r\n            return;\r\n        }\r\n        const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n        if (!occurrence) {\r\n            return;\r\n        }\r\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\r\n    }\r\n    openLinkOccurrence(occurrence, openToSide, fromUserGesture = false) {\r\n        if (!this.openerService) {\r\n            return;\r\n        }\r\n        const { link } = occurrence;\r\n        link.resolve(CancellationToken.None).then(uri => {\r\n            // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\r\n            if (typeof uri === 'string' && this.editor.hasModel()) {\r\n                const modelUri = this.editor.getModel().uri;\r\n                if (modelUri.scheme === Schemas.file && uri.startsWith(`${Schemas.file}:`)) {\r\n                    const parsedUri = URI.parse(uri);\r\n                    if (parsedUri.scheme === Schemas.file) {\r\n                        const fsPath = resources.originalFSPath(parsedUri);\r\n                        let relativePath = null;\r\n                        if (fsPath.startsWith('/./')) {\r\n                            relativePath = `.${fsPath.substr(1)}`;\r\n                        }\r\n                        else if (fsPath.startsWith('//./')) {\r\n                            relativePath = `.${fsPath.substr(2)}`;\r\n                        }\r\n                        if (relativePath) {\r\n                            uri = resources.joinPath(modelUri, relativePath);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this.openerService.open(uri, { openToSide, fromUserGesture, allowContributedOpeners: true });\r\n        }, err => {\r\n            const messageOrError = err instanceof Error ? err.message : err;\r\n            // different error cases\r\n            if (messageOrError === 'invalid') {\r\n                this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\r\n            }\r\n            else if (messageOrError === 'missing') {\r\n                this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\r\n            }\r\n            else {\r\n                onUnexpectedError(err);\r\n            }\r\n        });\r\n    }\r\n    getLinkOccurrence(position) {\r\n        if (!this.editor.hasModel() || !position) {\r\n            return null;\r\n        }\r\n        const decorations = this.editor.getModel().getDecorationsInRange({\r\n            startLineNumber: position.lineNumber,\r\n            startColumn: position.column,\r\n            endLineNumber: position.lineNumber,\r\n            endColumn: position.column\r\n        }, 0, true);\r\n        for (const decoration of decorations) {\r\n            const currentOccurrence = this.currentOccurrences[decoration.id];\r\n            if (currentOccurrence) {\r\n                return currentOccurrence;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    isEnabled(mouseEvent, withKey) {\r\n        return Boolean((mouseEvent.target.type === 6 /* CONTENT_TEXT */)\r\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\r\n    }\r\n    stop() {\r\n        var _a;\r\n        this.timeout.cancel();\r\n        if (this.activeLinksList) {\r\n            (_a = this.activeLinksList) === null || _a === void 0 ? void 0 : _a.dispose();\r\n            this.activeLinksList = null;\r\n        }\r\n        if (this.computePromise) {\r\n            this.computePromise.cancel();\r\n            this.computePromise = null;\r\n        }\r\n    }\r\n    dispose() {\r\n        this.listenersToRemove.dispose();\r\n        this.stop();\r\n        this.timeout.dispose();\r\n    }\r\n};\r\nLinkDetector.ID = 'editor.linkDetector';\r\nLinkDetector.RECOMPUTE_TIME = 1000; // ms\r\nLinkDetector = __decorate([\r\n    __param(1, IOpenerService),\r\n    __param(2, INotificationService)\r\n], LinkDetector);\r\nexport { LinkDetector };\r\nclass OpenLinkAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.openLink',\r\n            label: nls.localize('label', \"Open Link\"),\r\n            alias: 'Open Link',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let linkDetector = LinkDetector.get(editor);\r\n        if (!linkDetector) {\r\n            return;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        let selections = editor.getSelections();\r\n        for (let sel of selections) {\r\n            let link = linkDetector.getLinkOccurrence(sel.getEndPosition());\r\n            if (link) {\r\n                linkDetector.openLinkOccurrence(link, false);\r\n            }\r\n        }\r\n    }\r\n}\r\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\r\nregisterEditorAction(OpenLinkAction);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(`.monaco-editor .detected-link-active { color: ${activeLinkForeground} !important; }`);\r\n    }\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}